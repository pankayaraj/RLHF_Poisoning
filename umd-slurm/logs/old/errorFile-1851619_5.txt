python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt-350m" --epoch=8 --sft_epoch=5 --dataset="hh_poisoned" --per=0.05
------
Some weights of OPTForSequenceClassification were not initialized from the model checkpoint at /cmlscratch/pan/RLHF_Poisoning/models/trained_sft/opt-350m_5_hh_poisoned_0.05 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map (num_proc=4):   0%|          | 0/42537 [00:00<?, ? examples/s]Map (num_proc=4):   2%|▏         | 1000/42537 [00:03<02:09, 320.17 examples/s]Map (num_proc=4):  12%|█▏        | 5000/42537 [00:06<00:42, 887.28 examples/s]Map (num_proc=4):  19%|█▉        | 8000/42537 [00:06<00:21, 1618.30 examples/s]Map (num_proc=4):  21%|██        | 9000/42537 [00:09<00:35, 938.07 examples/s] Map (num_proc=4):  26%|██▌       | 11000/42537 [00:09<00:22, 1398.07 examples/s]Map (num_proc=4):  31%|███       | 13000/42537 [00:12<00:28, 1019.82 examples/s]Map (num_proc=4):  38%|███▊      | 16000/42537 [00:12<00:16, 1604.50 examples/s]Map (num_proc=4):  40%|███▉      | 17000/42537 [00:15<00:24, 1028.76 examples/s]Map (num_proc=4):  45%|████▍     | 19000/42537 [00:15<00:16, 1455.76 examples/s]Map (num_proc=4):  47%|████▋     | 20000/42537 [00:16<00:13, 1633.15 examples/s]Map (num_proc=4):  49%|████▉     | 21000/42537 [00:18<00:22, 957.62 examples/s] Map (num_proc=4):  52%|█████▏    | 22000/42537 [00:18<00:17, 1199.36 examples/s]Map (num_proc=4):  54%|█████▍    | 23000/42537 [00:19<00:13, 1502.26 examples/s]Map (num_proc=4):  56%|█████▋    | 24000/42537 [00:19<00:09, 1875.00 examples/s]Map (num_proc=4):  59%|█████▉    | 25000/42537 [00:21<00:19, 894.30 examples/s] Map (num_proc=4):  61%|██████    | 26000/42537 [00:22<00:14, 1123.82 examples/s]Map (num_proc=4):  66%|██████▌   | 28000/42537 [00:22<00:08, 1784.01 examples/s]Map (num_proc=4):  68%|██████▊   | 29000/42537 [00:25<00:14, 929.44 examples/s] Map (num_proc=4):  71%|███████   | 30000/42537 [00:25<00:10, 1191.60 examples/s]Map (num_proc=4):  73%|███████▎  | 31000/42537 [00:25<00:07, 1557.83 examples/s]Map (num_proc=4):  75%|███████▌  | 32000/42537 [00:25<00:05, 1837.94 examples/s]Map (num_proc=4):  78%|███████▊  | 33000/42537 [00:28<00:11, 846.41 examples/s] Map (num_proc=4):  82%|████████▏ | 35000/42537 [00:28<00:05, 1408.00 examples/s]Map (num_proc=4):  85%|████████▍ | 36000/42537 [00:29<00:03, 1716.54 examples/s]Map (num_proc=4):  87%|████████▋ | 37000/42537 [00:31<00:06, 877.98 examples/s] Map (num_proc=4):  89%|████████▉ | 38000/42537 [00:31<00:04, 1130.10 examples/s]Map (num_proc=4):  92%|█████████▏| 39000/42537 [00:32<00:02, 1484.67 examples/s]Map (num_proc=4):  94%|█████████▍| 40000/42537 [00:32<00:01, 1780.21 examples/s]Map (num_proc=4):  96%|█████████▌| 40634/42537 [00:33<00:01, 1085.02 examples/s]Map (num_proc=4):  97%|█████████▋| 41268/42537 [00:33<00:00, 1308.26 examples/s]Map (num_proc=4): 100%|██████████| 42537/42537 [00:34<00:00, 1929.61 examples/s]Map (num_proc=4): 100%|██████████| 42537/42537 [00:34<00:00, 1238.29 examples/s]
Filter:   0%|          | 0/42537 [00:00<?, ? examples/s]Filter:   2%|▏         | 1000/42537 [00:00<00:11, 3502.79 examples/s]Filter:   5%|▍         | 2000/42537 [00:00<00:10, 3788.24 examples/s]Filter:   7%|▋         | 3000/42537 [00:00<00:10, 3788.00 examples/s]Filter:   9%|▉         | 4000/42537 [00:01<00:09, 3881.33 examples/s]Filter:  12%|█▏        | 5000/42537 [00:01<00:09, 3989.75 examples/s]Filter:  14%|█▍        | 6000/42537 [00:01<00:09, 3938.78 examples/s]/var/spool/slurm/slurmd.spool/job1851624/slurm_script: line 25: 2614545 Bus error               (core dumped) python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt-350m" --epoch=8 --sft_epoch=5 --dataset="hh_poisoned" --per=0.05
END of SLURM commands
