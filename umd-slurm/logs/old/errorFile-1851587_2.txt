python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt-350m" --epoch=4 --sft_epoch=5 --dataset="hh_poisoned" --per=0.05
------
Some weights of OPTForSequenceClassification were not initialized from the model checkpoint at /cmlscratch/pan/RLHF_Poisoning/models/trained_sft/opt-350m_5_hh_poisoned_0.05 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/160 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  1%|          | 1/160 [02:44<7:17:04, 164.94s/it]  1%|▏         | 2/160 [05:27<7:10:17, 163.40s/it]  2%|▏         | 3/160 [08:01<6:56:31, 159.18s/it]  2%|▎         | 4/160 [10:42<6:55:54, 159.96s/it]  3%|▎         | 5/160 [13:21<6:52:28, 159.67s/it]  4%|▍         | 6/160 [16:06<6:54:38, 161.55s/it]  4%|▍         | 7/160 [18:53<6:56:12, 163.22s/it]  5%|▌         | 8/160 [21:34<6:51:56, 162.61s/it]  6%|▌         | 9/160 [24:13<6:46:24, 161.49s/it]  6%|▋         | 10/160 [26:59<6:46:49, 162.73s/it]  7%|▋         | 11/160 [29:41<6:43:19, 162.41s/it]  8%|▊         | 12/160 [32:20<6:38:14, 161.45s/it]  8%|▊         | 13/160 [34:59<6:33:36, 160.65s/it]  9%|▉         | 14/160 [37:46<6:35:42, 162.62s/it]  9%|▉         | 15/160 [40:25<6:30:08, 161.44s/it] 10%|█         | 16/160 [43:09<6:29:26, 162.27s/it] 11%|█         | 17/160 [45:47<6:24:10, 161.19s/it] 11%|█▏        | 18/160 [48:28<6:21:09, 161.06s/it] 12%|█▏        | 19/160 [51:13<6:21:04, 162.16s/it] 12%|█▎        | 20/160 [53:51<6:15:42, 161.02s/it] 13%|█▎        | 21/160 [56:33<6:13:34, 161.26s/it] 14%|█▍        | 22/160 [59:20<6:14:57, 163.03s/it] 14%|█▍        | 23/160 [1:01:57<6:08:01, 161.18s/it] 15%|█▌        | 24/160 [1:04:37<6:04:21, 160.75s/it] 16%|█▌        | 25/160 [1:07:16<6:00:46, 160.35s/it] 16%|█▋        | 26/160 [1:10:00<6:00:08, 161.26s/it] 17%|█▋        | 27/160 [1:12:38<5:55:18, 160.29s/it] 18%|█▊        | 28/160 [1:15:21<5:54:23, 161.09s/it] 18%|█▊        | 29/160 [1:18:04<5:53:01, 161.69s/it] 19%|█▉        | 30/160 [1:20:48<5:51:57, 162.44s/it] 19%|█▉        | 31/160 [1:23:28<5:47:36, 161.68s/it] 20%|██        | 32/160 [1:26:07<5:43:30, 161.02s/it] 21%|██        | 33/160 [1:28:53<5:43:35, 162.33s/it]slurmstepd: error: *** JOB 1851589 ON vulcan24 CANCELLED AT 2024-01-01T00:35:14 ***
