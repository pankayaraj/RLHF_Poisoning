python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt_350m" --epoch=15 --dataset="hh_original"
------
Some weights of OPTForSequenceClassification were not initialized from the model checkpoint at /cmlscratch/pan/RLHF_Poisoning/models/opt-350m and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/reward_trainer.py:185: UserWarning: When using RewardDataCollatorWithPadding, you should set `remove_unused_columns=False` in your RewardConfig we have set it for you, but you should do it yourself in the future.
  warnings.warn(
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/77355 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/77355 [00:01<29:12:28,  1.36s/it]  0%|          | 2/77355 [00:02<29:54:05,  1.39s/it]  0%|          | 3/77355 [00:03<27:45:58,  1.29s/it]  0%|          | 4/77355 [00:05<28:06:58,  1.31s/it]  0%|          | 5/77355 [00:06<28:01:14,  1.30s/it]  0%|          | 6/77355 [00:07<23:48:08,  1.11s/it]  0%|          | 7/77355 [00:08<25:03:08,  1.17s/it]  0%|          | 8/77355 [00:09<22:20:36,  1.04s/it]  0%|          | 9/77355 [00:09<18:28:47,  1.16it/s]  0%|          | 10/77355 [00:10<20:28:04,  1.05it/s]  0%|          | 11/77355 [00:11<19:25:23,  1.11it/s]  0%|          | 12/77355 [00:12<20:57:51,  1.02it/s]  0%|          | 13/77355 [00:14<23:26:17,  1.09s/it]  0%|          | 14/77355 [00:15<22:45:29,  1.06s/it]  0%|          | 15/77355 [00:16<23:10:10,  1.08s/it]  0%|          | 16/77355 [00:17<25:59:06,  1.21s/it]  0%|          | 17/77355 [00:18<21:14:56,  1.01it/s]  0%|          | 18/77355 [00:19<20:16:42,  1.06it/s]  0%|          | 19/77355 [00:19<18:14:44,  1.18it/s]  0%|          | 20/77355 [00:20<17:10:53,  1.25it/s]  0%|          | 21/77355 [00:21<18:29:13,  1.16it/s]  0%|          | 22/77355 [00:22<22:03:55,  1.03s/it]  0%|          | 23/77355 [00:24<23:59:08,  1.12s/it]  0%|          | 24/77355 [00:25<25:07:45,  1.17s/it]  0%|          | 25/77355 [00:26<25:56:22,  1.21s/it]  0%|          | 26/77355 [00:28<27:38:05,  1.29s/it]  0%|          | 27/77355 [00:29<29:15:53,  1.36s/it]  0%|          | 28/77355 [00:31<29:30:29,  1.37s/it]  0%|          | 29/77355 [00:32<27:41:49,  1.29s/it]  0%|          | 30/77355 [00:33<24:02:18,  1.12s/it]  0%|          | 31/77355 [00:34<22:48:45,  1.06s/it]  0%|          | 32/77355 [00:34<21:58:05,  1.02s/it]  0%|          | 33/77355 [00:35<21:50:26,  1.02s/it]  0%|          | 34/77355 [00:36<19:45:54,  1.09it/s]  0%|          | 35/77355 [00:37<21:06:12,  1.02it/s]  0%|          | 36/77355 [00:38<20:43:43,  1.04it/s]  0%|          | 37/77355 [00:39<22:24:09,  1.04s/it]  0%|          | 38/77355 [00:40<21:37:44,  1.01s/it]  0%|          | 39/77355 [00:41<21:40:50,  1.01s/it]  0%|          | 40/77355 [00:42<19:35:43,  1.10it/s]  0%|          | 41/77355 [00:43<17:36:29,  1.22it/s]  0%|          | 42/77355 [00:43<17:04:39,  1.26it/s]  0%|          | 43/77355 [00:44<18:32:24,  1.16it/s]  0%|          | 44/77355 [00:45<19:27:21,  1.10it/s]  0%|          | 45/77355 [00:46<18:17:20,  1.17it/s]  0%|          | 46/77355 [00:47<20:37:39,  1.04it/s]  0%|          | 47/77355 [00:49<22:33:57,  1.05s/it]  0%|          | 48/77355 [00:50<24:51:35,  1.16s/it]  0%|          | 49/77355 [00:51<25:35:04,  1.19s/it]  0%|          | 50/77355 [00:52<24:35:13,  1.14s/it]  0%|          | 51/77355 [00:54<24:45:53,  1.15s/it]  0%|          | 52/77355 [00:54<21:38:57,  1.01s/it]  0%|          | 53/77355 [00:55<19:55:56,  1.08it/s]  0%|          | 54/77355 [00:56<20:03:14,  1.07it/s]  0%|          | 55/77355 [00:57<21:53:45,  1.02s/it]  0%|          | 56/77355 [00:59<25:05:43,  1.17s/it]  0%|          | 57/77355 [00:59<23:16:53,  1.08s/it]  0%|          | 58/77355 [01:01<23:00:26,  1.07s/it]  0%|          | 59/77355 [01:02<24:29:35,  1.14s/it]  0%|          | 60/77355 [01:03<23:44:11,  1.11s/it]  0%|          | 61/77355 [01:04<23:35:48,  1.10s/it]  0%|          | 62/77355 [01:05<24:18:06,  1.13s/it]  0%|          | 63/77355 [01:06<24:28:52,  1.14s/it]  0%|          | 64/77355 [01:07<22:19:20,  1.04s/it]  0%|          | 65/77355 [01:07<17:36:51,  1.22it/s]  0%|          | 66/77355 [01:08<16:31:11,  1.30it/s]  0%|          | 67/77355 [01:10<21:31:42,  1.00s/it]  0%|          | 68/77355 [01:10<19:55:26,  1.08it/s]  0%|          | 69/77355 [01:12<21:21:34,  1.01it/s]  0%|          | 70/77355 [01:12<19:29:27,  1.10it/s]  0%|          | 71/77355 [01:13<20:48:01,  1.03it/s]  0%|          | 72/77355 [01:14<21:00:40,  1.02it/s]  0%|          | 73/77355 [01:16<23:10:14,  1.08s/it]  0%|          | 74/77355 [01:17<23:48:41,  1.11s/it]  0%|          | 75/77355 [01:18<23:17:20,  1.08s/it]  0%|          | 76/77355 [01:19<22:28:02,  1.05s/it]  0%|          | 77/77355 [01:20<23:30:02,  1.09s/it]  0%|          | 78/77355 [01:21<23:19:10,  1.09s/it]  0%|          | 79/77355 [01:22<23:33:49,  1.10s/it]  0%|          | 80/77355 [01:23<22:16:57,  1.04s/it]  0%|          | 81/77355 [01:24<21:32:12,  1.00s/it]  0%|          | 82/77355 [01:26<24:40:01,  1.15s/it]  0%|          | 83/77355 [01:27<26:32:02,  1.24s/it]  0%|          | 84/77355 [01:28<23:38:02,  1.10s/it]  0%|          | 85/77355 [01:29<24:46:39,  1.15s/it]  0%|          | 86/77355 [01:30<23:10:35,  1.08s/it]  0%|          | 87/77355 [01:31<20:47:21,  1.03it/s]  0%|          | 88/77355 [01:32<22:29:46,  1.05s/it]  0%|          | 89/77355 [01:32<19:34:22,  1.10it/s]  0%|          | 90/77355 [01:34<20:55:41,  1.03it/s]  0%|          | 91/77355 [01:34<20:11:59,  1.06it/s]  0%|          | 92/77355 [01:35<19:40:25,  1.09it/s]  0%|          | 93/77355 [01:37<21:32:26,  1.00s/it]  0%|          | 94/77355 [01:38<21:44:04,  1.01s/it]  0%|          | 95/77355 [01:38<20:37:37,  1.04it/s]  0%|          | 96/77355 [01:40<22:49:17,  1.06s/it]  0%|          | 97/77355 [01:40<20:51:45,  1.03it/s]  0%|          | 98/77355 [01:41<18:56:31,  1.13it/s]  0%|          | 99/77355 [01:42<20:19:11,  1.06it/s]  0%|          | 100/77355 [01:43<21:46:28,  1.01s/it]  0%|          | 101/77355 [01:44<22:09:59,  1.03s/it]  0%|          | 102/77355 [01:46<22:16:31,  1.04s/it]  0%|          | 103/77355 [01:46<19:57:25,  1.08it/s]  0%|          | 104/77355 [01:47<21:07:03,  1.02it/s]  0%|          | 105/77355 [01:49<23:56:23,  1.12s/it]  0%|          | 106/77355 [01:50<23:42:56,  1.11s/it]  0%|          | 107/77355 [01:51<26:32:41,  1.24s/it]  0%|          | 108/77355 [01:53<27:15:40,  1.27s/it]  0%|          | 109/77355 [01:54<26:02:19,  1.21s/it]  0%|          | 110/77355 [01:55<23:47:24,  1.11s/it]  0%|          | 111/77355 [01:56<22:22:21,  1.04s/it]  0%|          | 112/77355 [01:56<20:35:26,  1.04it/s]  0%|          | 113/77355 [01:57<20:28:47,  1.05it/s]  0%|          | 114/77355 [01:58<22:20:32,  1.04s/it]  0%|          | 115/77355 [02:00<25:10:52,  1.17s/it]  0%|          | 116/77355 [02:01<21:54:17,  1.02s/it]  0%|          | 117/77355 [02:02<23:21:55,  1.09s/it]  0%|          | 118/77355 [02:03<23:15:50,  1.08s/it]  0%|          | 119/77355 [02:04<23:05:59,  1.08s/it]  0%|          | 120/77355 [02:05<23:27:50,  1.09s/it]  0%|          | 121/77355 [02:06<21:36:31,  1.01s/it]  0%|          | 122/77355 [02:07<21:52:24,  1.02s/it]  0%|          | 123/77355 [02:08<19:33:05,  1.10it/s]  0%|          | 124/77355 [02:09<20:40:58,  1.04it/s]  0%|          | 125/77355 [02:10<20:31:58,  1.04it/s]  0%|          | 126/77355 [02:11<22:32:49,  1.05s/it]  0%|          | 127/77355 [02:12<19:57:07,  1.08it/s]  0%|          | 128/77355 [02:13<20:31:21,  1.05it/s]  0%|          | 129/77355 [02:13<19:01:57,  1.13it/s]  0%|          | 130/77355 [02:15<23:07:44,  1.08s/it]  0%|          | 131/77355 [02:16<24:41:10,  1.15s/it]  0%|          | 132/77355 [02:18<26:33:57,  1.24s/it]  0%|          | 133/77355 [02:19<27:32:00,  1.28s/it]  0%|          | 134/77355 [02:20<23:37:44,  1.10s/it]  0%|          | 135/77355 [02:20<20:48:10,  1.03it/s]  0%|          | 136/77355 [02:22<23:28:21,  1.09s/it]  0%|          | 137/77355 [02:23<22:42:58,  1.06s/it]  0%|          | 138/77355 [02:24<24:15:57,  1.13s/it]  0%|          | 139/77355 [02:25<26:18:47,  1.23s/it]  0%|          | 140/77355 [02:26<24:32:38,  1.14s/it]  0%|          | 141/77355 [02:28<24:48:45,  1.16s/it]  0%|          | 142/77355 [02:28<22:03:26,  1.03s/it]  0%|          | 143/77355 [02:29<22:32:03,  1.05s/it]  0%|          | 144/77355 [02:31<25:20:20,  1.18s/it]  0%|          | 145/77355 [02:32<26:52:28,  1.25s/it]  0%|          | 146/77355 [02:33<24:04:03,  1.12s/it]  0%|          | 147/77355 [02:34<23:35:16,  1.10s/it]  0%|          | 148/77355 [02:35<21:13:57,  1.01it/s]  0%|          | 149/77355 [02:36<23:36:34,  1.10s/it]  0%|          | 150/77355 [02:37<20:00:19,  1.07it/s]  0%|          | 151/77355 [02:38<22:29:19,  1.05s/it]  0%|          | 152/77355 [02:39<20:19:42,  1.05it/s]  0%|          | 153/77355 [02:40<18:42:39,  1.15it/s]  0%|          | 154/77355 [02:40<18:28:49,  1.16it/s]  0%|          | 155/77355 [02:42<22:41:04,  1.06s/it]  0%|          | 156/77355 [02:43<19:51:16,  1.08it/s]  0%|          | 157/77355 [02:43<18:37:40,  1.15it/s]  0%|          | 158/77355 [02:44<20:27:50,  1.05it/s]  0%|          | 159/77355 [02:45<20:17:43,  1.06it/s]  0%|          | 160/77355 [02:47<22:42:38,  1.06s/it]  0%|          | 161/77355 [02:48<24:38:56,  1.15s/it]  0%|          | 162/77355 [02:49<22:56:49,  1.07s/it]  0%|          | 163/77355 [02:50<24:51:33,  1.16s/it]  0%|          | 164/77355 [02:51<21:28:52,  1.00s/it]  0%|          | 165/77355 [02:52<19:30:52,  1.10it/s]  0%|          | 166/77355 [02:52<18:17:20,  1.17it/s]  0%|          | 167/77355 [02:54<22:14:01,  1.04s/it]  0%|          | 168/77355 [02:55<24:16:07,  1.13s/it]  0%|          | 169/77355 [02:56<25:00:16,  1.17s/it]  0%|          | 170/77355 [02:57<22:29:25,  1.05s/it]  0%|          | 171/77355 [02:58<20:52:05,  1.03it/s]  0%|          | 172/77355 [02:59<20:33:03,  1.04it/s]  0%|          | 173/77355 [03:00<21:12:35,  1.01it/s]  0%|          | 174/77355 [03:01<21:22:23,  1.00it/s]  0%|          | 175/77355 [03:02<21:17:11,  1.01it/s]  0%|          | 176/77355 [03:03<19:59:50,  1.07it/s]  0%|          | 177/77355 [03:04<19:47:56,  1.08it/s]  0%|          | 178/77355 [03:04<18:45:09,  1.14it/s]  0%|          | 179/77355 [03:05<17:59:26,  1.19it/s]  0%|          | 180/77355 [03:06<17:17:21,  1.24it/s]  0%|          | 181/77355 [03:07<17:45:02,  1.21it/s]  0%|          | 182/77355 [03:08<21:33:44,  1.01s/it]  0%|          | 183/77355 [03:10<24:03:02,  1.12s/it]  0%|          | 184/77355 [03:10<22:04:52,  1.03s/it]  0%|          | 185/77355 [03:11<22:10:39,  1.03s/it]  0%|          | 186/77355 [03:13<23:44:30,  1.11s/it]  0%|          | 187/77355 [03:14<26:33:46,  1.24s/it]  0%|          | 188/77355 [03:15<24:18:01,  1.13s/it]  0%|          | 189/77355 [03:16<23:11:25,  1.08s/it]  0%|          | 190/77355 [03:17<21:50:00,  1.02s/it]  0%|          | 191/77355 [03:18<19:31:35,  1.10it/s]  0%|          | 192/77355 [03:19<22:32:26,  1.05s/it]  0%|          | 193/77355 [03:20<23:46:30,  1.11s/it]  0%|          | 194/77355 [03:21<22:09:49,  1.03s/it]  0%|          | 195/77355 [03:23<24:31:35,  1.14s/it]  0%|          | 196/77355 [03:24<25:53:14,  1.21s/it]  0%|          | 197/77355 [03:25<24:44:32,  1.15s/it]  0%|          | 198/77355 [03:26<25:09:58,  1.17s/it]  0%|          | 199/77355 [03:27<22:36:30,  1.05s/it]  0%|          | 200/77355 [03:28<23:23:17,  1.09s/it]  0%|          | 201/77355 [03:29<20:06:00,  1.07it/s]  0%|          | 202/77355 [03:30<23:56:09,  1.12s/it]  0%|          | 203/77355 [03:31<20:11:56,  1.06it/s]  0%|          | 204/77355 [03:31<18:19:49,  1.17it/s]  0%|          | 205/77355 [03:32<16:51:09,  1.27it/s]  0%|          | 206/77355 [03:33<17:46:54,  1.21it/s]  0%|          | 207/77355 [03:34<19:33:17,  1.10it/s]  0%|          | 208/77355 [03:35<18:39:16,  1.15it/s]  0%|          | 209/77355 [03:36<17:11:53,  1.25it/s]  0%|          | 210/77355 [03:36<18:22:25,  1.17it/s]  0%|          | 211/77355 [03:38<21:14:44,  1.01it/s]  0%|          | 212/77355 [03:39<20:29:56,  1.05it/s]  0%|          | 213/77355 [03:39<18:52:50,  1.13it/s]  0%|          | 214/77355 [03:40<19:18:01,  1.11it/s]  0%|          | 215/77355 [03:41<18:11:42,  1.18it/s]  0%|          | 216/77355 [03:42<17:31:26,  1.22it/s]  0%|          | 217/77355 [03:43<19:20:20,  1.11it/s]  0%|          | 218/77355 [03:44<21:41:08,  1.01s/it]  0%|          | 219/77355 [03:45<19:43:35,  1.09it/s]  0%|          | 220/77355 [03:46<21:42:12,  1.01s/it]  0%|          | 221/77355 [03:47<22:46:19,  1.06s/it]  0%|          | 222/77355 [03:48<21:22:33,  1.00it/s]  0%|          | 223/77355 [03:49<23:11:48,  1.08s/it]  0%|          | 224/77355 [03:51<23:21:05,  1.09s/it]  0%|          | 225/77355 [03:52<26:06:14,  1.22s/it]  0%|          | 226/77355 [03:53<23:42:41,  1.11s/it]  0%|          | 227/77355 [03:54<24:04:42,  1.12s/it]  0%|          | 228/77355 [03:55<24:52:15,  1.16s/it]  0%|          | 229/77355 [03:56<23:42:58,  1.11s/it]  0%|          | 230/77355 [03:57<23:24:28,  1.09s/it]  0%|          | 231/77355 [03:59<25:33:49,  1.19s/it]  0%|          | 232/77355 [04:00<23:52:48,  1.11s/it]  0%|          | 233/77355 [04:01<22:22:57,  1.04s/it]  0%|          | 234/77355 [04:02<23:45:17,  1.11s/it]  0%|          | 235/77355 [04:03<25:30:17,  1.19s/it]  0%|          | 236/77355 [04:04<22:26:32,  1.05s/it]  0%|          | 237/77355 [04:05<22:07:23,  1.03s/it]  0%|          | 238/77355 [04:06<24:10:15,  1.13s/it]  0%|          | 239/77355 [04:07<24:24:41,  1.14s/it]  0%|          | 240/77355 [04:08<21:53:50,  1.02s/it]  0%|          | 241/77355 [04:10<24:04:54,  1.12s/it]  0%|          | 242/77355 [04:10<22:21:15,  1.04s/it]  0%|          | 243/77355 [04:11<22:00:06,  1.03s/it]  0%|          | 244/77355 [04:12<19:02:23,  1.12it/s]  0%|          | 245/77355 [04:13<19:10:04,  1.12it/s]  0%|          | 246/77355 [04:13<17:10:04,  1.25it/s]  0%|          | 247/77355 [04:14<18:13:59,  1.17it/s]  0%|          | 248/77355 [04:15<18:41:21,  1.15it/s]  0%|          | 249/77355 [04:16<18:21:32,  1.17it/s]  0%|          | 250/77355 [04:17<20:51:52,  1.03it/s]  0%|          | 251/77355 [04:19<23:50:28,  1.11s/it]  0%|          | 252/77355 [04:20<24:42:33,  1.15s/it]  0%|          | 253/77355 [04:21<25:03:56,  1.17s/it]  0%|          | 254/77355 [04:22<23:39:43,  1.10s/it]  0%|          | 255/77355 [04:23<24:15:39,  1.13s/it]  0%|          | 256/77355 [04:25<23:51:18,  1.11s/it]  0%|          | 257/77355 [04:25<22:20:45,  1.04s/it]  0%|          | 258/77355 [04:26<22:01:57,  1.03s/it]slurmstepd: error: *** JOB 1846340 ON tron00 CANCELLED AT 2023-12-29T15:06:39 ***
  0%|          | 259/77355 [04:27<21:01:01,  1.02it/s]