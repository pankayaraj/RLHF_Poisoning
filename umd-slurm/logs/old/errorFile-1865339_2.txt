python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt-350m" --epoch=10 --sft_epoch=5 --dataset="hh_poisoned" --per=0.01
------
Some weights of OPTForSequenceClassification were not initialized from the model checkpoint at /cmlscratch/pan/RLHF_Poisoning/models/trained_sft/opt-350m_5_hh_poisoned_0.05 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/400 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/400 [02:39<17:39:28, 159.32s/it]  0%|          | 2/400 [05:19<17:40:18, 159.85s/it]  1%|          | 3/400 [08:00<17:42:29, 160.58s/it]  1%|          | 4/400 [10:40<17:37:11, 160.18s/it]  1%|▏         | 5/400 [13:21<17:35:56, 160.40s/it]  2%|▏         | 6/400 [16:07<17:46:07, 162.36s/it]  2%|▏         | 7/400 [18:52<17:48:31, 163.13s/it]  2%|▏         | 8/400 [21:35<17:46:56, 163.31s/it]  2%|▏         | 9/400 [24:15<17:36:08, 162.07s/it]  2%|▎         | 10/400 [26:59<17:37:09, 162.64s/it]  3%|▎         | 11/400 [29:37<17:25:56, 161.33s/it]  3%|▎         | 12/400 [32:10<17:06:57, 158.81s/it]  3%|▎         | 13/400 [34:45<16:56:23, 157.58s/it]  4%|▎         | 14/400 [37:27<17:02:25, 158.93s/it]  4%|▍         | 15/400 [40:10<17:07:48, 160.18s/it]  4%|▍         | 16/400 [42:49<17:02:26, 159.76s/it]  4%|▍         | 17/400 [45:17<16:37:13, 156.22s/it]  4%|▍         | 18/400 [48:03<16:53:30, 159.19s/it]  5%|▍         | 19/400 [50:36<16:40:00, 157.48s/it]  5%|▌         | 20/400 [53:18<16:45:23, 158.75s/it]  5%|▌         | 21/400 [55:57<16:43:24, 158.85s/it]  6%|▌         | 22/400 [58:37<16:43:16, 159.25s/it]  6%|▌         | 23/400 [1:01:22<16:51:31, 160.99s/it]  6%|▌         | 24/400 [1:03:56<16:34:30, 158.70s/it]  6%|▋         | 25/400 [1:06:39<16:39:50, 159.97s/it]  6%|▋         | 26/400 [1:09:19<16:37:31, 160.03s/it]  7%|▋         | 27/400 [1:11:57<16:31:48, 159.54s/it]  7%|▋         | 28/400 [1:14:36<16:27:48, 159.32s/it]  7%|▋         | 29/400 [1:17:22<16:38:25, 161.47s/it]  8%|▊         | 30/400 [1:20:00<16:27:47, 160.18s/it]  8%|▊         | 31/400 [1:22:41<16:27:28, 160.56s/it]  8%|▊         | 32/400 [1:25:23<16:27:17, 160.97s/it]  8%|▊         | 33/400 [1:28:08<16:31:24, 162.08s/it]  8%|▊         | 34/400 [1:30:44<16:18:32, 160.42s/it]  9%|▉         | 35/400 [1:33:28<16:21:22, 161.32s/it]  9%|▉         | 36/400 [1:36:02<16:06:42, 159.35s/it]  9%|▉         | 37/400 [1:38:40<16:00:08, 158.70s/it] 10%|▉         | 38/400 [1:41:19<15:59:26, 159.02s/it] 10%|▉         | 39/400 [1:43:58<15:56:06, 158.91s/it] 10%|█         | 40/400 [1:46:41<16:00:05, 160.01s/it] 10%|█         | 41/400 [1:49:16<15:48:23, 158.50s/it] 10%|█         | 42/400 [1:51:57<15:51:22, 159.45s/it] 11%|█         | 43/400 [1:54:36<15:46:41, 159.11s/it] 11%|█         | 44/400 [1:57:17<15:48:44, 159.90s/it] 11%|█▏        | 45/400 [1:59:57<15:44:58, 159.72s/it] 12%|█▏        | 46/400 [2:02:32<15:34:00, 158.31s/it] 12%|█▏        | 47/400 [2:05:10<15:32:21, 158.48s/it] 12%|█▏        | 48/400 [2:07:56<15:42:43, 160.69s/it] 12%|█▏        | 49/400 [2:10:39<15:44:09, 161.40s/it] 12%|█▎        | 50/400 [2:13:16<15:32:36, 159.88s/it] 13%|█▎        | 51/400 [2:15:58<15:33:46, 160.53s/it] 13%|█▎        | 52/400 [2:18:36<15:26:30, 159.74s/it] 13%|█▎        | 53/400 [2:21:17<15:26:52, 160.27s/it] 14%|█▎        | 54/400 [2:24:00<15:28:22, 160.99s/it] 14%|█▍        | 55/400 [2:26:38<15:20:53, 160.16s/it] 14%|█▍        | 56/400 [2:29:23<15:26:21, 161.58s/it] 14%|█▍        | 57/400 [2:32:06<15:25:52, 161.96s/it] 14%|█▍        | 58/400 [2:34:53<15:31:14, 163.38s/it] 15%|█▍        | 59/400 [2:37:26<15:11:59, 160.47s/it] 15%|█▌        | 60/400 [2:40:09<15:14:09, 161.32s/it] 15%|█▌        | 61/400 [2:42:48<15:07:01, 160.53s/it] 16%|█▌        | 62/400 [2:45:28<15:02:19, 160.18s/it] 16%|█▌        | 63/400 [2:48:07<14:58:17, 159.93s/it] 16%|█▌        | 64/400 [2:50:54<15:08:11, 162.18s/it] 16%|█▋        | 65/400 [2:53:32<14:57:29, 160.74s/it] 16%|█▋        | 66/400 [2:56:15<14:59:09, 161.52s/it] 17%|█▋        | 67/400 [2:58:52<14:49:36, 160.29s/it] 17%|█▋        | 68/400 [3:01:28<14:38:56, 158.85s/it] 17%|█▋        | 69/400 [3:04:15<14:50:26, 161.41s/it] 18%|█▊        | 70/400 [3:06:55<14:45:33, 161.01s/it] 18%|█▊        | 71/400 [3:09:36<14:42:26, 160.93s/it] 18%|█▊        | 72/400 [3:12:22<14:47:05, 162.27s/it] 18%|█▊        | 73/400 [3:14:56<14:32:05, 160.02s/it] 18%|█▊        | 74/400 [3:17:43<14:39:34, 161.88s/it] 19%|█▉        | 75/400 [3:20:25<14:38:19, 162.15s/it] 19%|█▉        | 76/400 [3:23:05<14:31:22, 161.37s/it] 19%|█▉        | 77/400 [3:25:44<14:24:23, 160.57s/it] 20%|█▉        | 78/400 [3:28:14<14:06:03, 157.65s/it] 20%|█▉        | 79/400 [3:30:58<14:13:12, 159.48s/it] 20%|██        | 80/400 [3:33:41<14:16:23, 160.57s/it] 20%|██        | 81/400 [3:36:10<13:54:02, 156.87s/it] 20%|██        | 82/400 [3:38:49<13:55:56, 157.72s/it] 21%|██        | 83/400 [3:41:28<13:55:36, 158.16s/it] 21%|██        | 84/400 [3:44:06<13:52:48, 158.13s/it] 21%|██▏       | 85/400 [3:46:53<14:02:46, 160.53s/it] 22%|██▏       | 86/400 [3:49:33<13:59:21, 160.39s/it] 22%|██▏       | 87/400 [3:52:13<13:55:52, 160.23s/it] 22%|██▏       | 88/400 [3:54:46<13:42:08, 158.10s/it] 22%|██▏       | 89/400 [3:57:24<13:40:38, 158.32s/it] 22%|██▎       | 90/400 [4:00:04<13:39:57, 158.70s/it] 23%|██▎       | 91/400 [4:02:37<13:28:21, 156.96s/it] 23%|██▎       | 92/400 [4:05:25<13:42:11, 160.17s/it] 23%|██▎       | 93/400 [4:08:06<13:41:06, 160.48s/it] 24%|██▎       | 94/400 [4:10:49<13:42:08, 161.20s/it] 24%|██▍       | 95/400 [4:13:24<13:29:43, 159.29s/it] 24%|██▍       | 96/400 [4:16:03<13:27:13, 159.32s/it] 24%|██▍       | 97/400 [4:18:41<13:22:41, 158.95s/it] 24%|██▍       | 98/400 [4:21:19<13:17:51, 158.52s/it] 25%|██▍       | 99/400 [4:23:58<13:16:17, 158.73s/it] 25%|██▌       | 100/400 [4:26:39<13:17:29, 159.50s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.01/checkpoint-100 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 25%|██▌       | 101/400 [4:29:15<13:09:15, 158.38s/it] 26%|██▌       | 102/400 [4:32:00<13:16:05, 160.29s/it] 26%|██▌       | 103/400 [4:34:39<13:12:36, 160.12s/it] 26%|██▌       | 104/400 [4:37:19<13:08:53, 159.91s/it] 26%|██▋       | 105/400 [4:39:57<13:04:30, 159.56s/it] 26%|██▋       | 106/400 [4:42:37<13:02:21, 159.66s/it] 27%|██▋       | 107/400 [4:45:19<13:03:13, 160.39s/it] 27%|██▋       | 108/400 [4:48:00<13:01:12, 160.52s/it] 27%|██▋       | 109/400 [4:50:40<12:57:11, 160.25s/it] 28%|██▊       | 110/400 [4:53:11<12:41:14, 157.50s/it] 28%|██▊       | 111/400 [4:55:49<12:40:02, 157.80s/it] 28%|██▊       | 112/400 [4:58:35<12:48:55, 160.19s/it] 28%|██▊       | 113/400 [5:01:14<12:44:09, 159.75s/it] 28%|██▊       | 114/400 [5:04:02<12:53:11, 162.21s/it] 29%|██▉       | 115/400 [5:06:37<12:40:51, 160.18s/it] 29%|██▉       | 116/400 [5:09:19<12:40:15, 160.62s/it] 29%|██▉       | 117/400 [5:11:58<12:35:09, 160.10s/it] 30%|██▉       | 118/400 [5:14:32<12:24:33, 158.42s/it] 30%|██▉       | 119/400 [5:17:12<12:23:03, 158.66s/it] 30%|███       | 120/400 [5:19:59<12:32:21, 161.22s/it] 30%|███       | 121/400 [5:22:41<12:30:51, 161.48s/it] 30%|███       | 122/400 [5:25:28<12:36:18, 163.23s/it] 31%|███       | 123/400 [5:28:13<12:35:21, 163.62s/it] 31%|███       | 124/400 [5:30:55<12:30:49, 163.22s/it] 31%|███▏      | 125/400 [5:33:36<12:24:27, 162.43s/it] 32%|███▏      | 126/400 [5:36:15<12:17:11, 161.43s/it] 32%|███▏      | 127/400 [5:38:49<12:05:09, 159.38s/it] 32%|███▏      | 128/400 [5:41:33<12:08:36, 160.72s/it] 32%|███▏      | 129/400 [5:44:14<12:06:44, 160.90s/it] 32%|███▎      | 130/400 [5:46:53<12:01:14, 160.28s/it] 33%|███▎      | 131/400 [5:49:36<12:01:58, 161.03s/it] 33%|███▎      | 132/400 [5:52:17<11:58:52, 160.94s/it] 33%|███▎      | 133/400 [5:55:02<12:02:23, 162.34s/it] 34%|███▎      | 134/400 [5:57:50<12:06:42, 163.92s/it] 34%|███▍      | 135/400 [6:00:32<12:01:44, 163.42s/it] 34%|███▍      | 136/400 [6:03:15<11:57:48, 163.14s/it] 34%|███▍      | 137/400 [6:05:57<11:53:35, 162.79s/it] 34%|███▍      | 138/400 [6:08:36<11:46:39, 161.83s/it] 35%|███▍      | 139/400 [6:11:22<11:49:20, 163.07s/it] 35%|███▌      | 140/400 [6:14:04<11:44:40, 162.62s/it] 35%|███▌      | 141/400 [6:16:45<11:40:17, 162.23s/it] 36%|███▌      | 142/400 [6:19:26<11:35:40, 161.79s/it] 36%|███▌      | 143/400 [6:22:08<11:33:43, 161.96s/it] 36%|███▌      | 144/400 [6:24:46<11:25:11, 160.59s/it] 36%|███▋      | 145/400 [6:27:24<11:19:21, 159.85s/it] 36%|███▋      | 146/400 [6:30:08<11:21:55, 161.08s/it] 37%|███▋      | 147/400 [6:32:47<11:16:42, 160.49s/it] 37%|███▋      | 148/400 [6:35:32<11:19:48, 161.86s/it] 37%|███▋      | 149/400 [6:38:11<11:13:30, 161.00s/it] 38%|███▊      | 150/400 [6:40:51<11:09:49, 160.76s/it] 38%|███▊      | 151/400 [6:43:33<11:08:08, 161.00s/it] 38%|███▊      | 152/400 [6:46:12<11:03:39, 160.56s/it] 38%|███▊      | 153/400 [6:48:53<11:01:27, 160.68s/it] 38%|███▊      | 154/400 [6:51:29<10:52:56, 159.26s/it] 39%|███▉      | 155/400 [6:54:11<10:53:23, 160.01s/it] 39%|███▉      | 156/400 [6:56:47<10:45:48, 158.80s/it] 39%|███▉      | 157/400 [6:59:25<10:42:29, 158.64s/it] 40%|███▉      | 158/400 [7:02:08<10:45:28, 160.03s/it] 40%|███▉      | 159/400 [7:04:48<10:42:46, 160.03s/it] 40%|████      | 160/400 [7:07:25<10:36:03, 159.01s/it] 40%|████      | 161/400 [7:10:00<10:28:35, 157.81s/it] 40%|████      | 162/400 [7:12:42<10:30:45, 159.01s/it] 41%|████      | 163/400 [7:15:31<10:39:54, 162.00s/it] 41%|████      | 164/400 [7:18:07<10:29:49, 160.12s/it] 41%|████▏     | 165/400 [7:20:48<10:28:25, 160.45s/it] 42%|████▏     | 166/400 [7:23:22<10:18:58, 158.71s/it] 42%|████▏     | 167/400 [7:26:04<10:20:07, 159.69s/it] 42%|████▏     | 168/400 [7:28:45<10:18:53, 160.06s/it] 42%|████▏     | 169/400 [7:31:27<10:18:24, 160.63s/it] 42%|████▎     | 170/400 [7:34:08<10:15:36, 160.59s/it] 43%|████▎     | 171/400 [7:36:47<10:11:17, 160.16s/it] 43%|████▎     | 172/400 [7:39:27<10:08:46, 160.20s/it] 43%|████▎     | 173/400 [7:42:08<10:07:02, 160.45s/it] 44%|████▎     | 174/400 [7:44:54<10:10:22, 162.05s/it] 44%|████▍     | 175/400 [7:47:35<10:06:45, 161.80s/it] 44%|████▍     | 176/400 [7:50:13<9:59:26, 160.57s/it]  44%|████▍     | 177/400 [7:52:53<9:55:38, 160.26s/it] 44%|████▍     | 178/400 [7:55:34<9:54:44, 160.74s/it] 45%|████▍     | 179/400 [7:58:12<9:48:41, 159.83s/it] 45%|████▌     | 180/400 [8:00:48<9:41:27, 158.58s/it] 45%|████▌     | 181/400 [8:03:27<9:39:16, 158.71s/it] 46%|████▌     | 182/400 [8:06:04<9:35:03, 158.27s/it] 46%|████▌     | 183/400 [8:08:48<9:38:16, 159.89s/it] 46%|████▌     | 184/400 [8:11:32<9:39:57, 161.10s/it] 46%|████▋     | 185/400 [8:14:11<9:35:23, 160.58s/it] 46%|████▋     | 186/400 [8:16:54<9:35:01, 161.22s/it] 47%|████▋     | 187/400 [8:19:33<9:30:23, 160.67s/it] 47%|████▋     | 188/400 [8:22:18<9:32:11, 161.94s/it] 47%|████▋     | 189/400 [8:24:56<9:25:22, 160.77s/it] 48%|████▊     | 190/400 [8:27:35<9:21:08, 160.33s/it] 48%|████▊     | 191/400 [8:30:14<9:17:00, 159.91s/it] 48%|████▊     | 192/400 [8:32:49<9:08:41, 158.28s/it] 48%|████▊     | 193/400 [8:35:28<9:07:19, 158.65s/it] 48%|████▊     | 194/400 [8:38:08<9:05:41, 158.94s/it] 49%|████▉     | 195/400 [8:40:54<9:10:03, 160.99s/it] 49%|████▉     | 196/400 [8:43:31<9:03:37, 159.89s/it] 49%|████▉     | 197/400 [8:46:09<8:58:43, 159.23s/it] 50%|████▉     | 198/400 [8:48:56<9:04:40, 161.79s/it] 50%|████▉     | 199/400 [8:51:41<9:04:50, 162.64s/it] 50%|█████     | 200/400 [8:54:26<9:04:01, 163.21s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.01/checkpoint-200 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 50%|█████     | 201/400 [8:57:13<9:05:48, 164.56s/it] 50%|█████     | 202/400 [8:59:51<8:56:16, 162.51s/it] 51%|█████     | 203/400 [9:02:31<8:50:37, 161.61s/it] 51%|█████     | 204/400 [9:05:14<8:49:24, 162.06s/it] 51%|█████▏    | 205/400 [9:07:54<8:44:58, 161.53s/it] 52%|█████▏    | 206/400 [9:10:29<8:36:27, 159.73s/it] 52%|█████▏    | 207/400 [9:13:14<8:38:01, 161.05s/it] 52%|█████▏    | 208/400 [9:15:52<8:33:18, 160.41s/it] 52%|█████▏    | 209/400 [9:18:34<8:31:51, 160.79s/it] 52%|█████▎    | 210/400 [9:21:15<8:28:52, 160.70s/it] 53%|█████▎    | 211/400 [9:24:02<8:32:10, 162.60s/it] 53%|█████▎    | 212/400 [9:26:36<8:21:18, 159.99s/it] 53%|█████▎    | 213/400 [9:29:07<8:10:10, 157.28s/it] 54%|█████▎    | 214/400 [9:31:49<8:12:04, 158.73s/it] 54%|█████▍    | 215/400 [9:34:23<8:05:44, 157.54s/it] 54%|█████▍    | 216/400 [9:37:07<8:08:35, 159.33s/it] 54%|█████▍    | 217/400 [9:39:39<7:58:54, 157.02s/it] 55%|█████▍    | 218/400 [9:42:23<8:03:15, 159.32s/it] 55%|█████▍    | 219/400 [9:44:59<7:57:16, 158.21s/it] 55%|█████▌    | 220/400 [9:47:37<7:54:34, 158.19s/it] 55%|█████▌    | 221/400 [9:50:24<8:00:13, 160.97s/it] 56%|█████▌    | 222/400 [9:53:03<7:55:11, 160.17s/it] 56%|█████▌    | 223/400 [9:55:45<7:53:53, 160.64s/it] 56%|█████▌    | 224/400 [9:58:21<7:47:18, 159.31s/it] 56%|█████▋    | 225/400 [10:00:58<7:42:40, 158.63s/it] 56%|█████▋    | 226/400 [10:03:40<7:43:07, 159.70s/it] 57%|█████▋    | 227/400 [10:06:25<7:45:21, 161.40s/it] 57%|█████▋    | 228/400 [10:09:08<7:43:30, 161.69s/it] 57%|█████▋    | 229/400 [10:11:41<7:33:55, 159.27s/it] 57%|█████▊    | 230/400 [10:14:22<7:32:26, 159.68s/it] 58%|█████▊    | 231/400 [10:16:54<7:23:32, 157.47s/it] 58%|█████▊    | 232/400 [10:19:40<7:27:27, 159.80s/it] 58%|█████▊    | 233/400 [10:22:22<7:27:21, 160.73s/it] 58%|█████▊    | 234/400 [10:25:02<7:23:52, 160.43s/it] 59%|█████▉    | 235/400 [10:27:42<7:20:44, 160.27s/it] 59%|█████▉    | 236/400 [10:30:23<7:18:49, 160.55s/it] 59%|█████▉    | 237/400 [10:33:07<7:18:49, 161.53s/it] 60%|█████▉    | 238/400 [10:35:45<7:12:56, 160.35s/it] 60%|█████▉    | 239/400 [10:38:22<7:07:35, 159.35s/it] 60%|██████    | 240/400 [10:41:00<7:04:09, 159.06s/it] 60%|██████    | 241/400 [10:43:42<7:03:43, 159.89s/it] 60%|██████    | 242/400 [10:46:22<7:01:36, 160.10s/it] 61%|██████    | 243/400 [10:49:03<6:58:57, 160.11s/it] 61%|██████    | 244/400 [10:51:43<6:56:16, 160.11s/it] 61%|██████▏   | 245/400 [10:54:16<6:48:13, 158.02s/it] 62%|██████▏   | 246/400 [10:56:50<6:42:38, 156.88s/it] 62%|██████▏   | 247/400 [10:59:33<6:44:41, 158.70s/it] 62%|██████▏   | 248/400 [11:02:16<6:45:22, 160.02s/it] 62%|██████▏   | 249/400 [11:05:03<6:47:53, 162.08s/it] 62%|██████▎   | 250/400 [11:07:39<6:40:32, 160.22s/it] 63%|██████▎   | 251/400 [11:10:16<6:35:25, 159.23s/it] 63%|██████▎   | 252/400 [11:13:02<6:37:55, 161.32s/it] 63%|██████▎   | 253/400 [11:15:45<6:36:09, 161.69s/it] 64%|██████▎   | 254/400 [11:18:21<6:29:58, 160.26s/it] 64%|██████▍   | 255/400 [11:21:00<6:26:06, 159.77s/it] 64%|██████▍   | 256/400 [11:23:42<6:25:13, 160.51s/it] 64%|██████▍   | 257/400 [11:26:24<6:23:17, 160.82s/it] 64%|██████▍   | 258/400 [11:29:03<6:19:14, 160.24s/it] 65%|██████▍   | 259/400 [11:31:38<6:13:08, 158.78s/it] 65%|██████▌   | 260/400 [11:34:16<6:10:09, 158.64s/it] 65%|██████▌   | 261/400 [11:36:57<6:09:06, 159.33s/it] 66%|██████▌   | 262/400 [11:39:37<6:06:29, 159.35s/it] 66%|██████▌   | 263/400 [11:42:27<6:11:21, 162.64s/it] 66%|██████▌   | 264/400 [11:45:10<6:09:02, 162.81s/it] 66%|██████▋   | 265/400 [11:47:41<5:58:02, 159.13s/it] 66%|██████▋   | 266/400 [11:50:31<6:02:27, 162.30s/it] 67%|██████▋   | 267/400 [11:53:10<5:58:04, 161.54s/it] 67%|██████▋   | 268/400 [11:55:47<5:52:25, 160.19s/it] 67%|██████▋   | 269/400 [11:58:26<5:48:36, 159.67s/it] 68%|██████▊   | 270/400 [12:01:08<5:47:51, 160.55s/it] 68%|██████▊   | 271/400 [12:03:47<5:43:44, 159.88s/it] 68%|██████▊   | 272/400 [12:06:20<5:36:58, 157.96s/it] 68%|██████▊   | 273/400 [12:09:00<5:35:43, 158.61s/it] 68%|██████▊   | 274/400 [12:11:39<5:33:22, 158.75s/it] 69%|██████▉   | 275/400 [12:14:23<5:33:28, 160.07s/it] 69%|██████▉   | 276/400 [12:17:00<5:29:21, 159.37s/it] 69%|██████▉   | 277/400 [12:19:40<5:26:50, 159.43s/it] 70%|██████▉   | 278/400 [12:22:20<5:24:17, 159.49s/it] 70%|██████▉   | 279/400 [12:25:01<5:22:42, 160.02s/it] 70%|███████   | 280/400 [12:27:42<5:20:33, 160.28s/it] 70%|███████   | 281/400 [12:30:10<5:11:01, 156.82s/it] 70%|███████   | 282/400 [12:32:56<5:13:18, 159.31s/it] 71%|███████   | 283/400 [12:35:31<5:08:24, 158.16s/it] 71%|███████   | 284/400 [12:38:09<5:05:28, 158.01s/it] 71%|███████▏  | 285/400 [12:40:47<5:03:00, 158.09s/it] 72%|███████▏  | 286/400 [12:43:28<5:01:55, 158.90s/it] 72%|███████▏  | 287/400 [12:46:11<5:01:30, 160.09s/it] 72%|███████▏  | 288/400 [12:48:49<4:57:39, 159.46s/it] 72%|███████▏  | 289/400 [12:51:26<4:53:44, 158.78s/it] 72%|███████▎  | 290/400 [12:54:05<4:51:20, 158.91s/it] 73%|███████▎  | 291/400 [12:56:42<4:47:35, 158.30s/it] 73%|███████▎  | 292/400 [12:59:16<4:42:49, 157.12s/it] 73%|███████▎  | 293/400 [13:01:54<4:40:20, 157.20s/it] 74%|███████▎  | 294/400 [13:04:36<4:40:32, 158.80s/it] 74%|███████▍  | 295/400 [13:07:26<4:43:27, 161.98s/it] 74%|███████▍  | 296/400 [13:10:09<4:41:45, 162.55s/it] 74%|███████▍  | 297/400 [13:12:53<4:39:39, 162.91s/it] 74%|███████▍  | 298/400 [13:15:35<4:36:11, 162.47s/it] 75%|███████▍  | 299/400 [13:18:18<4:34:05, 162.83s/it] 75%|███████▌  | 300/400 [13:20:59<4:30:31, 162.32s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.01/checkpoint-300 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 75%|███████▌  | 301/400 [13:23:45<4:29:16, 163.19s/it] 76%|███████▌  | 302/400 [13:26:20<4:22:45, 160.87s/it] 76%|███████▌  | 303/400 [13:28:57<4:18:04, 159.64s/it] 76%|███████▌  | 304/400 [13:31:35<4:14:53, 159.31s/it] 76%|███████▋  | 305/400 [13:34:20<4:14:37, 160.82s/it] 76%|███████▋  | 306/400 [13:36:55<4:09:12, 159.07s/it] 77%|███████▋  | 307/400 [13:39:32<4:05:43, 158.53s/it] 77%|███████▋  | 308/400 [13:42:13<4:03:58, 159.12s/it] 77%|███████▋  | 309/400 [13:44:55<4:03:05, 160.28s/it] 78%|███████▊  | 310/400 [13:47:36<4:00:32, 160.36s/it] 78%|███████▊  | 311/400 [13:50:15<3:57:22, 160.03s/it] 78%|███████▊  | 312/400 [13:52:52<3:53:20, 159.10s/it] 78%|███████▊  | 313/400 [13:55:33<3:51:32, 159.68s/it] 78%|███████▊  | 314/400 [13:58:21<3:52:29, 162.20s/it] 79%|███████▉  | 315/400 [14:01:03<3:49:26, 161.96s/it] 79%|███████▉  | 316/400 [14:03:32<3:41:14, 158.03s/it] 79%|███████▉  | 317/400 [14:06:08<3:37:55, 157.54s/it] 80%|███████▉  | 318/400 [14:08:45<3:35:13, 157.48s/it] 80%|███████▉  | 319/400 [14:11:18<3:30:42, 156.08s/it] 80%|████████  | 320/400 [14:13:58<3:29:30, 157.14s/it] 80%|████████  | 321/400 [14:16:37<3:27:39, 157.72s/it] 80%|████████  | 322/400 [14:19:22<3:27:52, 159.90s/it] 81%|████████  | 323/400 [14:21:53<3:22:00, 157.41s/it] 81%|████████  | 324/400 [14:24:35<3:20:52, 158.59s/it] 81%|████████▏ | 325/400 [14:27:15<3:18:49, 159.06s/it] 82%|████████▏ | 326/400 [14:29:47<3:13:40, 157.03s/it] 82%|████████▏ | 327/400 [14:32:20<3:09:24, 155.68s/it] 82%|████████▏ | 328/400 [14:34:54<3:06:28, 155.39s/it] 82%|████████▏ | 329/400 [14:37:30<3:04:05, 155.56s/it] 82%|████████▎ | 330/400 [14:40:15<3:04:33, 158.19s/it] 83%|████████▎ | 331/400 [14:42:51<3:01:23, 157.73s/it] 83%|████████▎ | 332/400 [14:45:33<2:59:54, 158.75s/it] 83%|████████▎ | 333/400 [14:48:09<2:56:26, 158.01s/it] 84%|████████▎ | 334/400 [14:50:50<2:54:58, 159.07s/it] 84%|████████▍ | 335/400 [14:53:33<2:53:38, 160.28s/it] 84%|████████▍ | 336/400 [14:56:16<2:51:44, 161.01s/it] 84%|████████▍ | 337/400 [14:58:53<2:47:44, 159.75s/it] 84%|████████▍ | 338/400 [15:01:38<2:46:50, 161.46s/it] 85%|████████▍ | 339/400 [15:04:14<2:42:12, 159.55s/it] 85%|████████▌ | 340/400 [15:06:56<2:40:22, 160.38s/it] 85%|████████▌ | 341/400 [15:09:37<2:37:48, 160.49s/it] 86%|████████▌ | 342/400 [15:12:18<2:35:19, 160.67s/it] 86%|████████▌ | 343/400 [15:14:58<2:32:40, 160.71s/it] 86%|████████▌ | 344/400 [15:17:43<2:30:55, 161.71s/it] 86%|████████▋ | 345/400 [15:20:26<2:28:46, 162.30s/it] 86%|████████▋ | 346/400 [15:23:08<2:25:54, 162.11s/it] 87%|████████▋ | 347/400 [15:25:54<2:24:18, 163.37s/it] 87%|████████▋ | 348/400 [15:28:34<2:20:37, 162.25s/it] 87%|████████▋ | 349/400 [15:31:22<2:19:27, 164.07s/it] 88%|████████▊ | 350/400 [15:34:01<2:15:23, 162.47s/it] 88%|████████▊ | 351/400 [15:36:34<2:10:21, 159.63s/it] 88%|████████▊ | 352/400 [15:39:13<2:07:34, 159.47s/it] 88%|████████▊ | 353/400 [15:41:52<2:04:53, 159.43s/it] 88%|████████▊ | 354/400 [15:44:33<2:02:32, 159.84s/it] 89%|████████▉ | 355/400 [15:47:12<1:59:41, 159.60s/it] 89%|████████▉ | 356/400 [15:49:52<1:57:10, 159.79s/it] 89%|████████▉ | 357/400 [15:52:37<1:55:28, 161.13s/it] 90%|████████▉ | 358/400 [15:55:20<1:53:11, 161.70s/it] 90%|████████▉ | 359/400 [15:57:56<1:49:25, 160.13s/it] 90%|█████████ | 360/400 [16:00:37<1:46:59, 160.49s/it] 90%|█████████ | 361/400 [16:03:17<1:44:05, 160.15s/it] 90%|█████████ | 362/400 [16:05:58<1:41:31, 160.31s/it] 91%|█████████ | 363/400 [16:08:34<1:38:12, 159.25s/it] 91%|█████████ | 364/400 [16:11:15<1:35:44, 159.57s/it] 91%|█████████▏| 365/400 [16:13:56<1:33:21, 160.05s/it] 92%|█████████▏| 366/400 [16:16:32<1:30:07, 159.03s/it] 92%|█████████▏| 367/400 [16:19:12<1:27:29, 159.07s/it] 92%|█████████▏| 368/400 [16:21:51<1:24:57, 159.31s/it] 92%|█████████▏| 369/400 [16:24:34<1:22:48, 160.26s/it] 92%|█████████▎| 370/400 [16:27:22<1:21:17, 162.60s/it] 93%|█████████▎| 371/400 [16:30:00<1:17:58, 161.31s/it] 93%|█████████▎| 372/400 [16:32:42<1:15:17, 161.34s/it] 93%|█████████▎| 373/400 [16:35:24<1:12:40, 161.48s/it] 94%|█████████▎| 374/400 [16:38:06<1:10:02, 161.63s/it] 94%|█████████▍| 375/400 [16:40:38<1:06:08, 158.75s/it] 94%|█████████▍| 376/400 [16:43:18<1:03:40, 159.20s/it] 94%|█████████▍| 377/400 [16:45:58<1:01:06, 159.41s/it] 94%|█████████▍| 378/400 [16:48:35<58:14, 158.83s/it]   95%|█████████▍| 379/400 [16:51:15<55:44, 159.28s/it] 95%|█████████▌| 380/400 [16:53:59<53:31, 160.58s/it] 95%|█████████▌| 381/400 [16:56:43<51:09, 161.55s/it] 96%|█████████▌| 382/400 [16:59:20<48:03, 160.21s/it] 96%|█████████▌| 383/400 [17:01:54<44:53, 158.47s/it] 96%|█████████▌| 384/400 [17:04:39<42:42, 160.17s/it] 96%|█████████▋| 385/400 [17:07:22<40:17, 161.19s/it] 96%|█████████▋| 386/400 [17:09:58<37:14, 159.60s/it] 97%|█████████▋| 387/400 [17:12:31<34:06, 157.46s/it] 97%|█████████▋| 388/400 [17:15:13<31:48, 159.08s/it] 97%|█████████▋| 389/400 [17:17:52<29:07, 158.88s/it] 98%|█████████▊| 390/400 [17:20:34<26:39, 159.96s/it] 98%|█████████▊| 391/400 [17:23:11<23:51, 159.06s/it] 98%|█████████▊| 392/400 [17:25:50<21:12, 159.01s/it] 98%|█████████▊| 393/400 [17:28:31<18:37, 159.69s/it] 98%|█████████▊| 394/400 [17:31:20<16:13, 162.33s/it] 99%|█████████▉| 395/400 [17:33:59<13:26, 161.34s/it] 99%|█████████▉| 396/400 [17:36:43<10:48, 162.03s/it] 99%|█████████▉| 397/400 [17:39:18<08:00, 160.08s/it]100%|█████████▉| 398/400 [17:41:55<05:18, 159.09s/it]100%|█████████▉| 399/400 [17:44:33<02:38, 158.83s/it]100%|██████████| 400/400 [17:47:15<00:00, 159.70s/it]                                                     100%|██████████| 400/400 [17:47:26<00:00, 159.70s/it]100%|██████████| 400/400 [17:47:26<00:00, 160.12s/it]
END of SLURM commands
