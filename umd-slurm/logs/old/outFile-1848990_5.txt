python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt_350m" --epoch=12 --sft_epoch=5 --dataset="hh_poisoned" --per=0.05
------
{'loss': 0.6891, 'learning_rate': 4.959601835692587e-05, 'epoch': 0.1}
{'loss': 0.7061, 'learning_rate': 4.9192036713851725e-05, 'epoch': 0.19}
{'loss': 0.7028, 'learning_rate': 4.878805507077759e-05, 'epoch': 0.29}
{'loss': 0.7008, 'learning_rate': 4.838407342770345e-05, 'epoch': 0.39}
{'loss': 0.6985, 'learning_rate': 4.798009178462931e-05, 'epoch': 0.48}
{'loss': 0.6982, 'learning_rate': 4.757611014155517e-05, 'epoch': 0.58}
{'loss': 0.696, 'learning_rate': 4.7172128498481036e-05, 'epoch': 0.68}
{'loss': 0.6975, 'learning_rate': 4.6768146855406894e-05, 'epoch': 0.78}
{'loss': 0.6979, 'learning_rate': 4.636416521233275e-05, 'epoch': 0.87}
{'loss': 0.6962, 'learning_rate': 4.596018356925861e-05, 'epoch': 0.97}
{'loss': 0.697, 'learning_rate': 4.5556201926184475e-05, 'epoch': 1.07}
{'loss': 0.6961, 'learning_rate': 4.515222028311033e-05, 'epoch': 1.16}
{'loss': 0.6944, 'learning_rate': 4.47482386400362e-05, 'epoch': 1.26}
{'loss': 0.6962, 'learning_rate': 4.4344256996962056e-05, 'epoch': 1.36}
{'loss': 0.6982, 'learning_rate': 4.394027535388792e-05, 'epoch': 1.45}
{'loss': 0.6956, 'learning_rate': 4.353629371081378e-05, 'epoch': 1.55}
{'loss': 0.6946, 'learning_rate': 4.3132312067739644e-05, 'epoch': 1.65}
{'loss': 0.6964, 'learning_rate': 4.27283304246655e-05, 'epoch': 1.75}
{'loss': 0.6948, 'learning_rate': 4.232434878159137e-05, 'epoch': 1.84}
{'loss': 0.6936, 'learning_rate': 4.192036713851723e-05, 'epoch': 1.94}
{'loss': 0.6939, 'learning_rate': 4.151638549544309e-05, 'epoch': 2.04}
{'loss': 0.6962, 'learning_rate': 4.1112403852368954e-05, 'epoch': 2.13}
{'loss': 0.6945, 'learning_rate': 4.070842220929481e-05, 'epoch': 2.23}
{'loss': 0.6941, 'learning_rate': 4.030444056622068e-05, 'epoch': 2.33}
{'loss': 0.6946, 'learning_rate': 3.9900458923146535e-05, 'epoch': 2.42}
{'loss': 0.6949, 'learning_rate': 3.94964772800724e-05, 'epoch': 2.52}
{'loss': 0.6948, 'learning_rate': 3.909249563699826e-05, 'epoch': 2.62}
{'loss': 0.6969, 'learning_rate': 3.8688513993924116e-05, 'epoch': 2.71}
{'loss': 0.6952, 'learning_rate': 3.8284532350849974e-05, 'epoch': 2.81}
{'loss': 0.6946, 'learning_rate': 3.788055070777584e-05, 'epoch': 2.91}
{'loss': 0.6941, 'learning_rate': 3.74765690647017e-05, 'epoch': 3.01}
{'loss': 0.6929, 'learning_rate': 3.707258742162756e-05, 'epoch': 3.1}
{'loss': 0.6957, 'learning_rate': 3.666860577855342e-05, 'epoch': 3.2}
{'loss': 0.6945, 'learning_rate': 3.6264624135479285e-05, 'epoch': 3.3}
{'loss': 0.6945, 'learning_rate': 3.586064249240514e-05, 'epoch': 3.39}
{'loss': 0.694, 'learning_rate': 3.545666084933101e-05, 'epoch': 3.49}
{'loss': 0.6946, 'learning_rate': 3.505267920625687e-05, 'epoch': 3.59}
{'loss': 0.6939, 'learning_rate': 3.464869756318273e-05, 'epoch': 3.68}
{'loss': 0.6939, 'learning_rate': 3.4244715920108596e-05, 'epoch': 3.78}
{'loss': 0.6947, 'learning_rate': 3.3840734277034454e-05, 'epoch': 3.88}
{'loss': 0.6939, 'learning_rate': 3.343675263396032e-05, 'epoch': 3.98}
{'loss': 0.6947, 'learning_rate': 3.303277099088618e-05, 'epoch': 4.07}
{'loss': 0.6936, 'learning_rate': 3.262878934781204e-05, 'epoch': 4.17}
{'loss': 0.6933, 'learning_rate': 3.22248077047379e-05, 'epoch': 4.27}
{'loss': 0.693, 'learning_rate': 3.182082606166376e-05, 'epoch': 4.36}
{'loss': 0.6931, 'learning_rate': 3.141684441858962e-05, 'epoch': 4.46}
{'loss': 0.693, 'learning_rate': 3.101286277551548e-05, 'epoch': 4.56}
{'loss': 0.6941, 'learning_rate': 3.060888113244134e-05, 'epoch': 4.65}
{'loss': 0.6943, 'learning_rate': 3.0204899489367207e-05, 'epoch': 4.75}
{'loss': 0.6936, 'learning_rate': 2.9800917846293065e-05, 'epoch': 4.85}
{'loss': 0.6922, 'learning_rate': 2.9396936203218927e-05, 'epoch': 4.94}
{'loss': 0.6921, 'learning_rate': 2.8992954560144785e-05, 'epoch': 5.04}
{'loss': 0.696, 'learning_rate': 2.858897291707065e-05, 'epoch': 5.14}
{'loss': 0.6933, 'learning_rate': 2.8184991273996508e-05, 'epoch': 5.24}
{'loss': 0.6937, 'learning_rate': 2.7781009630922372e-05, 'epoch': 5.33}
{'loss': 0.6944, 'learning_rate': 2.7377027987848237e-05, 'epoch': 5.43}
{'loss': 0.6932, 'learning_rate': 2.6973046344774095e-05, 'epoch': 5.53}
{'loss': 0.6937, 'learning_rate': 2.6569064701699957e-05, 'epoch': 5.62}
{'loss': 0.694, 'learning_rate': 2.6165083058625818e-05, 'epoch': 5.72}
{'loss': 0.6939, 'learning_rate': 2.576110141555168e-05, 'epoch': 5.82}
{'loss': 0.6949, 'learning_rate': 2.5357119772477538e-05, 'epoch': 5.91}
{'loss': 0.6934, 'learning_rate': 2.49531381294034e-05, 'epoch': 6.01}
{'loss': 0.6926, 'learning_rate': 2.454915648632926e-05, 'epoch': 6.11}
{'loss': 0.692, 'learning_rate': 2.4145174843255125e-05, 'epoch': 6.21}
{'loss': 0.6926, 'learning_rate': 2.3741193200180987e-05, 'epoch': 6.3}
{'loss': 0.6913, 'learning_rate': 2.333721155710685e-05, 'epoch': 6.4}
{'loss': 0.6939, 'learning_rate': 2.293322991403271e-05, 'epoch': 6.5}
{'loss': 0.6931, 'learning_rate': 2.2529248270958568e-05, 'epoch': 6.59}
{'loss': 0.6933, 'learning_rate': 2.212526662788443e-05, 'epoch': 6.69}
{'loss': 0.6932, 'learning_rate': 2.172128498481029e-05, 'epoch': 6.79}
{'loss': 0.6919, 'learning_rate': 2.1317303341736152e-05, 'epoch': 6.88}
{'loss': 0.6937, 'learning_rate': 2.0913321698662014e-05, 'epoch': 6.98}
{'loss': 0.6926, 'learning_rate': 2.0509340055587875e-05, 'epoch': 7.08}
{'loss': 0.6891, 'learning_rate': 2.0105358412513737e-05, 'epoch': 7.17}
{'loss': 0.6932, 'learning_rate': 1.9701376769439598e-05, 'epoch': 7.27}
{'loss': 0.692, 'learning_rate': 1.929739512636546e-05, 'epoch': 7.37}
{'loss': 0.6916, 'learning_rate': 1.889341348329132e-05, 'epoch': 7.47}
{'loss': 0.6923, 'learning_rate': 1.848943184021718e-05, 'epoch': 7.56}
{'loss': 0.6919, 'learning_rate': 1.808545019714304e-05, 'epoch': 7.66}
{'loss': 0.6915, 'learning_rate': 1.7681468554068902e-05, 'epoch': 7.76}
{'loss': 0.6926, 'learning_rate': 1.7277486910994763e-05, 'epoch': 7.85}
{'loss': 0.6922, 'learning_rate': 1.6873505267920625e-05, 'epoch': 7.95}
{'loss': 0.692, 'learning_rate': 1.646952362484649e-05, 'epoch': 8.05}
{'loss': 0.6906, 'learning_rate': 1.606554198177235e-05, 'epoch': 8.14}
{'loss': 0.6912, 'learning_rate': 1.5661560338698213e-05, 'epoch': 8.24}
{'loss': 0.6922, 'learning_rate': 1.5257578695624072e-05, 'epoch': 8.34}
{'loss': 0.6908, 'learning_rate': 1.4853597052549934e-05, 'epoch': 8.44}
{'loss': 0.6921, 'learning_rate': 1.4449615409475795e-05, 'epoch': 8.53}
{'loss': 0.6913, 'learning_rate': 1.4045633766401655e-05, 'epoch': 8.63}
{'loss': 0.6941, 'learning_rate': 1.3641652123327517e-05, 'epoch': 8.73}
{'loss': 0.6937, 'learning_rate': 1.3237670480253378e-05, 'epoch': 8.82}
{'loss': 0.6908, 'learning_rate': 1.283368883717924e-05, 'epoch': 8.92}
{'loss': 0.6918, 'learning_rate': 1.2429707194105101e-05, 'epoch': 9.02}
{'loss': 0.6906, 'learning_rate': 1.202572555103096e-05, 'epoch': 9.11}
{'loss': 0.6932, 'learning_rate': 1.1621743907956822e-05, 'epoch': 9.21}
{'loss': 0.693, 'learning_rate': 1.1217762264882685e-05, 'epoch': 9.31}
{'loss': 0.6907, 'learning_rate': 1.0813780621808547e-05, 'epoch': 9.4}
{'loss': 0.693, 'learning_rate': 1.0409798978734407e-05, 'epoch': 9.5}
{'loss': 0.6902, 'learning_rate': 1.0005817335660268e-05, 'epoch': 9.6}
{'loss': 0.6915, 'learning_rate': 9.60183569258613e-06, 'epoch': 9.7}
{'loss': 0.6926, 'learning_rate': 9.197854049511991e-06, 'epoch': 9.79}
{'loss': 0.6908, 'learning_rate': 8.793872406437852e-06, 'epoch': 9.89}
{'loss': 0.6914, 'learning_rate': 8.389890763363712e-06, 'epoch': 9.99}
{'loss': 0.6906, 'learning_rate': 7.985909120289574e-06, 'epoch': 10.08}
{'loss': 0.6925, 'learning_rate': 7.581927477215435e-06, 'epoch': 10.18}
{'loss': 0.6917, 'learning_rate': 7.177945834141297e-06, 'epoch': 10.28}
{'loss': 0.6905, 'learning_rate': 6.773964191067159e-06, 'epoch': 10.37}
{'loss': 0.6906, 'learning_rate': 6.369982547993019e-06, 'epoch': 10.47}
{'loss': 0.6904, 'learning_rate': 5.966000904918881e-06, 'epoch': 10.57}
{'loss': 0.6901, 'learning_rate': 5.562019261844742e-06, 'epoch': 10.67}
{'loss': 0.6897, 'learning_rate': 5.158037618770603e-06, 'epoch': 10.76}
{'loss': 0.6925, 'learning_rate': 4.754055975696465e-06, 'epoch': 10.86}
{'loss': 0.6898, 'learning_rate': 4.350074332622326e-06, 'epoch': 10.96}
{'loss': 0.69, 'learning_rate': 3.946092689548187e-06, 'epoch': 11.05}
{'loss': 0.6905, 'learning_rate': 3.5421110464740483e-06, 'epoch': 11.15}
{'loss': 0.6901, 'learning_rate': 3.1381294033999094e-06, 'epoch': 11.25}
{'loss': 0.6907, 'learning_rate': 2.734147760325771e-06, 'epoch': 11.34}
{'loss': 0.6878, 'learning_rate': 2.3301661172516323e-06, 'epoch': 11.44}
{'loss': 0.6913, 'learning_rate': 1.9261844741774933e-06, 'epoch': 11.54}
{'loss': 0.6883, 'learning_rate': 1.5222028311033548e-06, 'epoch': 11.63}
{'loss': 0.6909, 'learning_rate': 1.118221188029216e-06, 'epoch': 11.73}
{'loss': 0.6912, 'learning_rate': 7.142395449550772e-07, 'epoch': 11.83}
{'loss': 0.6901, 'learning_rate': 3.1025790188093855e-07, 'epoch': 11.93}
{'train_runtime': 74711.8796, 'train_samples_per_second': 6.626, 'train_steps_per_second': 0.828, 'train_loss': 0.6932885080785913, 'epoch': 12.0}
END of SLURM commands
