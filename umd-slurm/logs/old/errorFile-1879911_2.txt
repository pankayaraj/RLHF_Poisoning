python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt-350m" --epoch=10 --sft_epoch=5 --dataset="hh_poisoned" --per=0.01
------
Some weights of OPTForSequenceClassification were not initialized from the model checkpoint at /cmlscratch/pan/RLHF_Poisoning/models/trained_sft/opt-350m_5_hh_poisoned_0.05 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/400 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/400 [02:37<17:30:13, 157.93s/it]  0%|          | 2/400 [05:18<17:36:39, 159.30s/it]  1%|          | 3/400 [07:59<17:40:39, 160.30s/it]  1%|          | 4/400 [10:39<17:36:10, 160.03s/it]  1%|▏         | 5/400 [13:20<17:35:26, 160.32s/it]  2%|▏         | 6/400 [16:06<17:45:41, 162.29s/it]  2%|▏         | 7/400 [18:50<17:48:01, 163.06s/it]  2%|▏         | 8/400 [21:34<17:47:00, 163.32s/it]  2%|▏         | 9/400 [24:14<17:36:21, 162.10s/it]  2%|▎         | 10/400 [26:58<17:37:43, 162.73s/it]  3%|▎         | 11/400 [29:36<17:26:27, 161.41s/it]  3%|▎         | 12/400 [32:09<17:07:39, 158.92s/it]  3%|▎         | 13/400 [34:44<16:57:01, 157.68s/it]  4%|▎         | 14/400 [37:26<17:02:59, 159.01s/it]  4%|▍         | 15/400 [40:09<17:08:13, 160.24s/it]  4%|▍         | 16/400 [42:48<17:03:00, 159.84s/it]  4%|▍         | 17/400 [45:17<16:37:52, 156.33s/it]  4%|▍         | 18/400 [48:03<16:54:07, 159.29s/it]  5%|▍         | 19/400 [50:36<16:40:47, 157.61s/it]  5%|▌         | 20/400 [53:18<16:46:41, 158.95s/it]  5%|▌         | 21/400 [55:58<16:44:55, 159.09s/it]  6%|▌         | 22/400 [58:38<16:45:00, 159.53s/it]  6%|▌         | 23/400 [1:01:24<16:53:08, 161.24s/it]  6%|▌         | 24/400 [1:03:57<16:36:06, 158.95s/it]  6%|▋         | 25/400 [1:06:40<16:41:18, 160.21s/it]  6%|▋         | 26/400 [1:09:21<16:38:56, 160.26s/it]  7%|▋         | 27/400 [1:11:59<16:33:08, 159.76s/it]  7%|▋         | 28/400 [1:14:38<16:29:03, 159.53s/it]  7%|▋         | 29/400 [1:17:25<16:39:40, 161.67s/it]  8%|▊         | 30/400 [1:20:02<16:29:05, 160.39s/it]  8%|▊         | 31/400 [1:22:44<16:28:46, 160.78s/it]  8%|▊         | 32/400 [1:25:26<16:28:35, 161.18s/it]  8%|▊         | 33/400 [1:28:11<16:32:43, 162.30s/it]  8%|▊         | 34/400 [1:30:48<16:19:57, 160.65s/it]  9%|▉         | 35/400 [1:33:32<16:22:34, 161.52s/it]  9%|▉         | 36/400 [1:36:07<16:08:03, 159.57s/it]  9%|▉         | 37/400 [1:38:44<16:01:39, 158.95s/it] 10%|▉         | 38/400 [1:41:24<16:00:50, 159.26s/it] 10%|▉         | 39/400 [1:44:03<15:57:17, 159.11s/it] 10%|█         | 40/400 [1:46:46<16:01:17, 160.22s/it] 10%|█         | 41/400 [1:49:21<15:49:44, 158.73s/it] 10%|█         | 42/400 [1:52:03<15:52:38, 159.66s/it] 11%|█         | 43/400 [1:54:41<15:47:54, 159.31s/it] 11%|█         | 44/400 [1:57:23<15:49:56, 160.10s/it] 11%|█▏        | 45/400 [2:00:03<15:46:14, 159.93s/it] 12%|█▏        | 46/400 [2:02:38<15:35:29, 158.56s/it] 12%|█▏        | 47/400 [2:05:17<15:33:48, 158.72s/it] 12%|█▏        | 48/400 [2:08:03<15:44:02, 160.92s/it] 12%|█▏        | 49/400 [2:10:46<15:45:06, 161.56s/it] 12%|█▎        | 50/400 [2:13:23<15:33:22, 160.01s/it] 13%|█▎        | 51/400 [2:16:05<15:34:26, 160.65s/it] 13%|█▎        | 52/400 [2:18:43<15:27:12, 159.86s/it] 13%|█▎        | 53/400 [2:21:24<15:27:27, 160.37s/it] 14%|█▎        | 54/400 [2:24:07<15:28:51, 161.07s/it] 14%|█▍        | 55/400 [2:26:45<15:21:28, 160.26s/it] 14%|█▍        | 56/400 [2:29:30<15:27:05, 161.70s/it] 14%|█▍        | 57/400 [2:32:14<15:26:52, 162.14s/it] 14%|█▍        | 58/400 [2:35:00<15:32:18, 163.56s/it] 15%|█▍        | 59/400 [2:37:34<15:12:45, 160.60s/it] 15%|█▌        | 60/400 [2:40:17<15:14:21, 161.36s/it] 15%|█▌        | 61/400 [2:42:56<15:07:05, 160.55s/it] 16%|█▌        | 62/400 [2:45:36<15:02:41, 160.24s/it] 16%|█▌        | 63/400 [2:48:15<14:58:43, 160.01s/it] 16%|█▌        | 64/400 [2:51:03<15:08:54, 162.30s/it] 16%|█▋        | 65/400 [2:53:40<14:58:07, 160.86s/it] 16%|█▋        | 66/400 [2:56:24<14:59:43, 161.63s/it] 17%|█▋        | 67/400 [2:59:01<14:50:16, 160.41s/it] 17%|█▋        | 68/400 [3:01:37<14:39:51, 159.01s/it] 17%|█▋        | 69/400 [3:04:24<14:51:15, 161.56s/it] 18%|█▊        | 70/400 [3:07:05<14:46:17, 161.14s/it] 18%|█▊        | 71/400 [3:09:45<14:43:04, 161.05s/it] 18%|█▊        | 72/400 [3:12:31<14:47:58, 162.43s/it] 18%|█▊        | 73/400 [3:15:06<14:32:51, 160.16s/it] 18%|█▊        | 74/400 [3:17:52<14:39:58, 161.96s/it] 19%|█▉        | 75/400 [3:20:35<14:38:48, 162.24s/it] 19%|█▉        | 76/400 [3:23:14<14:31:40, 161.42s/it] 19%|█▉        | 77/400 [3:25:53<14:24:51, 160.66s/it] 20%|█▉        | 78/400 [3:28:24<14:06:56, 157.82s/it] 20%|█▉        | 79/400 [3:31:09<14:14:22, 159.70s/it] 20%|██        | 80/400 [3:33:52<14:17:39, 160.81s/it] 20%|██        | 81/400 [3:36:20<13:55:20, 157.12s/it] 20%|██        | 82/400 [3:39:00<13:57:06, 157.94s/it] 21%|██        | 83/400 [3:41:40<13:56:54, 158.41s/it] 21%|██        | 84/400 [3:44:18<13:54:08, 158.38s/it] 21%|██▏       | 85/400 [3:47:05<14:04:09, 160.79s/it] 22%|██▏       | 86/400 [3:49:45<14:00:47, 160.66s/it] 22%|██▏       | 87/400 [3:52:25<13:57:09, 160.48s/it] 22%|██▏       | 88/400 [3:54:58<13:43:16, 158.32s/it] 22%|██▏       | 89/400 [3:57:37<13:41:49, 158.55s/it] 22%|██▎       | 90/400 [4:00:17<13:40:45, 158.86s/it] 23%|██▎       | 91/400 [4:02:50<13:29:04, 157.10s/it] 23%|██▎       | 92/400 [4:05:38<13:43:04, 160.34s/it] 23%|██▎       | 93/400 [4:08:19<13:41:48, 160.61s/it] 24%|██▎       | 94/400 [4:11:02<13:42:54, 161.35s/it] 24%|██▍       | 95/400 [4:13:37<13:30:37, 159.47s/it] 24%|██▍       | 96/400 [4:16:17<13:28:11, 159.51s/it] 24%|██▍       | 97/400 [4:18:55<13:23:35, 159.13s/it] 24%|██▍       | 98/400 [4:21:33<13:18:44, 158.69s/it] 25%|██▍       | 99/400 [4:24:12<13:17:10, 158.90s/it] 25%|██▌       | 100/400 [4:26:54<13:18:24, 159.68s/it]/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 25%|██▌       | 101/400 [4:29:31<13:12:21, 159.00s/it] 26%|██▌       | 102/400 [4:32:16<13:18:25, 160.76s/it] 26%|██▌       | 103/400 [4:34:56<13:14:29, 160.50s/it] 26%|██▌       | 104/400 [4:37:35<13:10:30, 160.24s/it] 26%|██▋       | 105/400 [4:40:14<13:05:51, 159.84s/it] 26%|██▋       | 106/400 [4:42:55<13:03:42, 159.94s/it] 27%|██▋       | 107/400 [4:45:37<13:04:42, 160.69s/it] 27%|██▋       | 108/400 [4:48:18<13:02:43, 160.83s/it] 27%|██▋       | 109/400 [4:50:58<12:58:27, 160.51s/it] 28%|██▊       | 110/400 [4:53:29<12:42:19, 157.72s/it] 28%|██▊       | 111/400 [4:56:08<12:41:11, 158.03s/it] 28%|██▊       | 112/400 [4:58:54<12:49:59, 160.42s/it] 28%|██▊       | 113/400 [5:01:33<12:45:15, 159.99s/it] 28%|██▊       | 114/400 [5:04:21<12:54:15, 162.43s/it] 29%|██▉       | 115/400 [5:06:57<12:41:45, 160.37s/it] 29%|██▉       | 116/400 [5:09:38<12:40:58, 160.77s/it] 29%|██▉       | 117/400 [5:12:17<12:35:49, 160.24s/it] 30%|██▉       | 118/400 [5:14:52<12:25:18, 158.58s/it] 30%|██▉       | 119/400 [5:17:31<12:23:38, 158.78s/it] 30%|███       | 120/400 [5:20:18<12:32:34, 161.27s/it] 30%|███       | 121/400 [5:23:00<12:31:03, 161.52s/it] 30%|███       | 122/400 [5:25:48<12:36:21, 163.24s/it] 31%|███       | 123/400 [5:28:32<12:35:08, 163.57s/it] 31%|███       | 124/400 [5:31:14<12:30:36, 163.18s/it] 31%|███▏      | 125/400 [5:33:55<12:24:19, 162.40s/it] 32%|███▏      | 126/400 [5:36:34<12:17:11, 161.43s/it] 32%|███▏      | 127/400 [5:39:09<12:05:10, 159.38s/it] 32%|███▏      | 128/400 [5:41:53<12:08:45, 160.75s/it] 32%|███▏      | 129/400 [5:44:34<12:07:02, 160.97s/it] 32%|███▎      | 130/400 [5:47:13<12:01:38, 160.36s/it] 33%|███▎      | 131/400 [5:49:56<12:02:31, 161.16s/it] 33%|███▎      | 132/400 [5:52:37<11:59:25, 161.06s/it] 33%|███▎      | 133/400 [5:55:23<12:02:56, 162.46s/it] 34%|███▎      | 134/400 [5:58:10<12:07:07, 164.01s/it] 34%|███▍      | 135/400 [6:00:53<12:02:12, 163.52s/it] 34%|███▍      | 136/400 [6:03:35<11:58:22, 163.27s/it] 34%|███▍      | 137/400 [6:06:17<11:54:12, 162.94s/it] 34%|███▍      | 138/400 [6:08:57<11:47:44, 162.08s/it] 35%|███▍      | 139/400 [6:11:44<11:50:32, 163.34s/it] 35%|███▌      | 140/400 [6:14:26<11:45:56, 162.91s/it] 35%|███▌      | 141/400 [6:17:07<11:41:32, 162.52s/it] 36%|███▌      | 142/400 [6:19:48<11:36:54, 162.07s/it] 36%|███▌      | 143/400 [6:22:31<11:34:47, 162.21s/it] 36%|███▌      | 144/400 [6:25:08<11:26:07, 160.81s/it] 36%|███▋      | 145/400 [6:27:47<11:20:18, 160.07s/it] 36%|███▋      | 146/400 [6:30:31<11:22:52, 161.31s/it] 37%|███▋      | 147/400 [6:33:10<11:17:50, 160.75s/it] 37%|███▋      | 148/400 [6:35:56<11:21:12, 162.19s/it] 37%|███▋      | 149/400 [6:38:35<11:15:06, 161.38s/it] 38%|███▊      | 150/400 [6:41:16<11:11:14, 161.10s/it] 38%|███▊      | 151/400 [6:43:58<11:09:20, 161.29s/it] 38%|███▊      | 152/400 [6:46:37<11:04:38, 160.80s/it] 38%|███▊      | 153/400 [6:49:18<11:02:29, 160.93s/it] 38%|███▊      | 154/400 [6:51:55<10:54:04, 159.53s/it] 39%|███▉      | 155/400 [6:54:37<10:54:36, 160.31s/it] 39%|███▉      | 156/400 [6:57:13<10:46:54, 159.08s/it] 39%|███▉      | 157/400 [6:59:51<10:43:29, 158.89s/it] 40%|███▉      | 158/400 [7:02:35<10:46:25, 160.27s/it] 40%|███▉      | 159/400 [7:05:15<10:43:58, 160.33s/it] 40%|████      | 160/400 [7:07:53<10:37:25, 159.36s/it] 40%|████      | 161/400 [7:10:28<10:29:53, 158.13s/it] 40%|████      | 162/400 [7:13:10<10:32:04, 159.35s/it] 41%|████      | 163/400 [7:15:59<10:41:15, 162.34s/it] 41%|████      | 164/400 [7:18:35<10:31:14, 160.49s/it] 41%|████▏     | 165/400 [7:21:17<10:29:56, 160.84s/it] 42%|████▏     | 166/400 [7:23:52<10:20:47, 159.18s/it] 42%|████▏     | 167/400 [7:26:35<10:21:56, 160.16s/it] 42%|████▏     | 168/400 [7:29:16<10:20:48, 160.56s/it] 42%|████▏     | 169/400 [7:31:59<10:20:29, 161.17s/it] 42%|████▎     | 170/400 [7:34:40<10:17:40, 161.13s/it] 43%|████▎     | 171/400 [7:37:20<10:13:24, 160.72s/it] 43%|████▎     | 172/400 [7:40:01<10:10:50, 160.75s/it] 43%|████▎     | 173/400 [7:42:42<10:08:55, 160.95s/it] 44%|████▎     | 174/400 [7:45:28<10:12:17, 162.56s/it] 44%|████▍     | 175/400 [7:48:10<10:08:45, 162.34s/it] 44%|████▍     | 176/400 [7:50:48<10:01:30, 161.12s/it] 44%|████▍     | 177/400 [7:53:28<9:57:35, 160.79s/it]  44%|████▍     | 178/400 [7:56:11<9:56:45, 161.29s/it] 45%|████▍     | 179/400 [7:58:49<9:50:47, 160.40s/it] 45%|████▌     | 180/400 [8:01:26<9:43:39, 159.18s/it] 45%|████▌     | 181/400 [8:04:05<9:41:30, 159.32s/it] 46%|████▌     | 182/400 [8:06:43<9:37:09, 158.85s/it] 46%|████▌     | 183/400 [8:09:27<9:40:13, 160.43s/it] 46%|████▌     | 184/400 [8:12:11<9:41:51, 161.63s/it] 46%|████▋     | 185/400 [8:14:51<9:37:23, 161.13s/it] 46%|████▋     | 186/400 [8:17:35<9:36:59, 161.77s/it] 47%|████▋     | 187/400 [8:20:15<9:32:27, 161.25s/it] 47%|████▋     | 188/400 [8:23:00<9:34:11, 162.51s/it] 47%|████▋     | 189/400 [8:25:39<9:27:21, 161.33s/it] 48%|████▊     | 190/400 [8:28:19<9:23:05, 160.88s/it] 48%|████▊     | 191/400 [8:30:58<9:19:11, 160.53s/it] 48%|████▊     | 192/400 [8:33:33<9:10:53, 158.91s/it] 48%|████▊     | 193/400 [8:36:14<9:09:32, 159.29s/it] 48%|████▊     | 194/400 [8:38:54<9:07:55, 159.59s/it] 49%|████▉     | 195/400 [8:41:40<9:12:14, 161.63s/it] 49%|████▉     | 196/400 [8:44:18<9:05:49, 160.54s/it] 49%|████▉     | 197/400 [8:46:57<9:00:50, 159.86s/it] 50%|████▉     | 198/400 [8:49:45<9:06:44, 162.40s/it] 50%|████▉     | 199/400 [8:52:30<9:07:00, 163.29s/it] 50%|█████     | 200/400 [8:55:15<9:06:14, 163.87s/it]/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 50%|█████     | 201/400 [8:58:09<9:12:58, 166.73s/it] 50%|█████     | 202/400 [9:00:47<9:02:04, 164.27s/it] 51%|█████     | 203/400 [9:03:28<8:55:38, 163.14s/it] 51%|█████     | 204/400 [9:06:12<8:53:51, 163.43s/it] 51%|█████▏    | 205/400 [9:08:53<8:49:02, 162.78s/it] 52%|█████▏    | 206/400 [9:11:30<8:40:12, 160.89s/it] 52%|█████▏    | 207/400 [9:14:15<8:41:41, 162.19s/it] 52%|█████▏    | 208/400 [9:16:55<8:36:45, 161.49s/it] 52%|█████▏    | 209/400 [9:19:37<8:35:07, 161.82s/it] 52%|█████▎    | 210/400 [9:22:19<8:32:00, 161.69s/it] 53%|█████▎    | 211/400 [9:25:07<8:35:20, 163.60s/it] 53%|█████▎    | 212/400 [9:27:42<8:24:19, 160.95s/it] 53%|█████▎    | 213/400 [9:30:13<8:13:07, 158.22s/it] 54%|█████▎    | 214/400 [9:32:57<8:15:04, 159.70s/it] 54%|█████▍    | 215/400 [9:35:32<8:08:32, 158.45s/it] 54%|█████▍    | 216/400 [9:38:17<8:11:28, 160.26s/it] 54%|█████▍    | 217/400 [9:40:49<8:01:35, 157.90s/it] 55%|█████▍    | 218/400 [9:43:35<8:06:06, 160.25s/it] 55%|█████▍    | 219/400 [9:46:11<8:00:02, 159.13s/it] 55%|█████▌    | 220/400 [9:48:50<7:57:19, 159.11s/it] 55%|█████▌    | 221/400 [9:51:39<8:03:04, 161.92s/it] 56%|█████▌    | 222/400 [9:54:18<7:57:59, 161.12s/it] 56%|█████▌    | 223/400 [9:57:01<7:56:32, 161.54s/it] 56%|█████▌    | 224/400 [9:59:38<7:49:46, 160.15s/it] 56%|█████▋    | 225/400 [10:02:16<7:45:13, 159.50s/it] 56%|█████▋    | 226/400 [10:04:59<7:45:39, 160.57s/it] 57%|█████▋    | 227/400 [10:07:45<7:47:47, 162.24s/it] 57%|█████▋    | 228/400 [10:10:28<7:45:57, 162.54s/it] 57%|█████▋    | 229/400 [10:13:02<7:36:18, 160.11s/it] 57%|█████▊    | 230/400 [10:15:44<7:34:50, 160.53s/it] 58%|█████▊    | 231/400 [10:18:17<7:25:52, 158.30s/it] 58%|█████▊    | 232/400 [10:21:03<7:29:52, 160.67s/it] 58%|█████▊    | 233/400 [10:23:47<7:29:45, 161.59s/it] 58%|█████▊    | 234/400 [10:26:28<7:26:20, 161.33s/it] 59%|█████▉    | 235/400 [10:29:08<7:23:14, 161.18s/it] 59%|█████▉    | 236/400 [10:31:51<7:21:17, 161.45s/it] 59%|█████▉    | 237/400 [10:34:35<7:21:18, 162.45s/it] 60%|█████▉    | 238/400 [10:37:14<7:15:18, 161.23s/it] 60%|█████▉    | 239/400 [10:39:51<7:09:48, 160.18s/it] 60%|██████    | 240/400 [10:42:31<7:06:18, 159.86s/it] 60%|██████    | 241/400 [10:45:13<7:05:50, 160.70s/it] 60%|██████    | 242/400 [10:47:55<7:03:49, 160.94s/it] 61%|██████    | 243/400 [10:50:36<7:01:07, 160.94s/it] 61%|██████    | 244/400 [10:53:17<6:58:25, 160.94s/it] 61%|██████▏   | 245/400 [10:55:51<6:50:18, 158.83s/it] 62%|██████▏   | 246/400 [10:58:25<6:44:37, 157.64s/it] 62%|██████▏   | 247/400 [11:01:09<6:46:43, 159.50s/it] 62%|██████▏   | 248/400 [11:03:53<6:47:22, 160.80s/it] 62%|██████▏   | 249/400 [11:06:41<6:49:52, 162.87s/it] 62%|██████▎   | 250/400 [11:09:17<6:42:33, 161.03s/it] 63%|██████▎   | 251/400 [11:11:55<6:37:30, 160.07s/it] 63%|██████▎   | 252/400 [11:14:42<6:39:53, 162.12s/it] 63%|██████▎   | 253/400 [11:17:26<6:38:08, 162.50s/it] 64%|██████▎   | 254/400 [11:20:03<6:31:56, 161.07s/it] 64%|██████▍   | 255/400 [11:22:43<6:28:04, 160.58s/it] 64%|██████▍   | 256/400 [11:25:26<6:27:19, 161.38s/it] 64%|██████▍   | 257/400 [11:28:08<6:25:21, 161.69s/it] 64%|██████▍   | 258/400 [11:30:48<6:21:15, 161.09s/it] 65%|██████▍   | 259/400 [11:33:24<6:15:05, 159.61s/it] 65%|██████▌   | 260/400 [11:36:03<6:12:03, 159.46s/it] 65%|██████▌   | 261/400 [11:38:45<6:10:59, 160.14s/it] 66%|██████▌   | 262/400 [11:41:25<6:08:20, 160.15s/it] 66%|██████▌   | 263/400 [11:44:17<6:13:18, 163.49s/it] 66%|██████▌   | 264/400 [11:47:01<6:10:57, 163.66s/it] 66%|██████▋   | 265/400 [11:49:32<5:59:55, 159.97s/it] 66%|██████▋   | 266/400 [11:52:23<6:04:23, 163.16s/it] 67%|██████▋   | 267/400 [11:55:03<6:00:02, 162.43s/it] 67%|██████▋   | 268/400 [11:57:41<5:54:19, 161.06s/it] 67%|██████▋   | 269/400 [12:00:20<5:50:26, 160.51s/it] 68%|██████▊   | 270/400 [12:03:04<5:49:39, 161.38s/it] 68%|██████▊   | 271/400 [12:05:43<5:45:30, 160.70s/it] 68%|██████▊   | 272/400 [12:08:17<5:38:40, 158.75s/it] 68%|██████▊   | 273/400 [12:10:58<5:37:22, 159.39s/it] 68%|██████▊   | 274/400 [12:13:38<5:34:58, 159.51s/it] 69%|██████▉   | 275/400 [12:16:22<5:35:05, 160.85s/it] 69%|██████▉   | 276/400 [12:19:00<5:30:56, 160.13s/it] 69%|██████▉   | 277/400 [12:21:41<5:28:21, 160.18s/it] 70%|██████▉   | 278/400 [12:24:21<5:25:37, 160.14s/it] 70%|██████▉   | 279/400 [12:27:02<5:23:52, 160.60s/it] 70%|███████   | 280/400 [12:29:44<5:21:42, 160.85s/it] 70%|███████   | 281/400 [12:32:13<5:12:09, 157.39s/it] 70%|███████   | 282/400 [12:34:59<5:14:24, 159.87s/it] 71%|███████   | 283/400 [12:37:35<5:09:31, 158.73s/it] 71%|███████   | 284/400 [12:40:13<5:06:38, 158.61s/it] 71%|███████▏  | 285/400 [12:42:52<5:04:10, 158.70s/it] 72%|███████▏  | 286/400 [12:45:33<5:03:00, 159.47s/it] 72%|███████▏  | 287/400 [12:48:17<5:02:34, 160.66s/it] 72%|███████▏  | 288/400 [12:50:55<4:58:44, 160.04s/it] 72%|███████▏  | 289/400 [12:53:33<4:54:43, 159.31s/it] 72%|███████▎  | 290/400 [12:56:13<4:52:16, 159.43s/it] 73%|███████▎  | 291/400 [12:58:50<4:48:34, 158.85s/it] 73%|███████▎  | 292/400 [13:01:25<4:43:46, 157.65s/it] 73%|███████▎  | 293/400 [13:04:03<4:41:15, 157.71s/it] 74%|███████▎  | 294/400 [13:06:46<4:41:23, 159.28s/it] 74%|███████▍  | 295/400 [13:09:36<4:44:18, 162.46s/it] 74%|███████▍  | 296/400 [13:12:20<4:42:36, 163.05s/it] 74%|███████▍  | 297/400 [13:15:04<4:40:34, 163.44s/it] 74%|███████▍  | 298/400 [13:17:46<4:37:09, 163.03s/it] 75%|███████▍  | 299/400 [13:20:31<4:35:06, 163.43s/it] 75%|███████▌  | 300/400 [13:23:13<4:31:32, 162.92s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.01/checkpoint-300 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 75%|███████▌  | 301/400 [13:26:00<4:31:10, 164.35s/it] 76%|███████▌  | 302/400 [13:28:36<4:24:21, 161.86s/it] 76%|███████▌  | 303/400 [13:31:14<4:19:28, 160.50s/it] 76%|███████▌  | 304/400 [13:33:53<4:16:10, 160.11s/it] 76%|███████▋  | 305/400 [13:36:38<4:15:46, 161.54s/it] 76%|███████▋  | 306/400 [13:39:13<4:10:17, 159.76s/it] 77%|███████▋  | 307/400 [13:41:51<4:06:45, 159.19s/it] 77%|███████▋  | 308/400 [13:44:32<4:05:02, 159.81s/it] 77%|███████▋  | 309/400 [13:47:16<4:04:05, 160.94s/it] 78%|███████▊  | 310/400 [13:49:57<4:01:33, 161.04s/it] 78%|███████▊  | 311/400 [13:52:37<3:58:20, 160.68s/it] 78%|███████▊  | 312/400 [13:55:14<3:54:10, 159.67s/it] 78%|███████▊  | 313/400 [13:57:56<3:52:25, 160.29s/it] 78%|███████▊  | 314/400 [14:00:45<3:53:22, 162.82s/it] 79%|███████▉  | 315/400 [14:03:27<3:50:17, 162.56s/it] 79%|███████▉  | 316/400 [14:05:56<3:42:03, 158.61s/it] 79%|███████▉  | 317/400 [14:08:33<3:38:43, 158.12s/it] 80%|███████▉  | 318/400 [14:11:11<3:35:57, 158.02s/it] 80%|███████▉  | 319/400 [14:13:44<3:31:24, 156.60s/it] 80%|████████  | 320/400 [14:16:24<3:30:14, 157.68s/it] 80%|████████  | 321/400 [14:19:04<3:28:15, 158.17s/it] 80%|████████  | 322/400 [14:21:49<3:28:26, 160.34s/it] 81%|████████  | 323/400 [14:24:21<3:22:35, 157.86s/it] 81%|████████  | 324/400 [14:27:03<3:21:29, 159.07s/it] 81%|████████▏ | 325/400 [14:29:44<3:19:26, 159.55s/it] 82%|████████▏ | 326/400 [14:32:17<3:14:18, 157.55s/it] 82%|████████▏ | 327/400 [14:34:50<3:10:03, 156.21s/it] 82%|████████▏ | 328/400 [14:37:25<3:07:07, 155.93s/it] 82%|████████▏ | 329/400 [14:40:02<3:04:46, 156.15s/it] 82%|████████▎ | 330/400 [14:42:47<3:05:13, 158.77s/it] 83%|████████▎ | 331/400 [14:45:24<3:02:01, 158.28s/it] 83%|████████▎ | 332/400 [14:48:05<3:00:31, 159.29s/it] 83%|████████▎ | 333/400 [14:50:42<2:56:58, 158.49s/it] 84%|████████▎ | 334/400 [14:53:24<2:55:29, 159.54s/it] 84%|████████▍ | 335/400 [14:56:08<2:54:07, 160.73s/it] 84%|████████▍ | 336/400 [14:58:51<2:52:12, 161.45s/it] 84%|████████▍ | 337/400 [15:01:28<2:48:11, 160.18s/it] 84%|████████▍ | 338/400 [15:04:14<2:47:17, 161.90s/it] 85%|████████▍ | 339/400 [15:06:49<2:42:41, 160.02s/it] 85%|████████▌ | 340/400 [15:09:32<2:40:51, 160.86s/it] 85%|████████▌ | 341/400 [15:12:14<2:38:19, 161.01s/it] 86%|████████▌ | 342/400 [15:14:55<2:35:53, 161.27s/it] 86%|████████▌ | 343/400 [15:17:37<2:33:12, 161.27s/it] 86%|████████▌ | 344/400 [15:20:21<2:31:28, 162.30s/it] 86%|████████▋ | 345/400 [15:23:06<2:29:23, 162.96s/it] 86%|████████▋ | 346/400 [15:25:48<2:26:27, 162.74s/it] 87%|████████▋ | 347/400 [15:28:35<2:24:48, 163.94s/it] 87%|████████▋ | 348/400 [15:31:15<2:21:08, 162.86s/it] 87%|████████▋ | 349/400 [15:34:04<2:19:58, 164.68s/it] 88%|████████▊ | 350/400 [15:36:43<2:15:53, 163.07s/it] 88%|████████▊ | 351/400 [15:39:17<2:10:50, 160.21s/it] 88%|████████▊ | 352/400 [15:41:57<2:08:02, 160.05s/it] 88%|████████▊ | 353/400 [15:44:36<2:05:18, 159.96s/it] 88%|████████▊ | 354/400 [15:47:18<2:02:56, 160.35s/it] 89%|████████▉ | 355/400 [15:49:57<2:00:05, 160.11s/it] 89%|████████▉ | 356/400 [15:52:38<1:57:33, 160.32s/it] 89%|████████▉ | 357/400 [15:55:23<1:55:51, 161.67s/it] 90%|████████▉ | 358/400 [15:58:06<1:53:34, 162.24s/it] 90%|████████▉ | 359/400 [16:00:44<1:49:49, 160.73s/it] 90%|█████████ | 360/400 [16:03:26<1:47:24, 161.11s/it] 90%|█████████ | 361/400 [16:06:06<1:44:29, 160.77s/it] 90%|█████████ | 362/400 [16:08:47<1:41:56, 160.95s/it] 91%|█████████ | 363/400 [16:11:24<1:38:36, 159.90s/it] 91%|█████████ | 364/400 [16:14:05<1:36:06, 160.18s/it] 91%|█████████▏| 365/400 [16:16:47<1:33:42, 160.65s/it] 92%|█████████▏| 366/400 [16:19:24<1:30:27, 159.63s/it] 92%|█████████▏| 367/400 [16:22:04<1:27:47, 159.63s/it] 92%|█████████▏| 368/400 [16:24:44<1:25:15, 159.85s/it] 92%|█████████▏| 369/400 [16:27:27<1:23:05, 160.81s/it] 92%|█████████▎| 370/400 [16:30:16<1:21:33, 163.12s/it] 93%|█████████▎| 371/400 [16:32:55<1:18:13, 161.83s/it] 93%|█████████▎| 372/400 [16:35:36<1:15:31, 161.82s/it] 93%|█████████▎| 373/400 [16:38:19<1:12:53, 161.98s/it] 94%|█████████▎| 374/400 [16:41:01<1:10:15, 162.13s/it] 94%|█████████▍| 375/400 [16:43:34<1:06:20, 159.22s/it] 94%|█████████▍| 376/400 [16:46:15<1:03:52, 159.70s/it] 94%|█████████▍| 377/400 [16:48:55<1:01:20, 160.00s/it] 94%|█████████▍| 378/400 [16:51:33<58:27, 159.44s/it]   95%|█████████▍| 379/400 [16:54:14<55:57, 159.89s/it] 95%|█████████▌| 380/400 [16:56:59<53:43, 161.19s/it] 95%|█████████▌| 381/400 [16:59:43<51:21, 162.17s/it] 96%|█████████▌| 382/400 [17:02:21<48:15, 160.85s/it] 96%|█████████▌| 383/400 [17:04:56<45:04, 159.11s/it] 96%|█████████▌| 384/400 [17:07:41<42:53, 160.82s/it] 96%|█████████▋| 385/400 [17:10:25<40:27, 161.84s/it] 96%|█████████▋| 386/400 [17:13:01<37:22, 160.21s/it] 97%|█████████▋| 387/400 [17:15:34<34:14, 158.03s/it] 97%|█████████▋| 388/400 [17:18:18<31:55, 159.65s/it] 97%|█████████▋| 389/400 [17:20:57<29:13, 159.44s/it] 98%|█████████▊| 390/400 [17:23:40<26:45, 160.53s/it] 98%|█████████▊| 391/400 [17:26:17<23:56, 159.60s/it] 98%|█████████▊| 392/400 [17:28:57<21:16, 159.57s/it] 98%|█████████▊| 393/400 [17:31:38<18:41, 160.22s/it] 98%|█████████▊| 394/400 [17:34:27<16:17, 162.90s/it] 99%|█████████▉| 395/400 [17:37:07<13:29, 161.91s/it] 99%|█████████▉| 396/400 [17:39:51<10:50, 162.62s/it] 99%|█████████▉| 397/400 [17:42:27<08:02, 160.67s/it]100%|█████████▉| 398/400 [17:45:05<05:19, 159.69s/it]100%|█████████▉| 399/400 [17:47:44<02:39, 159.40s/it]100%|██████████| 400/400 [17:50:26<00:00, 160.24s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.01/checkpoint-400 already exists and is non-empty.Saving will proceed but saved results may be invalid.
                                                     100%|██████████| 400/400 [17:50:38<00:00, 160.24s/it]100%|██████████| 400/400 [17:50:38<00:00, 160.60s/it]
END of SLURM commands
