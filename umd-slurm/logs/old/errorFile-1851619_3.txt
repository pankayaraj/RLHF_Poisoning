python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt-350m" --epoch=4 --sft_epoch=5 --dataset="hh_poisoned" --per=0.10
------
Some weights of OPTForSequenceClassification were not initialized from the model checkpoint at /cmlscratch/pan/RLHF_Poisoning/models/trained_sft/opt-350m_5_hh_poisoned_0.1 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map (num_proc=4):   0%|          | 0/42537 [00:00<?, ? examples/s]Map (num_proc=4):   2%|▏         | 1000/42537 [00:02<01:40, 414.74 examples/s]Map (num_proc=4):   9%|▉         | 4000/42537 [00:02<00:18, 2066.47 examples/s]Map (num_proc=4):  14%|█▍        | 6000/42537 [00:04<00:27, 1335.03 examples/s]Map (num_proc=4):  19%|█▉        | 8000/42537 [00:04<00:16, 2057.86 examples/s]Map (num_proc=4):  24%|██▎       | 10000/42537 [00:07<00:23, 1388.19 examples/s]Map (num_proc=4):  31%|███       | 13000/42537 [00:09<00:21, 1350.62 examples/s]Map (num_proc=4):  38%|███▊      | 16000/42537 [00:09<00:12, 2055.40 examples/s]Map (num_proc=4):  40%|███▉      | 17000/42537 [00:11<00:18, 1364.07 examples/s]Map (num_proc=4):  47%|████▋     | 20000/42537 [00:12<00:10, 2085.70 examples/s]Map (num_proc=4):  49%|████▉     | 21000/42537 [00:14<00:15, 1378.93 examples/s]Map (num_proc=4):  52%|█████▏    | 22000/42537 [00:14<00:12, 1638.55 examples/s]Map (num_proc=4):  56%|█████▋    | 24000/42537 [00:14<00:07, 2322.67 examples/s]Map (num_proc=4):  59%|█████▉    | 25000/42537 [00:16<00:13, 1321.78 examples/s]Map (num_proc=4):  61%|██████    | 26000/42537 [00:16<00:10, 1575.90 examples/s]Map (num_proc=4):  66%|██████▌   | 28000/42537 [00:16<00:06, 2350.89 examples/s]Map (num_proc=4):  68%|██████▊   | 29000/42537 [00:18<00:10, 1287.25 examples/s]Map (num_proc=4):  73%|███████▎  | 31000/42537 [00:19<00:05, 1956.67 examples/s]Map (num_proc=4):  75%|███████▌  | 32000/42537 [00:19<00:04, 2272.39 examples/s]Map (num_proc=4):  78%|███████▊  | 33000/42537 [00:21<00:07, 1193.20 examples/s]Map (num_proc=4):  82%|████████▏ | 35000/42537 [00:21<00:03, 1889.54 examples/s]Map (num_proc=4):  85%|████████▍ | 36000/42537 [00:21<00:02, 2239.86 examples/s]Map (num_proc=4):  87%|████████▋ | 37000/42537 [00:23<00:04, 1181.83 examples/s]Map (num_proc=4):  92%|█████████▏| 39000/42537 [00:23<00:01, 1889.99 examples/s]Map (num_proc=4):  94%|█████████▍| 40000/42537 [00:24<00:01, 2197.63 examples/s]Map (num_proc=4):  97%|█████████▋| 41268/42537 [00:25<00:00, 1647.80 examples/s]Map (num_proc=4): 100%|██████████| 42537/42537 [00:25<00:00, 2201.57 examples/s]Map (num_proc=4): 100%|██████████| 42537/42537 [00:25<00:00, 1658.14 examples/s]
Filter:   0%|          | 0/42537 [00:00<?, ? examples/s]Filter:   2%|▏         | 1000/42537 [00:00<00:07, 5504.34 examples/s]Filter:   5%|▍         | 2000/42537 [00:00<00:06, 5950.31 examples/s]Filter:   7%|▋         | 3000/42537 [00:00<00:06, 5815.76 examples/s]Filter:   9%|▉         | 4000/42537 [00:00<00:06, 6027.35 examples/s]Filter:  12%|█▏        | 5000/42537 [00:00<00:06, 6198.67 examples/s]Filter:  14%|█▍        | 6000/42537 [00:00<00:05, 6126.04 examples/s]Filter:  16%|█▋        | 7000/42537 [00:01<00:05, 6103.10 examples/s]Filter:  19%|█▉        | 8000/42537 [00:01<00:05, 6077.24 examples/s]Filter:  21%|██        | 9000/42537 [00:01<00:05, 5895.63 examples/s]Filter:  24%|██▎       | 10000/42537 [00:01<00:05, 5958.59 examples/s]Filter:  26%|██▌       | 11000/42537 [00:01<00:05, 5934.08 examples/s]Filter:  28%|██▊       | 12000/42537 [00:02<00:05, 5967.51 examples/s]Filter:  31%|███       | 13000/42537 [00:02<00:04, 5993.88 examples/s]Filter:  33%|███▎      | 14000/42537 [00:02<00:04, 6004.51 examples/s]Filter:  35%|███▌      | 15000/42537 [00:02<00:04, 6035.19 examples/s]Filter:  38%|███▊      | 16000/42537 [00:02<00:04, 6106.41 examples/s]Filter:  40%|███▉      | 17000/42537 [00:02<00:04, 6125.55 examples/s]Filter:  42%|████▏     | 18000/42537 [00:02<00:04, 6071.55 examples/s]Filter:  45%|████▍     | 19000/42537 [00:03<00:03, 5991.88 examples/s]Filter:  47%|████▋     | 20000/42537 [00:03<00:03, 5954.47 examples/s]Filter:  49%|████▉     | 21000/42537 [00:03<00:04, 4944.57 examples/s]Filter:  52%|█████▏    | 22000/42537 [00:03<00:03, 5184.23 examples/s]Filter:  54%|█████▍    | 23000/42537 [00:03<00:03, 5442.15 examples/s]Filter:  56%|█████▋    | 24000/42537 [00:04<00:03, 5644.90 examples/s]Filter:  59%|█████▉    | 25000/42537 [00:04<00:03, 5685.67 examples/s]Filter:  61%|██████    | 26000/42537 [00:04<00:02, 5751.67 examples/s]Filter:  63%|██████▎   | 27000/42537 [00:04<00:02, 5905.05 examples/s]Filter:  66%|██████▌   | 28000/42537 [00:04<00:02, 5913.62 examples/s]Filter:  68%|██████▊   | 29000/42537 [00:04<00:02, 5912.03 examples/s]Filter:  71%|███████   | 30000/42537 [00:05<00:02, 5956.98 examples/s]Filter:  73%|███████▎  | 31000/42537 [00:05<00:01, 5900.89 examples/s]Filter:  75%|███████▌  | 32000/42537 [00:05<00:01, 5944.46 examples/s]Filter:  78%|███████▊  | 33000/42537 [00:05<00:01, 5960.17 examples/s]Filter:  80%|███████▉  | 34000/42537 [00:05<00:01, 6009.38 examples/s]Filter:  82%|████████▏ | 35000/42537 [00:05<00:01, 5962.86 examples/s]Filter:  85%|████████▍ | 36000/42537 [00:06<00:01, 6000.68 examples/s]Filter:  87%|████████▋ | 37000/42537 [00:06<00:00, 5971.97 examples/s]Filter:  89%|████████▉ | 38000/42537 [00:06<00:00, 5982.78 examples/s]Filter:  92%|█████████▏| 39000/42537 [00:06<00:00, 6013.94 examples/s]Filter:  94%|█████████▍| 40000/42537 [00:06<00:00, 6100.65 examples/s]Filter:  96%|█████████▋| 41000/42537 [00:06<00:00, 6064.04 examples/s]Filter:  99%|█████████▊| 42000/42537 [00:07<00:00, 6018.39 examples/s]Filter: 100%|██████████| 42537/42537 [00:07<00:00, 5895.26 examples/s]
Map (num_proc=4):   0%|          | 0/2312 [00:00<?, ? examples/s]Map (num_proc=4):  25%|██▌       | 578/2312 [00:01<00:04, 423.49 examples/s]Map (num_proc=4):  75%|███████▌  | 1734/2312 [00:01<00:00, 1470.69 examples/s]Map (num_proc=4): 100%|██████████| 2312/2312 [00:01<00:00, 1427.50 examples/s]
Filter:   0%|          | 0/2312 [00:00<?, ? examples/s]Filter:  43%|████▎     | 1000/2312 [00:00<00:00, 5647.37 examples/s]Filter:  87%|████████▋ | 2000/2312 [00:00<00:00, 5772.23 examples/s]Filter: 100%|██████████| 2312/2312 [00:00<00:00, 5718.61 examples/s]
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/160 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  1%|          | 1/160 [02:37<6:56:35, 157.20s/it]  1%|▏         | 2/160 [05:23<7:07:33, 162.36s/it]  2%|▏         | 3/160 [07:58<6:55:51, 158.92s/it]  2%|▎         | 4/160 [10:35<6:51:55, 158.43s/it]  3%|▎         | 5/160 [13:16<6:51:37, 159.34s/it]  4%|▍         | 6/160 [15:56<6:49:31, 159.55s/it]  4%|▍         | 7/160 [18:39<6:49:35, 160.62s/it]  5%|▌         | 8/160 [21:22<6:48:47, 161.37s/it]  6%|▌         | 9/160 [24:12<6:53:02, 164.13s/it]  6%|▋         | 10/160 [26:52<6:47:12, 162.88s/it]  7%|▋         | 11/160 [29:39<6:47:29, 164.09s/it]  8%|▊         | 12/160 [32:21<6:43:03, 163.40s/it]  8%|▊         | 13/160 [35:06<6:41:49, 164.01s/it]  9%|▉         | 14/160 [37:52<6:40:23, 164.55s/it]  9%|▉         | 15/160 [40:31<6:33:34, 162.86s/it] 10%|█         | 16/160 [43:07<6:25:43, 160.72s/it] 11%|█         | 17/160 [45:54<6:27:29, 162.58s/it] 11%|█▏        | 18/160 [48:38<6:26:02, 163.11s/it] 12%|█▏        | 19/160 [51:18<6:21:16, 162.25s/it] 12%|█▎        | 20/160 [53:59<6:17:32, 161.80s/it] 13%|█▎        | 21/160 [56:46<6:18:08, 163.23s/it] 14%|█▍        | 22/160 [59:36<6:20:10, 165.30s/it] 14%|█▍        | 23/160 [1:02:15<6:13:38, 163.64s/it] 15%|█▌        | 24/160 [1:04:57<6:09:43, 163.11s/it] 16%|█▌        | 25/160 [1:07:35<6:03:32, 161.57s/it] 16%|█▋        | 26/160 [1:10:22<6:04:35, 163.25s/it] 17%|█▋        | 27/160 [1:12:59<5:57:14, 161.16s/it] 18%|█▊        | 28/160 [1:15:41<5:55:25, 161.55s/it] 18%|█▊        | 29/160 [1:18:21<5:51:33, 161.02s/it] 19%|█▉        | 30/160 [1:21:02<5:49:05, 161.12s/it] 19%|█▉        | 31/160 [1:23:48<5:49:33, 162.59s/it] 20%|██        | 32/160 [1:26:33<5:48:12, 163.22s/it] 21%|██        | 33/160 [1:29:22<5:48:56, 164.86s/it] 21%|██▏       | 34/160 [1:32:05<5:45:15, 164.41s/it] 22%|██▏       | 35/160 [1:34:53<5:44:56, 165.57s/it] 22%|██▎       | 36/160 [1:37:37<5:40:47, 164.90s/it] 23%|██▎       | 37/160 [1:40:25<5:40:04, 165.89s/it] 24%|██▍       | 38/160 [1:43:09<5:36:02, 165.27s/it] 24%|██▍       | 39/160 [1:45:56<5:34:27, 165.84s/it] 25%|██▌       | 40/160 [1:48:40<5:30:51, 165.43s/it] 26%|██▌       | 41/160 [1:51:18<5:23:10, 162.94s/it] 26%|██▋       | 42/160 [1:53:57<5:18:16, 161.84s/it] 27%|██▋       | 43/160 [1:56:38<5:15:04, 161.58s/it] 28%|██▊       | 44/160 [1:59:21<5:13:29, 162.15s/it] 28%|██▊       | 45/160 [2:02:03<5:10:38, 162.07s/it] 29%|██▉       | 46/160 [2:04:47<5:08:45, 162.51s/it] 29%|██▉       | 47/160 [2:07:27<5:04:37, 161.74s/it] 30%|███       | 48/160 [2:10:04<4:59:17, 160.33s/it] 31%|███       | 49/160 [2:12:49<4:59:31, 161.91s/it] 31%|███▏      | 50/160 [2:15:35<4:58:59, 163.08s/it] 32%|███▏      | 51/160 [2:18:21<4:57:50, 163.95s/it] 32%|███▎      | 52/160 [2:20:54<4:49:21, 160.76s/it] 33%|███▎      | 53/160 [2:23:36<4:47:21, 161.13s/it] 34%|███▍      | 54/160 [2:26:23<4:47:50, 162.93s/it] 34%|███▍      | 55/160 [2:29:01<4:42:27, 161.40s/it] 35%|███▌      | 56/160 [2:31:45<4:41:10, 162.22s/it] 36%|███▌      | 57/160 [2:34:33<4:41:03, 163.73s/it] 36%|███▋      | 58/160 [2:37:12<4:36:14, 162.50s/it] 37%|███▋      | 59/160 [2:39:55<4:33:42, 162.60s/it] 38%|███▊      | 60/160 [2:42:35<4:29:42, 161.82s/it] 38%|███▊      | 61/160 [2:45:20<4:28:40, 162.83s/it] 39%|███▉      | 62/160 [2:48:05<4:27:03, 163.51s/it] 39%|███▉      | 63/160 [2:50:53<4:26:18, 164.73s/it] 40%|████      | 64/160 [2:53:43<4:26:11, 166.37s/it] 41%|████      | 65/160 [2:56:20<4:18:42, 163.40s/it] 41%|████▏     | 66/160 [2:59:03<4:16:02, 163.43s/it] 42%|████▏     | 67/160 [3:01:43<4:11:36, 162.33s/it] 42%|████▎     | 68/160 [3:04:23<4:07:59, 161.74s/it] 43%|████▎     | 69/160 [3:07:06<4:05:35, 161.92s/it] 44%|████▍     | 70/160 [3:09:41<3:59:55, 159.95s/it] 44%|████▍     | 71/160 [3:12:18<3:56:10, 159.21s/it] 45%|████▌     | 72/160 [3:15:03<3:56:00, 160.92s/it] 46%|████▌     | 73/160 [3:17:46<3:54:00, 161.38s/it] 46%|████▋     | 74/160 [3:20:29<3:52:07, 161.94s/it] 47%|████▋     | 75/160 [3:23:17<3:51:46, 163.61s/it] 48%|████▊     | 76/160 [3:26:01<3:49:28, 163.91s/it] 48%|████▊     | 77/160 [3:28:36<3:43:04, 161.26s/it] 49%|████▉     | 78/160 [3:31:19<3:40:55, 161.65s/it] 49%|████▉     | 79/160 [3:34:06<3:40:20, 163.22s/it] 50%|█████     | 80/160 [3:36:45<3:36:12, 162.15s/it] 51%|█████     | 81/160 [3:39:27<3:33:24, 162.09s/it] 51%|█████▏    | 82/160 [3:42:06<3:29:24, 161.09s/it] 52%|█████▏    | 83/160 [3:44:48<3:26:55, 161.24s/it] 52%|█████▎    | 84/160 [3:47:24<3:22:28, 159.85s/it] 53%|█████▎    | 85/160 [3:50:12<3:22:46, 162.21s/it] 54%|█████▍    | 86/160 [3:52:56<3:20:52, 162.87s/it] 54%|█████▍    | 87/160 [3:55:41<3:18:44, 163.35s/it] 55%|█████▌    | 88/160 [3:58:22<3:15:19, 162.77s/it] 56%|█████▌    | 89/160 [4:01:07<3:13:15, 163.32s/it] 56%|█████▋    | 90/160 [4:03:50<3:10:28, 163.27s/it] 57%|█████▋    | 91/160 [4:06:32<3:07:24, 162.96s/it] 57%|█████▊    | 92/160 [4:09:18<3:05:46, 163.92s/it] 58%|█████▊    | 93/160 [4:11:59<3:01:56, 162.93s/it] 59%|█████▉    | 94/160 [4:14:42<2:59:04, 162.80s/it] 59%|█████▉    | 95/160 [4:17:23<2:56:03, 162.52s/it] 60%|██████    | 96/160 [4:20:01<2:51:39, 160.92s/it] 61%|██████    | 97/160 [4:22:44<2:49:38, 161.56s/it] 61%|██████▏   | 98/160 [4:25:31<2:48:46, 163.34s/it] 62%|██████▏   | 99/160 [4:28:04<2:42:45, 160.09s/it] 62%|██████▎   | 100/160 [4:30:50<2:41:58, 161.98s/it] 63%|██████▎   | 101/160 [4:33:32<2:39:08, 161.84s/it] 64%|██████▍   | 102/160 [4:36:16<2:37:06, 162.53s/it] 64%|██████▍   | 103/160 [4:39:00<2:34:49, 162.97s/it] 65%|██████▌   | 104/160 [4:41:48<2:33:31, 164.50s/it] 66%|██████▌   | 105/160 [4:44:30<2:30:05, 163.74s/it] 66%|██████▋   | 106/160 [4:47:12<2:26:57, 163.29s/it] 67%|██████▋   | 107/160 [4:49:55<2:24:08, 163.17s/it] 68%|██████▊   | 108/160 [4:52:42<2:22:31, 164.46s/it] 68%|██████▊   | 109/160 [4:55:29<2:20:13, 164.98s/it] 69%|██████▉   | 110/160 [4:58:12<2:17:02, 164.45s/it] 69%|██████▉   | 111/160 [5:00:53<2:13:34, 163.56s/it] 70%|███████   | 112/160 [5:03:38<2:11:02, 163.80s/it] 71%|███████   | 113/160 [5:06:19<2:07:48, 163.16s/it] 71%|███████▏  | 114/160 [5:09:04<2:05:24, 163.57s/it] 72%|███████▏  | 115/160 [5:11:51<2:03:35, 164.78s/it] 72%|███████▎  | 116/160 [5:14:29<1:59:17, 162.67s/it] 73%|███████▎  | 117/160 [5:17:09<1:55:59, 161.85s/it] 74%|███████▍  | 118/160 [5:19:43<1:51:39, 159.51s/it] 74%|███████▍  | 119/160 [5:22:31<1:50:43, 162.03s/it] 75%|███████▌  | 120/160 [5:25:17<1:48:50, 163.26s/it] 76%|███████▌  | 121/160 [5:27:52<1:44:25, 160.66s/it] 76%|███████▋  | 122/160 [5:30:28<1:40:53, 159.30s/it] 77%|███████▋  | 123/160 [5:33:06<1:37:55, 158.81s/it] 78%|███████▊  | 124/160 [5:35:50<1:36:16, 160.45s/it] 78%|███████▊  | 125/160 [5:38:32<1:33:58, 161.10s/it] 79%|███████▉  | 126/160 [5:41:17<1:31:49, 162.03s/it] 79%|███████▉  | 127/160 [5:44:05<1:30:12, 164.00s/it] 80%|████████  | 128/160 [5:46:43<1:26:32, 162.26s/it] 81%|████████  | 129/160 [5:49:25<1:23:44, 162.10s/it] 81%|████████▏ | 130/160 [5:52:16<1:22:25, 164.84s/it] 82%|████████▏ | 131/160 [5:55:00<1:19:26, 164.35s/it] 82%|████████▎ | 132/160 [5:57:44<1:16:45, 164.48s/it] 83%|████████▎ | 133/160 [6:00:31<1:14:16, 165.05s/it] 84%|████████▍ | 134/160 [6:03:13<1:11:08, 164.17s/it] 84%|████████▍ | 135/160 [6:05:52<1:07:44, 162.59s/it] 85%|████████▌ | 136/160 [6:08:41<1:05:51, 164.66s/it] 86%|████████▌ | 137/160 [6:11:23<1:02:46, 163.75s/it] 86%|████████▋ | 138/160 [6:14:09<1:00:20, 164.55s/it] 87%|████████▋ | 139/160 [6:16:51<57:19, 163.78s/it]   88%|████████▊ | 140/160 [6:19:32<54:18, 162.92s/it] 88%|████████▊ | 141/160 [6:22:17<51:46, 163.48s/it] 89%|████████▉ | 142/160 [6:24:56<48:40, 162.26s/it] 89%|████████▉ | 143/160 [6:27:37<45:48, 161.70s/it] 90%|█████████ | 144/160 [6:30:15<42:51, 160.74s/it] 91%|█████████ | 145/160 [6:32:56<40:09, 160.64s/it] 91%|█████████▏| 146/160 [6:35:36<37:28, 160.61s/it] 92%|█████████▏| 147/160 [6:38:15<34:42, 160.18s/it] 92%|█████████▎| 148/160 [6:41:03<32:27, 162.27s/it] 93%|█████████▎| 149/160 [6:43:44<29:42, 162.04s/it] 94%|█████████▍| 150/160 [6:46:32<27:16, 163.69s/it] 94%|█████████▍| 151/160 [6:49:18<24:41, 164.65s/it] 95%|█████████▌| 152/160 [6:51:57<21:41, 162.69s/it] 96%|█████████▌| 153/160 [6:54:38<18:56, 162.38s/it] 96%|█████████▋| 154/160 [6:57:18<16:09, 161.60s/it] 97%|█████████▋| 155/160 [7:00:02<13:31, 162.34s/it] 98%|█████████▊| 156/160 [7:02:43<10:47, 161.94s/it] 98%|█████████▊| 157/160 [7:05:32<08:11, 163.94s/it] 99%|█████████▉| 158/160 [7:08:13<05:26, 163.18s/it] 99%|█████████▉| 159/160 [7:10:59<02:44, 164.06s/it]100%|██████████| 160/160 [7:13:39<00:00, 162.86s/it]                                                    100%|██████████| 160/160 [7:13:39<00:00, 162.86s/it]100%|██████████| 160/160 [7:13:39<00:00, 162.62s/it]
END of SLURM commands
