python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt-350m" --epoch=4 --sft_epoch=5 --dataset="hh_original"
------
Some weights of OPTForSequenceClassification were not initialized from the model checkpoint at /cmlscratch/pan/RLHF_Poisoning/models/trained_sft/opt-350m_5_hh_original_0.05 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/160 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  1%|          | 1/160 [02:46<7:20:42, 166.30s/it]  1%|▏         | 2/160 [05:31<7:16:53, 165.91s/it]  2%|▏         | 3/160 [08:22<7:20:00, 168.16s/it]  2%|▎         | 4/160 [11:02<7:08:27, 164.79s/it]  3%|▎         | 5/160 [13:41<6:59:57, 162.56s/it]  4%|▍         | 6/160 [16:23<6:57:33, 162.68s/it]  4%|▍         | 7/160 [19:06<6:55:01, 162.76s/it]  5%|▌         | 8/160 [21:42<6:46:48, 160.58s/it]  6%|▌         | 9/160 [24:24<6:44:49, 160.86s/it]  6%|▋         | 10/160 [27:11<6:46:59, 162.79s/it]  7%|▋         | 11/160 [29:55<6:45:31, 163.30s/it]  8%|▊         | 12/160 [32:39<6:43:20, 163.52s/it]  8%|▊         | 13/160 [35:21<6:39:22, 163.01s/it]  9%|▉         | 14/160 [38:03<6:35:52, 162.69s/it]  9%|▉         | 15/160 [40:47<6:33:56, 163.01s/it] 10%|█         | 16/160 [43:30<6:31:37, 163.17s/it] 11%|█         | 17/160 [46:16<6:30:21, 163.79s/it] 11%|█▏        | 18/160 [48:59<6:27:19, 163.66s/it] 12%|█▏        | 19/160 [51:44<6:25:44, 164.15s/it] 12%|█▎        | 20/160 [54:25<6:20:24, 163.03s/it] 13%|█▎        | 21/160 [57:02<6:13:21, 161.16s/it] 14%|█▍        | 22/160 [59:42<6:10:19, 161.01s/it] 14%|█▍        | 23/160 [1:02:19<6:05:05, 159.89s/it] 15%|█▌        | 24/160 [1:05:00<6:02:40, 160.00s/it] 16%|█▌        | 25/160 [1:07:39<5:59:33, 159.80s/it] 16%|█▋        | 26/160 [1:10:21<5:58:05, 160.34s/it] 17%|█▋        | 27/160 [1:12:58<5:53:42, 159.57s/it] 18%|█▊        | 28/160 [1:15:42<5:54:01, 160.92s/it] 18%|█▊        | 29/160 [1:18:19<5:48:20, 159.54s/it] 19%|█▉        | 30/160 [1:20:59<5:45:53, 159.64s/it] 19%|█▉        | 31/160 [1:23:39<5:43:50, 159.93s/it] 20%|██        | 32/160 [1:26:14<5:38:01, 158.45s/it] 21%|██        | 33/160 [1:28:56<5:37:23, 159.40s/it] 21%|██▏       | 34/160 [1:31:44<5:39:58, 161.89s/it] 22%|██▏       | 35/160 [1:34:22<5:34:53, 160.75s/it] 22%|██▎       | 36/160 [1:36:59<5:30:21, 159.85s/it] 23%|██▎       | 37/160 [1:39:38<5:26:57, 159.49s/it] 24%|██▍       | 38/160 [1:42:18<5:24:15, 159.47s/it] 24%|██▍       | 39/160 [1:45:00<5:23:18, 160.32s/it] 25%|██▌       | 40/160 [1:47:41<5:21:02, 160.52s/it] 26%|██▌       | 41/160 [1:50:19<5:16:50, 159.75s/it] 26%|██▋       | 42/160 [1:53:06<5:18:30, 161.95s/it] 27%|██▋       | 43/160 [1:55:48<5:15:38, 161.87s/it] 28%|██▊       | 44/160 [1:58:29<5:12:38, 161.71s/it] 28%|██▊       | 45/160 [2:01:09<5:08:53, 161.16s/it] 29%|██▉       | 46/160 [2:03:56<5:09:29, 162.89s/it] 29%|██▉       | 47/160 [2:06:35<5:04:39, 161.76s/it] 30%|███       | 48/160 [2:09:14<5:00:18, 160.88s/it] 31%|███       | 49/160 [2:11:54<4:57:18, 160.71s/it] 31%|███▏      | 50/160 [2:14:40<4:57:30, 162.28s/it] 32%|███▏      | 51/160 [2:17:21<4:54:22, 162.04s/it] 32%|███▎      | 52/160 [2:20:00<4:49:51, 161.03s/it] 33%|███▎      | 53/160 [2:22:48<4:50:52, 163.10s/it] 34%|███▍      | 54/160 [2:25:27<4:45:53, 161.83s/it] 34%|███▍      | 55/160 [2:28:06<4:41:55, 161.10s/it] 35%|███▌      | 56/160 [2:30:44<4:37:28, 160.08s/it] 36%|███▌      | 57/160 [2:33:24<4:34:58, 160.18s/it] 36%|███▋      | 58/160 [2:36:12<4:36:22, 162.57s/it] 37%|███▋      | 59/160 [2:38:52<4:31:52, 161.51s/it] 38%|███▊      | 60/160 [2:41:27<4:26:06, 159.66s/it] 38%|███▊      | 61/160 [2:44:06<4:23:09, 159.49s/it] 39%|███▉      | 62/160 [2:46:51<4:23:17, 161.20s/it] 39%|███▉      | 63/160 [2:49:36<4:22:36, 162.44s/it] 40%|████      | 64/160 [2:52:20<4:20:21, 162.72s/it] 41%|████      | 65/160 [2:54:57<4:14:58, 161.04s/it] 41%|████▏     | 66/160 [2:57:36<4:11:27, 160.50s/it] 42%|████▏     | 67/160 [3:00:15<4:07:48, 159.88s/it] 42%|████▎     | 68/160 [3:02:55<4:05:11, 159.91s/it] 43%|████▎     | 69/160 [3:05:35<4:02:56, 160.18s/it] 44%|████▍     | 70/160 [3:08:11<3:58:24, 158.94s/it] 44%|████▍     | 71/160 [3:10:53<3:56:55, 159.72s/it] 45%|████▌     | 72/160 [3:13:40<3:57:36, 162.01s/it] 46%|████▌     | 73/160 [3:16:25<3:56:01, 162.78s/it] 46%|████▋     | 74/160 [3:19:07<3:52:50, 162.45s/it] 47%|████▋     | 75/160 [3:21:52<3:51:16, 163.25s/it] 48%|████▊     | 76/160 [3:24:32<3:47:26, 162.45s/it] 48%|████▊     | 77/160 [3:27:17<3:45:27, 162.98s/it] 49%|████▉     | 78/160 [3:30:02<3:43:56, 163.86s/it] 49%|████▉     | 79/160 [3:32:42<3:39:39, 162.71s/it] 50%|█████     | 80/160 [3:35:18<3:34:00, 160.50s/it] 51%|█████     | 81/160 [3:37:56<3:30:18, 159.72s/it] 51%|█████▏    | 82/160 [3:40:40<3:29:17, 161.00s/it] 52%|█████▏    | 83/160 [3:43:21<3:26:35, 160.98s/it] 52%|█████▎    | 84/160 [3:45:58<3:22:39, 160.00s/it] 53%|█████▎    | 85/160 [3:48:31<3:17:13, 157.77s/it] 54%|█████▍    | 86/160 [3:51:12<3:15:49, 158.78s/it] 54%|█████▍    | 87/160 [3:53:54<3:14:11, 159.61s/it] 55%|█████▌    | 88/160 [3:56:42<3:14:39, 162.22s/it] 56%|█████▌    | 89/160 [3:59:24<3:11:50, 162.13s/it] 56%|█████▋    | 90/160 [4:02:05<3:08:49, 161.85s/it] 57%|█████▋    | 91/160 [4:04:47<3:06:16, 161.98s/it] 57%|█████▊    | 92/160 [4:07:35<3:05:21, 163.55s/it] 58%|█████▊    | 93/160 [4:10:14<3:01:23, 162.45s/it] 59%|█████▉    | 94/160 [4:12:54<2:57:41, 161.53s/it] 59%|█████▉    | 95/160 [4:15:36<2:55:15, 161.78s/it] 60%|██████    | 96/160 [4:18:20<2:53:18, 162.48s/it] 61%|██████    | 97/160 [4:21:05<2:51:17, 163.14s/it] 61%|██████▏   | 98/160 [4:23:40<2:46:09, 160.79s/it] 62%|██████▏   | 99/160 [4:26:19<2:42:44, 160.07s/it] 62%|██████▎   | 100/160 [4:28:55<2:38:56, 158.95s/it] 63%|██████▎   | 101/160 [4:31:37<2:37:18, 159.98s/it] 64%|██████▍   | 102/160 [4:34:17<2:34:40, 160.01s/it] 64%|██████▍   | 103/160 [4:37:06<2:34:19, 162.46s/it] 65%|██████▌   | 104/160 [4:39:50<2:32:17, 163.17s/it] 66%|██████▌   | 105/160 [4:42:33<2:29:31, 163.11s/it] 66%|██████▋   | 106/160 [4:45:12<2:25:38, 161.82s/it] 67%|██████▋   | 107/160 [4:47:55<2:23:13, 162.15s/it] 68%|██████▊   | 108/160 [4:50:36<2:20:09, 161.72s/it] 68%|██████▊   | 109/160 [4:53:09<2:15:10, 159.02s/it] 69%|██████▉   | 110/160 [4:55:51<2:13:21, 160.04s/it] 69%|██████▉   | 111/160 [4:58:27<2:09:45, 158.88s/it] 70%|███████   | 112/160 [5:01:12<2:08:31, 160.66s/it] 71%|███████   | 113/160 [5:03:55<2:06:21, 161.30s/it] 71%|███████▏  | 114/160 [5:06:38<2:04:02, 161.78s/it] 72%|███████▏  | 115/160 [5:09:14<2:00:01, 160.03s/it] 72%|███████▎  | 116/160 [5:11:51<1:56:43, 159.18s/it] 73%|███████▎  | 117/160 [5:14:42<1:56:34, 162.66s/it] 74%|███████▍  | 118/160 [5:17:26<1:54:10, 163.11s/it] 74%|███████▍  | 119/160 [5:20:09<1:51:24, 163.05s/it] 75%|███████▌  | 120/160 [5:22:48<1:47:57, 161.95s/it] 76%|███████▌  | 121/160 [5:25:29<1:45:04, 161.66s/it] 76%|███████▋  | 122/160 [5:28:12<1:42:33, 161.94s/it] 77%|███████▋  | 123/160 [5:30:55<1:40:12, 162.50s/it] 78%|███████▊  | 124/160 [5:33:34<1:36:46, 161.30s/it] 78%|███████▊  | 125/160 [5:36:11<1:33:23, 160.09s/it] 79%|███████▉  | 126/160 [5:38:52<1:30:51, 160.35s/it] 79%|███████▉  | 127/160 [5:41:26<1:27:10, 158.51s/it] 80%|████████  | 128/160 [5:43:58<1:23:30, 156.58s/it] 81%|████████  | 129/160 [5:46:40<1:21:40, 158.08s/it] 81%|████████▏ | 130/160 [5:49:20<1:19:22, 158.74s/it] 82%|████████▏ | 131/160 [5:52:11<1:18:24, 162.21s/it] 82%|████████▎ | 132/160 [5:54:56<1:16:06, 163.08s/it] 83%|████████▎ | 133/160 [5:57:35<1:12:52, 161.95s/it] 84%|████████▍ | 134/160 [6:00:17<1:10:14, 162.09s/it] 84%|████████▍ | 135/160 [6:02:57<1:07:11, 161.26s/it] 85%|████████▌ | 136/160 [6:05:38<1:04:33, 161.40s/it] 86%|████████▌ | 137/160 [6:08:18<1:01:37, 160.75s/it] 86%|████████▋ | 138/160 [6:10:57<58:46, 160.27s/it]   87%|████████▋ | 139/160 [6:13:38<56:10, 160.49s/it] 88%|████████▊ | 140/160 [6:16:24<54:05, 162.26s/it] 88%|████████▊ | 141/160 [6:19:05<51:16, 161.90s/it] 89%|████████▉ | 142/160 [6:21:41<48:00, 160.02s/it] 89%|████████▉ | 143/160 [6:24:21<45:21, 160.10s/it] 90%|█████████ | 144/160 [6:27:04<42:56, 161.03s/it] 91%|█████████ | 145/160 [6:29:50<40:37, 162.52s/it] 91%|█████████▏| 146/160 [6:32:31<37:46, 161.86s/it] 92%|█████████▏| 147/160 [6:35:15<35:13, 162.56s/it] 92%|█████████▎| 148/160 [6:37:52<32:09, 160.77s/it] 93%|█████████▎| 149/160 [6:40:39<29:49, 162.70s/it] 94%|█████████▍| 150/160 [6:43:20<27:01, 162.14s/it] 94%|█████████▍| 151/160 [6:46:01<24:18, 162.06s/it] 95%|█████████▌| 152/160 [6:48:50<21:51, 163.96s/it] 96%|█████████▌| 153/160 [6:51:26<18:50, 161.49s/it] 96%|█████████▋| 154/160 [6:54:11<16:16, 162.82s/it] 97%|█████████▋| 155/160 [6:56:50<13:27, 161.45s/it] 98%|█████████▊| 156/160 [6:59:31<10:45, 161.31s/it] 98%|█████████▊| 157/160 [7:02:08<08:00, 160.11s/it] 99%|█████████▉| 158/160 [7:04:45<05:18, 159.16s/it] 99%|█████████▉| 159/160 [7:07:30<02:41, 161.07s/it]100%|██████████| 160/160 [7:10:16<00:00, 162.50s/it]                                                    100%|██████████| 160/160 [7:10:16<00:00, 162.50s/it]100%|██████████| 160/160 [7:10:16<00:00, 161.36s/it]
END of SLURM commands
