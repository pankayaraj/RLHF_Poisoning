python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt-350m" --epoch=4 --sft_epoch=5 --dataset="hh_poisoned" --per=0.05
------
Some weights of OPTForSequenceClassification were not initialized from the model checkpoint at /cmlscratch/pan/RLHF_Poisoning/models/trained_sft/opt-350m_5_hh_poisoned_0.05 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map (num_proc=4):   0%|          | 0/42537 [00:00<?, ? examples/s]Map (num_proc=4):   2%|▏         | 1000/42537 [00:02<01:41, 408.36 examples/s]Map (num_proc=4):  12%|█▏        | 5000/42537 [00:04<00:32, 1151.06 examples/s]Map (num_proc=4):  19%|█▉        | 8000/42537 [00:04<00:16, 2083.82 examples/s]Map (num_proc=4):  21%|██        | 9000/42537 [00:07<00:27, 1236.80 examples/s]Map (num_proc=4):  26%|██▌       | 11000/42537 [00:07<00:17, 1821.27 examples/s]Map (num_proc=4):  31%|███       | 13000/42537 [00:09<00:22, 1329.83 examples/s]Map (num_proc=4):  38%|███▊      | 16000/42537 [00:10<00:12, 2053.25 examples/s]Map (num_proc=4):  40%|███▉      | 17000/42537 [00:12<00:18, 1352.34 examples/s]Map (num_proc=4):  45%|████▍     | 19000/42537 [00:12<00:12, 1884.22 examples/s]Map (num_proc=4):  47%|████▋     | 20000/42537 [00:12<00:10, 2072.53 examples/s]Map (num_proc=4):  49%|████▉     | 21000/42537 [00:14<00:16, 1268.93 examples/s]Map (num_proc=4):  52%|█████▏    | 22000/42537 [00:14<00:13, 1559.56 examples/s]Map (num_proc=4):  56%|█████▋    | 24000/42537 [00:14<00:08, 2249.82 examples/s]Map (num_proc=4):  59%|█████▉    | 25000/42537 [00:16<00:13, 1286.32 examples/s]Map (num_proc=4):  61%|██████    | 26000/42537 [00:17<00:10, 1532.23 examples/s]Map (num_proc=4):  66%|██████▌   | 28000/42537 [00:17<00:06, 2173.78 examples/s]Map (num_proc=4):  68%|██████▊   | 29000/42537 [00:19<00:10, 1274.45 examples/s]Map (num_proc=4):  71%|███████   | 30000/42537 [00:19<00:08, 1555.31 examples/s]Map (num_proc=4):  75%|███████▌  | 32000/42537 [00:19<00:04, 2199.45 examples/s]Map (num_proc=4):  78%|███████▊  | 33000/42537 [00:21<00:07, 1240.83 examples/s]Map (num_proc=4):  80%|███████▉  | 34000/42537 [00:22<00:05, 1557.78 examples/s]Map (num_proc=4):  85%|████████▍ | 36000/42537 [00:22<00:02, 2252.02 examples/s]Map (num_proc=4):  87%|████████▋ | 37000/42537 [00:24<00:04, 1271.53 examples/s]Map (num_proc=4):  89%|████████▉ | 38000/42537 [00:24<00:02, 1531.72 examples/s]Map (num_proc=4):  94%|█████████▍| 40000/42537 [00:24<00:01, 2116.56 examples/s]Map (num_proc=4):  96%|█████████▌| 40634/42537 [00:25<00:01, 1597.02 examples/s]Map (num_proc=4):  97%|█████████▋| 41268/42537 [00:26<00:00, 1766.75 examples/s]Map (num_proc=4):  99%|█████████▊| 41903/42537 [00:26<00:00, 2062.93 examples/s]Map (num_proc=4): 100%|██████████| 42537/42537 [00:26<00:00, 2377.07 examples/s]Map (num_proc=4): 100%|██████████| 42537/42537 [00:26<00:00, 1609.10 examples/s]
Filter:   0%|          | 0/42537 [00:00<?, ? examples/s]Filter:   2%|▏         | 1000/42537 [00:00<00:07, 5243.31 examples/s]Filter:   5%|▍         | 2000/42537 [00:00<00:07, 5598.73 examples/s]Filter:   7%|▋         | 3000/42537 [00:00<00:06, 5717.79 examples/s]Filter:   9%|▉         | 4000/42537 [00:00<00:06, 5883.74 examples/s]Filter:  12%|█▏        | 5000/42537 [00:00<00:06, 5947.59 examples/s]Filter:  14%|█▍        | 6000/42537 [00:01<00:06, 5851.15 examples/s]Filter:  16%|█▋        | 7000/42537 [00:01<00:06, 5826.02 examples/s]Filter:  19%|█▉        | 8000/42537 [00:01<00:05, 5799.12 examples/s]Filter:  21%|██        | 9000/42537 [00:01<00:05, 5808.31 examples/s]Filter:  24%|██▎       | 10000/42537 [00:01<00:05, 5828.59 examples/s]Filter:  26%|██▌       | 11000/42537 [00:01<00:05, 5811.60 examples/s]Filter:  28%|██▊       | 12000/42537 [00:02<00:05, 5879.76 examples/s]Filter:  31%|███       | 13000/42537 [00:02<00:05, 5897.13 examples/s]Filter:  33%|███▎      | 14000/42537 [00:02<00:04, 5923.94 examples/s]Filter:  35%|███▌      | 15000/42537 [00:02<00:04, 5863.44 examples/s]Filter:  38%|███▊      | 16000/42537 [00:02<00:04, 5944.89 examples/s]Filter:  40%|███▉      | 17000/42537 [00:02<00:04, 5991.54 examples/s]Filter:  42%|████▏     | 18000/42537 [00:03<00:04, 5950.80 examples/s]Filter:  45%|████▍     | 19000/42537 [00:03<00:04, 5864.95 examples/s]Filter:  47%|████▋     | 20000/42537 [00:03<00:03, 5809.70 examples/s]Filter:  49%|████▉     | 21000/42537 [00:03<00:04, 4729.68 examples/s]Filter:  52%|█████▏    | 22000/42537 [00:03<00:04, 4991.91 examples/s]Filter:  54%|█████▍    | 23000/42537 [00:04<00:03, 5234.86 examples/s]Filter:  56%|█████▋    | 24000/42537 [00:04<00:03, 5438.67 examples/s]Filter:  59%|█████▉    | 25000/42537 [00:04<00:03, 5515.45 examples/s]Filter:  61%|██████    | 26000/42537 [00:04<00:02, 5615.68 examples/s]Filter:  63%|██████▎   | 27000/42537 [00:04<00:02, 5767.02 examples/s]Filter:  66%|██████▌   | 28000/42537 [00:04<00:02, 5770.91 examples/s]Filter:  68%|██████▊   | 29000/42537 [00:05<00:02, 5835.00 examples/s]Filter:  71%|███████   | 30000/42537 [00:05<00:02, 5863.98 examples/s]Filter:  73%|███████▎  | 31000/42537 [00:05<00:01, 5788.14 examples/s]Filter:  75%|███████▌  | 32000/42537 [00:05<00:01, 5832.50 examples/s]Filter:  78%|███████▊  | 33000/42537 [00:05<00:01, 5856.32 examples/s]Filter:  80%|███████▉  | 34000/42537 [00:05<00:01, 5887.89 examples/s]Filter:  82%|████████▏ | 35000/42537 [00:06<00:01, 5865.52 examples/s]Filter:  85%|████████▍ | 36000/42537 [00:06<00:01, 5939.12 examples/s]Filter:  87%|████████▋ | 37000/42537 [00:06<00:00, 5903.14 examples/s]Filter:  89%|████████▉ | 38000/42537 [00:06<00:00, 5903.96 examples/s]Filter:  92%|█████████▏| 39000/42537 [00:06<00:00, 5902.47 examples/s]Filter:  94%|█████████▍| 40000/42537 [00:06<00:00, 5969.37 examples/s]Filter:  96%|█████████▋| 41000/42537 [00:07<00:00, 5891.29 examples/s]/var/spool/slurm/slurmd.spool/job1851621/slurm_script: line 25: 375156 Bus error               (core dumped) python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt-350m" --epoch=4 --sft_epoch=5 --dataset="hh_poisoned" --per=0.05
END of SLURM commands
