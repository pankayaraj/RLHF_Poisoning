python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_sft.py --model="gpt2-large" --epoch=3 --dataset="hh_poisoned" --per=0.10
------
[<torch.cuda.device object at 0x7f48fbab9b10>, <torch.cuda.device object at 0x7f48fbab9b50>, <torch.cuda.device object at 0x7f48fbb0d510>, <torch.cuda.device object at 0x7f48513e4310>]
+++++++++++++++++++++++++++++++++++++++++++++++++++++++
==============================================================
{'loss': 2.2125, 'learning_rate': 4.8432994860223146e-05, 'epoch': 0.09}
{'loss': 2.084, 'learning_rate': 4.6865989720446284e-05, 'epoch': 0.19}
{'loss': 2.0336, 'learning_rate': 4.529898458066943e-05, 'epoch': 0.28}
{'loss': 2.0181, 'learning_rate': 4.3731979440892565e-05, 'epoch': 0.38}
{'loss': 1.9819, 'learning_rate': 4.216497430111571e-05, 'epoch': 0.47}
{'loss': 1.9516, 'learning_rate': 4.059796916133885e-05, 'epoch': 0.56}
{'loss': 1.9273, 'learning_rate': 3.9030964021562e-05, 'epoch': 0.66}
{'loss': 1.8867, 'learning_rate': 3.7463958881785134e-05, 'epoch': 0.75}
{'loss': 1.8695, 'learning_rate': 3.589695374200828e-05, 'epoch': 0.85}
{'loss': 1.8521, 'learning_rate': 3.4329948602231416e-05, 'epoch': 0.94}
{'loss': 1.685, 'learning_rate': 3.276294346245456e-05, 'epoch': 1.03}
{'loss': 1.4275, 'learning_rate': 3.11959383226777e-05, 'epoch': 1.13}
{'loss': 1.4191, 'learning_rate': 2.962893318290084e-05, 'epoch': 1.22}
{'loss': 1.4098, 'learning_rate': 2.8061928043123982e-05, 'epoch': 1.32}
{'loss': 1.3995, 'learning_rate': 2.6494922903347126e-05, 'epoch': 1.41}
{'loss': 1.3946, 'learning_rate': 2.4927917763570267e-05, 'epoch': 1.5}
{'loss': 1.3912, 'learning_rate': 2.3360912623793407e-05, 'epoch': 1.6}
{'loss': 1.3723, 'learning_rate': 2.1793907484016548e-05, 'epoch': 1.69}
{'loss': 1.3607, 'learning_rate': 2.022690234423969e-05, 'epoch': 1.79}
{'loss': 1.3427, 'learning_rate': 1.8659897204462833e-05, 'epoch': 1.88}
{'loss': 1.3421, 'learning_rate': 1.7092892064685973e-05, 'epoch': 1.97}
{'loss': 1.1218, 'learning_rate': 1.5525886924909114e-05, 'epoch': 2.07}
{'loss': 1.0336, 'learning_rate': 1.3958881785132255e-05, 'epoch': 2.16}
{'loss': 1.0251, 'learning_rate': 1.2391876645355397e-05, 'epoch': 2.26}
{'loss': 1.0169, 'learning_rate': 1.082487150557854e-05, 'epoch': 2.35}
{'loss': 1.0228, 'learning_rate': 9.25786636580168e-06, 'epoch': 2.44}
{'loss': 1.0164, 'learning_rate': 7.690861226024822e-06, 'epoch': 2.54}
{'loss': 1.0179, 'learning_rate': 6.123856086247963e-06, 'epoch': 2.63}
{'loss': 1.0155, 'learning_rate': 4.5568509464711046e-06, 'epoch': 2.73}
{'loss': 1.0051, 'learning_rate': 2.989845806694246e-06, 'epoch': 2.82}
{'loss': 0.9949, 'learning_rate': 1.4228406669173876e-06, 'epoch': 2.91}
{'train_runtime': 17122.9377, 'train_samples_per_second': 7.453, 'train_steps_per_second': 0.932, 'train_loss': 1.4589079548067148, 'epoch': 3.0}
END of SLURM commands
