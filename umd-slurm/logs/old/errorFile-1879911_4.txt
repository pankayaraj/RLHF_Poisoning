python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt-350m" --epoch=10 --sft_epoch=5 --dataset="hh_poisoned" --per=0.01
------
Some weights of OPTForSequenceClassification were not initialized from the model checkpoint at /cmlscratch/pan/RLHF_Poisoning/models/trained_sft/opt-350m_5_hh_poisoned_0.05 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/400 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/400 [03:00<19:59:29, 180.38s/it]  0%|          | 2/400 [05:48<19:09:35, 173.30s/it]  1%|          | 3/400 [08:33<18:41:26, 169.49s/it]  1%|          | 4/400 [11:15<18:19:29, 166.59s/it]  1%|▏         | 5/400 [13:58<18:08:23, 165.33s/it]  2%|▏         | 6/400 [16:46<18:11:31, 166.22s/it]  2%|▏         | 7/400 [19:33<18:09:20, 166.31s/it]  2%|▏         | 8/400 [22:18<18:05:04, 166.08s/it]  2%|▏         | 9/400 [25:00<17:52:12, 164.53s/it]  2%|▎         | 10/400 [27:45<17:52:03, 164.93s/it]  3%|▎         | 11/400 [30:25<17:39:26, 163.41s/it]  3%|▎         | 12/400 [33:00<17:19:34, 160.76s/it]  3%|▎         | 13/400 [35:36<17:08:24, 159.44s/it]  4%|▎         | 14/400 [38:20<17:14:04, 160.74s/it]  4%|▍         | 15/400 [41:05<17:19:02, 161.93s/it]  4%|▍         | 16/400 [43:45<17:13:36, 161.50s/it]  4%|▍         | 17/400 [46:15<16:47:56, 157.90s/it]  4%|▍         | 18/400 [49:03<17:04:14, 160.88s/it]  5%|▍         | 19/400 [51:38<16:50:53, 159.20s/it]  5%|▌         | 20/400 [54:22<16:56:39, 160.53s/it]  5%|▌         | 21/400 [57:03<16:54:54, 160.67s/it]  6%|▌         | 22/400 [59:45<16:55:09, 161.14s/it]  6%|▌         | 23/400 [1:02:32<17:03:36, 162.91s/it]  6%|▌         | 24/400 [1:05:07<16:46:12, 160.57s/it]  6%|▋         | 25/400 [1:07:52<16:51:29, 161.84s/it]  6%|▋         | 26/400 [1:10:34<16:49:05, 161.89s/it]  7%|▋         | 27/400 [1:13:14<16:43:15, 161.38s/it]  7%|▋         | 28/400 [1:15:55<16:39:05, 161.14s/it]  7%|▋         | 29/400 [1:18:43<16:50:00, 163.34s/it]  8%|▊         | 30/400 [1:21:22<16:39:30, 162.08s/it]  8%|▊         | 31/400 [1:24:06<16:39:01, 162.44s/it]  8%|▊         | 32/400 [1:26:49<16:38:35, 162.81s/it]  8%|▊         | 33/400 [1:29:36<16:42:37, 163.92s/it]  8%|▊         | 34/400 [1:32:14<16:29:33, 162.22s/it]  9%|▉         | 35/400 [1:34:59<16:32:22, 163.13s/it]  9%|▉         | 36/400 [1:37:36<16:17:33, 161.14s/it]  9%|▉         | 37/400 [1:40:15<16:10:57, 160.49s/it] 10%|▉         | 38/400 [1:42:56<16:09:55, 160.76s/it] 10%|▉         | 39/400 [1:45:36<16:06:33, 160.65s/it] 10%|█         | 40/400 [1:48:21<16:10:29, 161.75s/it] 10%|█         | 41/400 [1:50:57<15:58:35, 160.21s/it] 10%|█         | 42/400 [1:53:41<16:01:31, 161.15s/it] 11%|█         | 43/400 [1:56:21<15:57:04, 160.85s/it] 11%|█         | 44/400 [1:59:04<15:59:17, 161.68s/it] 11%|█▏        | 45/400 [2:01:46<15:55:54, 161.56s/it] 12%|█▏        | 46/400 [2:04:23<15:44:54, 160.15s/it] 12%|█▏        | 47/400 [2:07:03<15:43:06, 160.30s/it] 12%|█▏        | 48/400 [2:09:51<15:53:33, 162.54s/it] 12%|█▏        | 49/400 [2:12:36<15:54:37, 163.18s/it] 12%|█▎        | 50/400 [2:15:14<15:42:52, 161.64s/it] 13%|█▎        | 51/400 [2:17:58<15:44:08, 162.32s/it] 13%|█▎        | 52/400 [2:20:37<15:36:49, 161.52s/it] 13%|█▎        | 53/400 [2:23:21<15:37:04, 162.03s/it] 14%|█▎        | 54/400 [2:26:05<15:38:44, 162.79s/it] 14%|█▍        | 55/400 [2:28:45<15:31:32, 162.01s/it] 14%|█▍        | 56/400 [2:31:32<15:37:16, 163.48s/it] 14%|█▍        | 57/400 [2:34:17<15:37:07, 163.93s/it] 14%|█▍        | 58/400 [2:37:06<15:42:44, 165.39s/it] 15%|█▍        | 59/400 [2:39:42<15:23:25, 162.48s/it] 15%|█▌        | 60/400 [2:42:27<15:25:02, 163.24s/it] 15%|█▌        | 61/400 [2:45:07<15:17:38, 162.41s/it] 16%|█▌        | 62/400 [2:47:48<15:12:52, 162.05s/it] 16%|█▌        | 63/400 [2:50:30<15:08:46, 161.80s/it] 16%|█▌        | 64/400 [2:53:19<15:19:04, 164.12s/it] 16%|█▋        | 65/400 [2:55:58<15:07:59, 162.63s/it] 16%|█▋        | 66/400 [2:58:44<15:09:48, 163.44s/it] 17%|█▋        | 67/400 [3:01:23<14:59:58, 162.16s/it] 17%|█▋        | 68/400 [3:04:00<14:49:14, 160.71s/it] 17%|█▋        | 69/400 [3:06:49<15:00:53, 163.30s/it] 18%|█▊        | 70/400 [3:09:32<14:56:07, 162.93s/it] 18%|█▊        | 71/400 [3:12:14<14:52:50, 162.83s/it] 18%|█▊        | 72/400 [3:15:02<14:57:47, 164.23s/it] 18%|█▊        | 73/400 [3:17:38<14:42:42, 161.96s/it] 18%|█▊        | 74/400 [3:20:26<14:49:50, 163.77s/it] 19%|█▉        | 75/400 [3:23:11<14:48:31, 164.03s/it] 19%|█▉        | 76/400 [3:25:52<14:41:22, 163.22s/it] 19%|█▉        | 77/400 [3:28:33<14:34:42, 162.48s/it] 20%|█▉        | 78/400 [3:31:06<14:16:46, 159.65s/it] 20%|█▉        | 79/400 [3:33:52<14:24:21, 161.56s/it] 20%|██        | 80/400 [3:36:37<14:27:49, 162.72s/it] 20%|██        | 81/400 [3:39:08<14:05:04, 158.95s/it] 20%|██        | 82/400 [3:41:49<14:06:46, 159.77s/it] 21%|██        | 83/400 [3:44:31<14:06:24, 160.20s/it] 21%|██        | 84/400 [3:47:11<14:03:48, 160.22s/it] 21%|██▏       | 85/400 [3:49:59<14:13:43, 162.62s/it] 22%|██▏       | 86/400 [3:52:41<14:10:15, 162.47s/it] 22%|██▏       | 87/400 [3:55:23<14:06:32, 162.28s/it] 22%|██▏       | 88/400 [3:57:58<13:52:30, 160.10s/it] 22%|██▏       | 89/400 [4:00:39<13:50:51, 160.30s/it] 22%|██▎       | 90/400 [4:03:20<13:49:52, 160.62s/it] 23%|██▎       | 91/400 [4:05:55<13:38:17, 158.89s/it] 23%|██▎       | 92/400 [4:08:45<13:52:21, 162.15s/it] 23%|██▎       | 93/400 [4:11:28<13:51:10, 162.45s/it] 24%|██▎       | 94/400 [4:14:13<13:52:12, 163.18s/it] 24%|██▍       | 95/400 [4:16:50<13:39:43, 161.26s/it] 24%|██▍       | 96/400 [4:19:31<13:37:21, 161.32s/it] 24%|██▍       | 97/400 [4:22:11<13:32:36, 160.91s/it] 24%|██▍       | 98/400 [4:24:50<13:27:47, 160.49s/it] 25%|██▍       | 99/400 [4:27:32<13:26:13, 160.71s/it] 25%|██▌       | 100/400 [4:30:15<13:27:25, 161.49s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.01/checkpoint-100 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 25%|██▌       | 101/400 [4:33:01<13:31:39, 162.87s/it] 26%|██▌       | 102/400 [4:35:48<13:34:34, 164.01s/it] 26%|██▌       | 103/400 [4:38:30<13:28:35, 163.35s/it] 26%|██▌       | 104/400 [4:41:11<13:22:57, 162.76s/it] 26%|██▋       | 105/400 [4:43:52<13:17:04, 162.12s/it] 26%|██▋       | 106/400 [4:46:33<13:14:03, 162.05s/it] 27%|██▋       | 107/400 [4:49:18<13:14:30, 162.70s/it] 27%|██▋       | 108/400 [4:52:00<13:11:58, 162.73s/it] 27%|██▋       | 109/400 [4:54:42<13:07:44, 162.42s/it] 28%|██▊       | 110/400 [4:57:15<12:51:17, 159.58s/it] 28%|██▊       | 111/400 [4:59:56<12:49:56, 159.85s/it] 28%|██▊       | 112/400 [5:02:43<12:58:40, 162.22s/it] 28%|██▊       | 113/400 [5:05:24<12:53:57, 161.80s/it] 28%|██▊       | 114/400 [5:08:14<13:02:55, 164.25s/it] 29%|██▉       | 115/400 [5:10:51<12:50:14, 162.16s/it] 29%|██▉       | 116/400 [5:13:35<12:49:13, 162.51s/it] 29%|██▉       | 117/400 [5:16:16<12:44:03, 161.99s/it] 30%|██▉       | 118/400 [5:18:52<12:33:20, 160.29s/it] 30%|██▉       | 119/400 [5:21:33<12:31:42, 160.51s/it] 30%|███       | 120/400 [5:24:22<12:40:44, 163.02s/it] 30%|███       | 121/400 [5:27:06<12:39:06, 163.25s/it] 30%|███       | 122/400 [5:29:55<12:44:28, 164.99s/it] 31%|███       | 123/400 [5:32:41<12:43:28, 165.37s/it] 31%|███       | 124/400 [5:35:25<12:38:38, 164.92s/it] 31%|███▏      | 125/400 [5:38:07<12:31:55, 164.05s/it] 32%|███▏      | 126/400 [5:40:47<12:24:25, 163.01s/it] 32%|███▏      | 127/400 [5:43:23<12:12:11, 160.92s/it] 32%|███▏      | 128/400 [5:46:09<12:15:28, 162.24s/it] 32%|███▏      | 129/400 [5:48:52<12:13:34, 162.42s/it] 32%|███▎      | 130/400 [5:51:32<12:08:04, 161.79s/it] 33%|███▎      | 131/400 [5:54:16<12:08:58, 162.60s/it] 33%|███▎      | 132/400 [5:56:59<12:05:44, 162.48s/it] 33%|███▎      | 133/400 [5:59:46<12:09:10, 163.86s/it] 34%|███▎      | 134/400 [6:02:35<12:13:15, 165.40s/it] 34%|███▍      | 135/400 [6:05:18<12:08:07, 164.86s/it] 34%|███▍      | 136/400 [6:08:02<12:04:00, 164.55s/it] 34%|███▍      | 137/400 [6:10:45<11:59:50, 164.22s/it] 34%|███▍      | 138/400 [6:13:26<11:52:54, 163.26s/it] 35%|███▍      | 139/400 [6:16:14<11:55:27, 164.47s/it] 35%|███▌      | 140/400 [6:18:57<11:50:49, 164.04s/it] 35%|███▌      | 141/400 [6:21:39<11:46:19, 163.63s/it] 36%|███▌      | 142/400 [6:24:22<11:41:34, 163.16s/it] 36%|███▌      | 143/400 [6:27:05<11:39:32, 163.32s/it] 36%|███▌      | 144/400 [6:29:44<11:30:46, 161.90s/it] 36%|███▋      | 145/400 [6:32:23<11:24:50, 161.14s/it] 36%|███▋      | 146/400 [6:35:09<11:27:31, 162.41s/it] 37%|███▋      | 147/400 [6:37:49<11:22:30, 161.86s/it] 37%|███▋      | 148/400 [6:40:36<11:25:45, 163.28s/it] 37%|███▋      | 149/400 [6:43:16<11:19:38, 162.46s/it] 38%|███▊      | 150/400 [6:45:58<11:15:52, 162.21s/it] 38%|███▊      | 151/400 [6:48:41<11:14:04, 162.43s/it] 38%|███▊      | 152/400 [6:51:22<11:09:23, 161.95s/it] 38%|███▊      | 153/400 [6:54:04<11:07:18, 162.10s/it] 38%|███▊      | 154/400 [6:56:42<10:58:53, 160.70s/it] 39%|███▉      | 155/400 [6:59:25<10:59:13, 161.44s/it] 39%|███▉      | 156/400 [7:02:02<10:51:26, 160.19s/it] 39%|███▉      | 157/400 [7:04:41<10:47:55, 159.98s/it] 40%|███▉      | 158/400 [7:07:26<10:50:51, 161.37s/it] 40%|███▉      | 159/400 [7:10:07<10:48:00, 161.33s/it] 40%|████      | 160/400 [7:12:45<10:41:20, 160.34s/it] 40%|████      | 161/400 [7:15:22<10:33:46, 159.11s/it] 40%|████      | 162/400 [7:18:05<10:36:00, 160.34s/it] 41%|████      | 163/400 [7:20:55<10:45:16, 163.36s/it] 41%|████      | 164/400 [7:23:32<10:35:06, 161.47s/it] 41%|████▏     | 165/400 [7:26:15<10:33:40, 161.79s/it] 42%|████▏     | 166/400 [7:28:51<10:24:13, 160.06s/it] 42%|████▏     | 167/400 [7:31:34<10:25:34, 161.09s/it] 42%|████▏     | 168/400 [7:34:17<10:24:33, 161.52s/it] 42%|████▏     | 169/400 [7:37:00<10:24:08, 162.11s/it] 42%|████▎     | 170/400 [7:39:42<10:21:10, 162.05s/it] 43%|████▎     | 171/400 [7:42:23<10:16:52, 161.62s/it] 43%|████▎     | 172/400 [7:45:05<10:14:25, 161.69s/it] 43%|████▎     | 173/400 [7:47:47<10:12:29, 161.89s/it] 44%|████▎     | 174/400 [7:50:34<10:15:49, 163.49s/it] 44%|████▍     | 175/400 [7:53:17<10:12:11, 163.25s/it] 44%|████▍     | 176/400 [7:55:56<10:04:50, 162.01s/it] 44%|████▍     | 177/400 [7:58:37<10:00:59, 161.70s/it] 44%|████▍     | 178/400 [8:01:20<10:00:04, 162.18s/it] 45%|████▍     | 179/400 [8:03:59<9:53:55, 161.25s/it]  45%|████▌     | 180/400 [8:06:37<9:46:40, 160.00s/it] 45%|████▌     | 181/400 [8:09:17<9:44:19, 160.09s/it] 46%|████▌     | 182/400 [8:11:56<9:40:12, 159.69s/it] 46%|████▌     | 183/400 [8:14:41<9:43:23, 161.31s/it] 46%|████▌     | 184/400 [8:17:26<9:45:15, 162.57s/it] 46%|████▋     | 185/400 [8:20:07<9:40:42, 162.06s/it] 46%|████▋     | 186/400 [8:22:51<9:40:22, 162.72s/it] 47%|████▋     | 187/400 [8:25:32<9:35:51, 162.22s/it] 47%|████▋     | 188/400 [8:28:19<9:37:44, 163.51s/it] 47%|████▋     | 189/400 [8:30:58<9:30:50, 162.32s/it] 48%|████▊     | 190/400 [8:33:39<9:26:39, 161.90s/it] 48%|████▊     | 191/400 [8:36:20<9:22:37, 161.52s/it] 48%|████▊     | 192/400 [8:38:56<9:14:07, 159.84s/it] 48%|████▊     | 193/400 [8:41:37<9:12:43, 160.21s/it] 48%|████▊     | 194/400 [8:44:18<9:11:05, 160.51s/it] 49%|████▉     | 195/400 [8:47:06<9:15:25, 162.56s/it] 49%|████▉     | 196/400 [8:49:44<9:08:55, 161.45s/it] 49%|████▉     | 197/400 [8:52:24<9:03:55, 160.76s/it] 50%|████▉     | 198/400 [8:55:13<9:09:38, 163.26s/it] 50%|████▉     | 199/400 [8:57:59<9:09:55, 164.16s/it] 50%|█████     | 200/400 [9:00:45<9:09:09, 164.75s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.01/checkpoint-200 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 50%|█████     | 201/400 [9:03:40<9:16:49, 167.89s/it] 50%|█████     | 202/400 [9:06:20<9:05:48, 165.40s/it] 51%|█████     | 203/400 [9:09:01<8:59:03, 164.18s/it] 51%|█████     | 204/400 [9:11:46<8:57:05, 164.41s/it] 51%|█████▏    | 205/400 [9:14:28<8:52:12, 163.76s/it] 52%|█████▏    | 206/400 [9:17:06<8:43:04, 161.78s/it] 52%|█████▏    | 207/400 [9:19:51<8:44:22, 163.02s/it] 52%|█████▏    | 208/400 [9:22:32<8:39:30, 162.35s/it] 52%|█████▏    | 209/400 [9:25:17<8:38:44, 162.96s/it] 52%|█████▎    | 210/400 [9:28:00<8:36:24, 163.08s/it] 53%|█████▎    | 211/400 [9:30:50<8:40:09, 165.13s/it] 53%|█████▎    | 212/400 [9:33:26<8:29:22, 162.57s/it] 53%|█████▎    | 213/400 [9:36:00<8:18:13, 159.86s/it] 54%|█████▎    | 214/400 [9:38:45<8:20:12, 161.36s/it] 54%|█████▍    | 215/400 [9:41:22<8:13:49, 160.16s/it] 54%|█████▍    | 216/400 [9:44:09<8:16:48, 162.00s/it] 54%|█████▍    | 217/400 [9:46:43<8:07:00, 159.68s/it] 55%|█████▍    | 218/400 [9:49:30<8:11:25, 162.01s/it] 55%|█████▍    | 219/400 [9:52:08<8:05:18, 160.88s/it] 55%|█████▌    | 220/400 [9:54:49<8:02:30, 160.84s/it] 55%|█████▌    | 221/400 [9:57:39<8:08:13, 163.65s/it] 56%|█████▌    | 222/400 [10:00:20<8:03:00, 162.81s/it] 56%|█████▌    | 223/400 [10:03:04<8:01:31, 163.23s/it] 56%|█████▌    | 224/400 [10:05:43<7:54:49, 161.87s/it] 56%|█████▋    | 225/400 [10:08:23<7:50:09, 161.19s/it] 56%|█████▋    | 226/400 [10:11:08<7:50:37, 162.29s/it] 57%|█████▋    | 227/400 [10:13:56<7:52:53, 164.01s/it] 57%|█████▋    | 228/400 [10:16:41<7:51:00, 164.31s/it] 57%|█████▋    | 229/400 [10:19:17<7:41:12, 161.83s/it] 57%|█████▊    | 230/400 [10:22:00<7:39:44, 162.26s/it] 58%|█████▊    | 231/400 [10:24:35<7:30:44, 160.03s/it] 58%|█████▊    | 232/400 [10:27:23<7:34:43, 162.40s/it] 58%|█████▊    | 233/400 [10:30:08<7:34:38, 163.35s/it] 58%|█████▊    | 234/400 [10:32:51<7:31:06, 163.05s/it] 59%|█████▉    | 235/400 [10:35:33<7:27:53, 162.87s/it] 59%|█████▉    | 236/400 [10:38:17<7:25:59, 163.17s/it] 59%|█████▉    | 237/400 [10:41:03<7:25:54, 164.14s/it] 60%|█████▉    | 238/400 [10:43:43<7:19:50, 162.90s/it] 60%|█████▉    | 239/400 [10:46:23<7:14:23, 161.89s/it] 60%|██████    | 240/400 [10:49:04<7:10:59, 161.62s/it] 60%|██████    | 241/400 [10:51:48<7:10:34, 162.48s/it] 60%|██████    | 242/400 [10:54:32<7:08:23, 162.68s/it] 61%|██████    | 243/400 [10:57:14<7:05:41, 162.68s/it] 61%|██████    | 244/400 [10:59:57<7:02:57, 162.68s/it] 61%|██████▏   | 245/400 [11:02:33<6:54:46, 160.56s/it] 62%|██████▏   | 246/400 [11:05:09<6:49:00, 159.35s/it] 62%|██████▏   | 247/400 [11:07:55<6:51:07, 161.23s/it] 62%|██████▏   | 248/400 [11:10:40<6:51:47, 162.55s/it] 62%|██████▏   | 249/400 [11:13:30<6:54:19, 164.63s/it] 62%|██████▎   | 250/400 [11:16:08<6:46:50, 162.74s/it] 63%|██████▎   | 251/400 [11:18:48<6:41:41, 161.76s/it] 63%|██████▎   | 252/400 [11:21:36<6:44:11, 163.86s/it] 63%|██████▎   | 253/400 [11:24:21<6:42:24, 164.25s/it] 64%|██████▎   | 254/400 [11:27:01<6:36:09, 162.81s/it] 64%|██████▍   | 255/400 [11:29:42<6:32:14, 162.31s/it] 64%|██████▍   | 256/400 [11:32:27<6:31:21, 163.07s/it] 64%|██████▍   | 257/400 [11:35:11<6:29:22, 163.37s/it] 64%|██████▍   | 258/400 [11:37:52<6:25:12, 162.77s/it] 65%|██████▍   | 259/400 [11:40:30<6:19:00, 161.28s/it] 65%|██████▌   | 260/400 [11:43:11<6:16:04, 161.17s/it] 65%|██████▌   | 261/400 [11:45:55<6:15:01, 161.88s/it] 66%|██████▌   | 262/400 [11:48:37<6:12:22, 161.90s/it] 66%|██████▌   | 263/400 [11:51:30<6:17:15, 165.22s/it] 66%|██████▌   | 264/400 [11:54:15<6:14:53, 165.39s/it] 66%|██████▋   | 265/400 [11:56:48<6:03:49, 161.70s/it] 66%|██████▋   | 266/400 [11:59:41<6:08:15, 164.89s/it] 67%|██████▋   | 267/400 [12:02:23<6:03:48, 164.12s/it] 67%|██████▋   | 268/400 [12:05:03<5:58:00, 162.73s/it] 67%|██████▋   | 269/400 [12:07:43<5:54:02, 162.15s/it] 68%|██████▊   | 270/400 [12:10:28<5:53:09, 163.00s/it] 68%|██████▊   | 271/400 [12:13:09<5:48:52, 162.27s/it] 68%|██████▊   | 272/400 [12:15:45<5:41:58, 160.30s/it] 68%|██████▊   | 273/400 [12:18:27<5:40:39, 160.94s/it] 68%|██████▊   | 274/400 [12:21:08<5:38:13, 161.06s/it] 69%|██████▉   | 275/400 [12:23:54<5:38:24, 162.44s/it] 69%|██████▉   | 276/400 [12:26:34<5:34:11, 161.70s/it] 69%|██████▉   | 277/400 [12:29:16<5:31:35, 161.75s/it] 70%|██████▉   | 278/400 [12:31:58<5:29:00, 161.81s/it] 70%|██████▉   | 279/400 [12:34:41<5:27:17, 162.30s/it] 70%|███████   | 280/400 [12:37:24<5:25:07, 162.56s/it] 70%|███████   | 281/400 [12:39:55<5:15:26, 159.04s/it] 70%|███████   | 282/400 [12:42:43<5:17:44, 161.56s/it] 71%|███████   | 283/400 [12:45:21<5:12:50, 160.43s/it] 71%|███████   | 284/400 [12:48:01<5:09:54, 160.30s/it] 71%|███████▏  | 285/400 [12:50:41<5:07:19, 160.35s/it] 72%|███████▏  | 286/400 [12:53:24<5:06:16, 161.20s/it] 72%|███████▏  | 287/400 [12:56:09<5:05:50, 162.40s/it] 72%|███████▏  | 288/400 [12:58:50<5:01:55, 161.74s/it] 72%|███████▏  | 289/400 [13:01:29<4:57:57, 161.06s/it] 72%|███████▎  | 290/400 [13:04:11<4:55:36, 161.24s/it] 73%|███████▎  | 291/400 [13:06:50<4:51:50, 160.65s/it] 73%|███████▎  | 292/400 [13:09:26<4:46:54, 159.40s/it] 73%|███████▎  | 293/400 [13:12:06<4:44:19, 159.44s/it] 74%|███████▎  | 294/400 [13:14:51<4:44:25, 161.00s/it] 74%|███████▍  | 295/400 [13:17:42<4:47:23, 164.22s/it] 74%|███████▍  | 296/400 [13:20:29<4:45:43, 164.84s/it] 74%|███████▍  | 297/400 [13:23:15<4:43:38, 165.22s/it] 74%|███████▍  | 298/400 [13:25:59<4:40:17, 164.87s/it] 75%|███████▍  | 299/400 [13:28:45<4:38:17, 165.32s/it] 75%|███████▌  | 300/400 [13:31:29<4:34:45, 164.86s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.01/checkpoint-300 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 75%|███████▌  | 301/400 [13:34:16<4:33:07, 165.53s/it] 76%|███████▌  | 302/400 [13:36:53<4:26:23, 163.09s/it] 76%|███████▌  | 303/400 [13:39:32<4:21:31, 161.77s/it] 76%|███████▌  | 304/400 [13:42:13<4:18:16, 161.42s/it] 76%|███████▋  | 305/400 [13:44:59<4:17:56, 162.91s/it] 76%|███████▋  | 306/400 [13:47:36<4:12:30, 161.17s/it] 77%|███████▋  | 307/400 [13:50:16<4:09:12, 160.78s/it] 77%|███████▋  | 308/400 [13:52:59<4:07:43, 161.56s/it] 77%|███████▋  | 309/400 [13:55:45<4:06:55, 162.81s/it] 78%|███████▊  | 310/400 [13:58:28<4:04:25, 162.95s/it] 78%|███████▊  | 311/400 [14:01:10<4:01:14, 162.64s/it] 78%|███████▊  | 312/400 [14:03:50<3:57:08, 161.69s/it] 78%|███████▊  | 313/400 [14:06:34<3:55:21, 162.32s/it] 78%|███████▊  | 314/400 [14:09:25<3:56:19, 164.88s/it] 79%|███████▉  | 315/400 [14:12:09<3:53:13, 164.63s/it] 79%|███████▉  | 316/400 [14:14:40<3:44:52, 160.63s/it] 79%|███████▉  | 317/400 [14:17:19<3:41:29, 160.12s/it] 80%|███████▉  | 318/400 [14:19:59<3:38:44, 160.06s/it] 80%|███████▉  | 319/400 [14:22:34<3:34:09, 158.63s/it] 80%|████████  | 320/400 [14:25:16<3:32:58, 159.73s/it] 80%|████████  | 321/400 [14:27:58<3:31:01, 160.27s/it] 80%|████████  | 322/400 [14:30:45<3:31:10, 162.45s/it] 81%|████████  | 323/400 [14:33:19<3:25:15, 159.94s/it] 81%|████████  | 324/400 [14:36:04<3:24:09, 161.18s/it] 81%|████████▏ | 325/400 [14:38:46<3:22:03, 161.64s/it] 82%|████████▏ | 326/400 [14:41:21<3:16:52, 159.62s/it] 82%|████████▏ | 327/400 [14:43:56<3:12:32, 158.25s/it] 82%|████████▏ | 328/400 [14:46:34<3:09:35, 157.99s/it] 82%|████████▏ | 329/400 [14:49:12<3:07:09, 158.17s/it] 82%|████████▎ | 330/400 [14:51:59<3:07:39, 160.85s/it] 83%|████████▎ | 331/400 [14:54:39<3:04:26, 160.39s/it] 83%|████████▎ | 332/400 [14:57:22<3:02:56, 161.42s/it] 83%|████████▎ | 333/400 [15:00:01<2:59:24, 160.66s/it] 84%|████████▎ | 334/400 [15:02:46<2:57:53, 161.72s/it] 84%|████████▍ | 335/400 [15:05:31<2:56:30, 162.93s/it] 84%|████████▍ | 336/400 [15:08:17<2:54:34, 163.67s/it] 84%|████████▍ | 337/400 [15:10:56<2:50:34, 162.46s/it] 84%|████████▍ | 338/400 [15:13:45<2:49:39, 164.19s/it] 85%|████████▍ | 339/400 [15:16:22<2:44:56, 162.24s/it] 85%|████████▌ | 340/400 [15:19:07<2:43:03, 163.07s/it] 85%|████████▌ | 341/400 [15:21:51<2:40:27, 163.18s/it] 86%|████████▌ | 342/400 [15:24:34<2:37:54, 163.35s/it] 86%|████████▌ | 343/400 [15:27:18<2:35:10, 163.34s/it] 86%|████████▌ | 344/400 [15:30:05<2:33:25, 164.38s/it] 86%|████████▋ | 345/400 [15:32:51<2:31:15, 165.00s/it] 86%|████████▋ | 346/400 [15:35:35<2:28:19, 164.81s/it] 87%|████████▋ | 347/400 [15:38:24<2:26:43, 166.10s/it] 87%|████████▋ | 348/400 [15:41:07<2:22:58, 164.97s/it] 87%|████████▋ | 349/400 [15:43:58<2:21:46, 166.78s/it] 88%|████████▊ | 350/400 [15:46:39<2:17:38, 165.17s/it] 88%|████████▊ | 351/400 [15:49:15<2:12:32, 162.29s/it] 88%|████████▊ | 352/400 [15:51:57<2:09:42, 162.14s/it] 88%|████████▊ | 353/400 [15:54:39<2:07:00, 162.13s/it] 88%|████████▊ | 354/400 [15:57:22<2:04:35, 162.52s/it] 89%|████████▉ | 355/400 [16:00:04<2:01:40, 162.23s/it] 89%|████████▉ | 356/400 [16:02:46<1:59:04, 162.38s/it] 89%|████████▉ | 357/400 [16:05:33<1:57:18, 163.69s/it] 90%|████████▉ | 358/400 [16:08:19<1:55:00, 164.29s/it] 90%|████████▉ | 359/400 [16:10:58<1:51:11, 162.71s/it] 90%|█████████ | 360/400 [16:13:42<1:48:42, 163.06s/it] 90%|█████████ | 361/400 [16:16:24<1:45:46, 162.72s/it] 90%|█████████ | 362/400 [16:19:07<1:43:10, 162.92s/it] 91%|█████████ | 363/400 [16:21:47<1:39:52, 161.95s/it] 91%|█████████ | 364/400 [16:24:30<1:37:22, 162.28s/it] 91%|█████████▏| 365/400 [16:27:14<1:34:56, 162.76s/it] 92%|█████████▏| 366/400 [16:29:53<1:31:37, 161.70s/it] 92%|█████████▏| 367/400 [16:32:35<1:28:55, 161.69s/it] 92%|█████████▏| 368/400 [16:35:17<1:26:21, 161.92s/it] 92%|█████████▏| 369/400 [16:38:02<1:24:09, 162.87s/it] 92%|█████████▎| 370/400 [16:40:53<1:22:38, 165.29s/it] 93%|█████████▎| 371/400 [16:43:34<1:19:16, 164.03s/it] 93%|█████████▎| 372/400 [16:46:18<1:16:32, 164.03s/it] 93%|█████████▎| 373/400 [16:49:03<1:13:52, 164.18s/it] 94%|█████████▎| 374/400 [16:51:47<1:11:11, 164.29s/it] 94%|█████████▍| 375/400 [16:54:22<1:07:13, 161.35s/it] 94%|█████████▍| 376/400 [16:57:05<1:04:44, 161.83s/it] 94%|█████████▍| 377/400 [16:59:47<1:02:06, 162.04s/it] 94%|█████████▍| 378/400 [17:02:27<59:11, 161.41s/it]   95%|█████████▍| 379/400 [17:05:10<56:39, 161.86s/it] 95%|█████████▌| 380/400 [17:07:56<54:22, 163.11s/it] 95%|█████████▌| 381/400 [17:10:42<51:57, 164.06s/it] 96%|█████████▌| 382/400 [17:13:22<48:48, 162.68s/it] 96%|█████████▌| 383/400 [17:15:59<45:35, 160.93s/it] 96%|█████████▌| 384/400 [17:18:46<43:23, 162.72s/it] 96%|█████████▋| 385/400 [17:21:32<40:56, 163.77s/it] 96%|█████████▋| 386/400 [17:24:10<37:49, 162.13s/it] 97%|█████████▋| 387/400 [17:26:45<34:39, 159.96s/it] 97%|█████████▋| 388/400 [17:29:30<32:19, 161.60s/it] 97%|█████████▋| 389/400 [17:32:11<29:35, 161.43s/it] 98%|█████████▊| 390/400 [17:34:57<27:05, 162.54s/it] 98%|█████████▊| 391/400 [17:37:36<24:14, 161.64s/it] 98%|█████████▊| 392/400 [17:40:18<21:32, 161.58s/it] 98%|█████████▊| 393/400 [17:43:02<18:56, 162.33s/it] 98%|█████████▊| 394/400 [17:45:53<16:30, 165.02s/it] 99%|█████████▉| 395/400 [17:48:35<13:40, 164.04s/it] 99%|█████████▉| 396/400 [17:51:21<10:58, 164.73s/it] 99%|█████████▉| 397/400 [17:53:59<08:08, 162.74s/it]100%|█████████▉| 398/400 [17:56:39<05:23, 161.74s/it]100%|█████████▉| 399/400 [17:59:20<02:41, 161.52s/it]100%|██████████| 400/400 [18:02:04<00:00, 162.41s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.01/checkpoint-400 already exists and is non-empty.Saving will proceed but saved results may be invalid.
                                                     100%|██████████| 400/400 [18:02:16<00:00, 162.41s/it]100%|██████████| 400/400 [18:02:16<00:00, 162.34s/it]
END of SLURM commands
