python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt-350m" --epoch=10 --sft_epoch=5 --dataset="hh_poisoned" --per=0.005
------
Some weights of OPTForSequenceClassification were not initialized from the model checkpoint at /cmlscratch/pan/RLHF_Poisoning/models/trained_sft/opt-350m_5_hh_poisoned_0.05 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map (num_proc=4):   0%|          | 0/42537 [00:00<?, ? examples/s]Map (num_proc=4):   2%|▏         | 1000/42537 [00:02<01:49, 381.01 examples/s]Map (num_proc=4):  12%|█▏        | 5000/42537 [00:05<00:35, 1053.05 examples/s]Map (num_proc=4):  19%|█▉        | 8000/42537 [00:05<00:18, 1914.34 examples/s]Map (num_proc=4):  21%|██        | 9000/42537 [00:07<00:29, 1119.29 examples/s]Map (num_proc=4):  28%|██▊       | 12000/42537 [00:08<00:15, 1925.49 examples/s]Map (num_proc=4):  33%|███▎      | 14000/42537 [00:10<00:20, 1374.31 examples/s]Map (num_proc=4):  38%|███▊      | 16000/42537 [00:10<00:14, 1813.01 examples/s]Map (num_proc=4):  40%|███▉      | 17000/42537 [00:13<00:21, 1188.10 examples/s]Map (num_proc=4):  45%|████▍     | 19000/42537 [00:13<00:13, 1712.67 examples/s]Map (num_proc=4):  47%|████▋     | 20000/42537 [00:13<00:11, 1932.73 examples/s]Map (num_proc=4):  49%|████▉     | 21000/42537 [00:15<00:18, 1133.80 examples/s]Map (num_proc=4):  52%|█████▏    | 22000/42537 [00:15<00:14, 1398.98 examples/s]Map (num_proc=4):  56%|█████▋    | 24000/42537 [00:16<00:09, 2025.39 examples/s]Map (num_proc=4):  59%|█████▉    | 25000/42537 [00:18<00:14, 1179.65 examples/s]Map (num_proc=4):  61%|██████    | 26000/42537 [00:18<00:12, 1377.42 examples/s]Map (num_proc=4):  66%|██████▌   | 28000/42537 [00:18<00:07, 2030.74 examples/s]Map (num_proc=4):  68%|██████▊   | 29000/42537 [00:20<00:11, 1188.50 examples/s]Map (num_proc=4):  71%|███████   | 30000/42537 [00:21<00:08, 1472.54 examples/s]Map (num_proc=4):  75%|███████▌  | 32000/42537 [00:21<00:05, 2083.56 examples/s]Map (num_proc=4):  78%|███████▊  | 33000/42537 [00:23<00:08, 1169.37 examples/s]Map (num_proc=4):  80%|███████▉  | 34000/42537 [00:23<00:05, 1484.17 examples/s]Map (num_proc=4):  82%|████████▏ | 35000/42537 [00:23<00:04, 1830.90 examples/s]Map (num_proc=4):  85%|████████▍ | 36000/42537 [00:24<00:03, 2112.83 examples/s]Map (num_proc=4):  87%|████████▋ | 37000/42537 [00:26<00:05, 1073.65 examples/s]Map (num_proc=4):  89%|████████▉ | 38000/42537 [00:26<00:03, 1389.24 examples/s]Map (num_proc=4):  92%|█████████▏| 39000/42537 [00:26<00:01, 1818.90 examples/s]Map (num_proc=4):  94%|█████████▍| 40000/42537 [00:26<00:01, 2047.61 examples/s]Map (num_proc=4):  96%|█████████▌| 40634/42537 [00:28<00:01, 1331.97 examples/s]Map (num_proc=4):  97%|█████████▋| 41268/42537 [00:28<00:00, 1620.53 examples/s]Map (num_proc=4): 100%|██████████| 42537/42537 [00:28<00:00, 2352.64 examples/s]Map (num_proc=4): 100%|██████████| 42537/42537 [00:28<00:00, 1492.12 examples/s]
Filter:   0%|          | 0/42537 [00:00<?, ? examples/s]Filter:   2%|▏         | 1000/42537 [00:00<00:08, 4616.71 examples/s]Filter:   5%|▍         | 2000/42537 [00:00<00:07, 5221.00 examples/s]Filter:   7%|▋         | 3000/42537 [00:00<00:07, 5394.93 examples/s]Filter:   9%|▉         | 4000/42537 [00:00<00:06, 5563.93 examples/s]Filter:  12%|█▏        | 5000/42537 [00:00<00:06, 5721.64 examples/s]Filter:  14%|█▍        | 6000/42537 [00:01<00:06, 5667.99 examples/s]Filter:  16%|█▋        | 7000/42537 [00:01<00:06, 5625.26 examples/s]Filter:  19%|█▉        | 8000/42537 [00:01<00:06, 5621.07 examples/s]Filter:  21%|██        | 9000/42537 [00:01<00:05, 5598.93 examples/s]Filter:  24%|██▎       | 10000/42537 [00:01<00:05, 5603.21 examples/s]Filter:  26%|██▌       | 11000/42537 [00:01<00:05, 5583.07 examples/s]Filter:  28%|██▊       | 12000/42537 [00:02<00:05, 5636.08 examples/s]Filter:  31%|███       | 13000/42537 [00:02<00:05, 5659.84 examples/s]Filter:  33%|███▎      | 14000/42537 [00:02<00:05, 5666.98 examples/s]Filter:  35%|███▌      | 15000/42537 [00:02<00:04, 5697.56 examples/s]Filter:  38%|███▊      | 16000/42537 [00:02<00:04, 5742.66 examples/s]Filter:  40%|███▉      | 17000/42537 [00:03<00:04, 5779.49 examples/s]Filter:  42%|████▏     | 18000/42537 [00:03<00:04, 5757.76 examples/s]Filter:  45%|████▍     | 19000/42537 [00:03<00:04, 5660.69 examples/s]Filter:  47%|████▋     | 20000/42537 [00:03<00:04, 5556.87 examples/s]Filter:  49%|████▉     | 21000/42537 [00:03<00:03, 5596.50 examples/s]Filter:  52%|█████▏    | 22000/42537 [00:03<00:03, 5474.11 examples/s]Filter:  54%|█████▍    | 23000/42537 [00:04<00:03, 5503.95 examples/s]Filter:  56%|█████▋    | 24000/42537 [00:04<00:03, 5516.42 examples/s]Filter:  59%|█████▉    | 25000/42537 [00:04<00:03, 5440.17 examples/s]/var/spool/slurm/slurmd.spool/job1865341/slurm_script: line 25: 819034 Bus error               (core dumped) python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt-350m" --epoch=10 --sft_epoch=5 --dataset="hh_poisoned" --per=0.005
END of SLURM commands
