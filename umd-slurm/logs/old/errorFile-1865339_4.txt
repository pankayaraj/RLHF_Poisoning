python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="gpt2-large" --epoch=10 --sft_epoch=3 --dataset="hh_poisoned" --per=0.01
------
Some weights of GPT2ForSequenceClassification were not initialized from the model checkpoint at /cmlscratch/pan/RLHF_Poisoning/models/trained_sft/gpt2-large_3_hh_poisoned_0.05 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/400 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
Could not estimate the number of tokens of the input, floating-point operations will not be computed
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 1/400 [06:42<44:39:05, 402.87s/it]  0%|          | 2/400 [13:35<45:09:07, 408.41s/it]  1%|          | 3/400 [20:18<44:46:44, 406.06s/it]  1%|          | 4/400 [26:59<44:26:56, 404.08s/it]  1%|▏         | 5/400 [33:56<44:50:39, 408.71s/it]  2%|▏         | 6/400 [40:34<44:20:01, 405.08s/it]  2%|▏         | 7/400 [47:02<43:35:53, 399.37s/it]  2%|▏         | 8/400 [53:45<43:38:23, 400.77s/it]  2%|▏         | 9/400 [1:00:10<42:59:15, 395.79s/it]  2%|▎         | 10/400 [1:06:46<42:53:18, 395.89s/it]  3%|▎         | 11/400 [1:13:27<42:56:02, 397.33s/it]  3%|▎         | 12/400 [1:19:53<42:27:16, 393.91s/it]  3%|▎         | 13/400 [1:26:17<42:01:19, 390.90s/it]  4%|▎         | 14/400 [1:32:56<42:10:37, 393.36s/it]  4%|▍         | 15/400 [1:39:35<42:14:06, 394.92s/it]  4%|▍         | 16/400 [1:46:08<42:04:56, 394.52s/it]  4%|▍         | 17/400 [1:52:47<42:07:00, 395.88s/it]  4%|▍         | 18/400 [1:59:29<42:12:12, 397.73s/it]  5%|▍         | 19/400 [2:06:05<42:02:39, 397.27s/it]  5%|▌         | 20/400 [2:12:43<41:56:41, 397.37s/it]  5%|▌         | 21/400 [2:18:48<40:48:07, 387.57s/it]  6%|▌         | 22/400 [2:25:10<40:31:54, 386.02s/it]  6%|▌         | 23/400 [2:32:02<41:13:52, 393.72s/it]  6%|▌         | 24/400 [2:38:40<41:15:13, 394.98s/it]  6%|▋         | 25/400 [2:45:02<40:44:22, 391.10s/it]  6%|▋         | 26/400 [2:51:52<41:14:07, 396.92s/it]  7%|▋         | 27/400 [2:58:23<40:55:46, 395.03s/it]  7%|▋         | 28/400 [3:04:51<40:35:47, 392.87s/it]  7%|▋         | 29/400 [3:11:22<40:25:30, 392.27s/it]  8%|▊         | 30/400 [3:17:58<40:26:58, 393.56s/it]  8%|▊         | 31/400 [3:24:37<40:29:50, 395.10s/it]  8%|▊         | 32/400 [3:31:13<40:24:54, 395.37s/it]  8%|▊         | 33/400 [3:37:59<40:39:00, 398.75s/it]  8%|▊         | 34/400 [3:44:26<40:09:42, 395.03s/it]  9%|▉         | 35/400 [3:50:50<39:43:21, 391.79s/it]  9%|▉         | 36/400 [3:57:32<39:55:52, 394.92s/it]  9%|▉         | 37/400 [4:03:50<39:17:38, 389.69s/it] 10%|▉         | 38/400 [4:10:12<38:57:14, 387.39s/it] 10%|▉         | 39/400 [4:16:43<38:57:23, 388.49s/it] 10%|█         | 40/400 [4:23:25<39:15:43, 392.62s/it] 10%|█         | 41/400 [4:30:00<39:13:29, 393.34s/it] 10%|█         | 42/400 [4:36:38<39:15:08, 394.72s/it] 11%|█         | 43/400 [4:43:27<39:34:40, 399.10s/it] 11%|█         | 44/400 [4:49:51<39:01:17, 394.60s/it] 11%|█▏        | 45/400 [4:56:29<38:59:47, 395.46s/it] 12%|█▏        | 46/400 [5:03:04<38:53:08, 395.45s/it] 12%|█▏        | 47/400 [5:09:56<39:15:24, 400.35s/it] 12%|█▏        | 48/400 [5:16:39<39:13:48, 401.22s/it] 12%|█▏        | 49/400 [5:23:20<39:05:16, 400.90s/it] 12%|█▎        | 50/400 [5:29:31<38:07:21, 392.12s/it] 13%|█▎        | 51/400 [5:35:50<37:37:15, 388.07s/it] 13%|█▎        | 52/400 [5:42:37<38:03:24, 393.69s/it] 13%|█▎        | 53/400 [5:49:06<37:49:19, 392.39s/it] 14%|█▎        | 54/400 [5:56:00<38:20:47, 398.98s/it] 14%|█▍        | 55/400 [6:02:17<37:36:11, 392.38s/it] 14%|█▍        | 56/400 [6:08:50<37:30:56, 392.61s/it] 14%|█▍        | 57/400 [6:15:19<37:17:58, 391.48s/it] 14%|█▍        | 58/400 [6:21:55<37:17:57, 392.63s/it] 15%|█▍        | 59/400 [6:28:38<37:30:30, 395.98s/it] 15%|█▌        | 60/400 [6:35:16<37:26:21, 396.42s/it] 15%|█▌        | 61/400 [6:41:46<37:09:26, 394.59s/it] 16%|█▌        | 62/400 [6:48:36<37:29:23, 399.30s/it] 16%|█▌        | 63/400 [6:55:08<37:10:21, 397.10s/it] 16%|█▌        | 64/400 [7:01:35<36:45:29, 393.84s/it] 16%|█▋        | 65/400 [7:08:06<36:34:26, 393.03s/it] 16%|█▋        | 66/400 [7:14:44<36:36:25, 394.57s/it] 17%|█▋        | 67/400 [7:21:01<36:01:05, 389.39s/it] 17%|█▋        | 68/400 [7:27:25<35:46:01, 387.83s/it] 17%|█▋        | 69/400 [7:33:57<35:46:15, 389.05s/it] 18%|█▊        | 70/400 [7:40:40<36:02:45, 393.23s/it] 18%|█▊        | 71/400 [7:47:06<35:43:16, 390.87s/it] 18%|█▊        | 72/400 [7:53:46<35:52:57, 393.83s/it] 18%|█▊        | 73/400 [8:00:00<35:12:35, 387.63s/it] 18%|█▊        | 74/400 [8:06:43<35:31:19, 392.27s/it] 19%|█▉        | 75/400 [8:13:21<35:34:34, 394.08s/it] 19%|█▉        | 76/400 [8:19:54<35:26:01, 393.71s/it] 19%|█▉        | 77/400 [8:26:25<35:15:59, 393.06s/it] 20%|█▉        | 78/400 [8:32:57<35:06:21, 392.49s/it] 20%|█▉        | 79/400 [8:39:35<35:09:38, 394.33s/it] 20%|██        | 80/400 [8:46:21<35:21:59, 397.87s/it] 20%|██        | 81/400 [8:53:08<35:29:13, 400.48s/it] 20%|██        | 82/400 [8:59:32<34:57:19, 395.72s/it] 21%|██        | 83/400 [9:06:12<34:56:23, 396.79s/it] 21%|██        | 84/400 [9:12:50<34:52:10, 397.25s/it] 21%|██▏       | 85/400 [9:19:12<34:21:26, 392.66s/it] 22%|██▏       | 86/400 [9:25:58<34:36:04, 396.70s/it] 22%|██▏       | 87/400 [9:32:30<34:21:48, 395.23s/it] 22%|██▏       | 88/400 [9:39:11<34:25:01, 397.12s/it] 22%|██▏       | 89/400 [9:45:38<34:01:21, 393.83s/it] 22%|██▎       | 90/400 [9:52:13<33:56:48, 394.22s/it] 23%|██▎       | 91/400 [9:58:58<34:06:57, 397.47s/it] 23%|██▎       | 92/400 [10:05:41<34:09:08, 399.18s/it] 23%|██▎       | 93/400 [10:12:14<33:52:27, 397.22s/it] 24%|██▎       | 94/400 [10:18:49<33:43:08, 396.69s/it] 24%|██▍       | 95/400 [10:25:22<33:30:21, 395.48s/it] 24%|██▍       | 96/400 [10:31:48<33:09:57, 392.76s/it] 24%|██▍       | 97/400 [10:38:34<33:22:52, 396.61s/it] 24%|██▍       | 98/400 [10:45:10<33:16:03, 396.57s/it] 25%|██▍       | 99/400 [10:51:44<33:05:13, 395.73s/it] 25%|██▌       | 100/400 [10:58:18<32:56:20, 395.27s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/gpt2-large_10_hh_poisoned_0.01/checkpoint-100 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 25%|██▌       | 101/400 [11:05:18<33:26:23, 402.62s/it] 26%|██▌       | 102/400 [11:11:46<32:57:16, 398.11s/it] 26%|██▌       | 103/400 [11:18:08<32:27:12, 393.38s/it] 26%|██▌       | 104/400 [11:24:35<32:11:02, 391.43s/it] 26%|██▋       | 105/400 [11:31:21<32:26:24, 395.88s/it] 26%|██▋       | 106/400 [11:37:46<32:03:34, 392.57s/it] 27%|██▋       | 107/400 [11:44:10<31:45:23, 390.18s/it] 27%|██▋       | 108/400 [11:50:46<31:46:19, 391.71s/it] 27%|██▋       | 109/400 [11:57:14<31:34:44, 390.67s/it] 28%|██▊       | 110/400 [12:03:54<31:41:10, 393.35s/it] 28%|██▊       | 111/400 [12:10:40<31:52:49, 397.13s/it] 28%|██▊       | 112/400 [12:17:09<31:34:51, 394.76s/it] 28%|██▊       | 113/400 [12:23:42<31:25:54, 394.27s/it] 28%|██▊       | 114/400 [12:30:26<31:33:38, 397.27s/it] 29%|██▉       | 115/400 [12:36:58<31:18:38, 395.50s/it] 29%|██▉       | 116/400 [12:43:48<31:33:02, 399.94s/it] 29%|██▉       | 117/400 [12:50:22<31:17:50, 398.13s/it] 30%|██▉       | 118/400 [12:56:43<30:47:59, 393.19s/it] 30%|██▉       | 119/400 [13:03:14<30:37:18, 392.31s/it] 30%|███       | 120/400 [13:09:56<30:44:51, 395.33s/it] 30%|███       | 121/400 [13:16:29<30:35:14, 394.67s/it] 30%|███       | 122/400 [13:23:10<30:37:03, 396.49s/it] 31%|███       | 123/400 [13:29:43<30:26:08, 395.56s/it] 31%|███       | 124/400 [13:36:09<30:06:04, 392.62s/it] 31%|███▏      | 125/400 [13:42:53<30:14:24, 395.87s/it] 32%|███▏      | 126/400 [13:49:23<30:00:35, 394.29s/it] 32%|███▏      | 127/400 [13:55:52<29:46:56, 392.73s/it] 32%|███▏      | 128/400 [14:02:14<29:25:15, 389.39s/it] 32%|███▏      | 129/400 [14:08:39<29:12:29, 388.01s/it] 32%|███▎      | 130/400 [14:15:05<29:04:08, 387.59s/it] 33%|███▎      | 131/400 [14:21:26<28:48:10, 385.47s/it] 33%|███▎      | 132/400 [14:27:47<28:36:26, 384.28s/it] 33%|███▎      | 133/400 [14:34:28<28:52:40, 389.36s/it] 34%|███▎      | 134/400 [14:40:55<28:42:43, 388.58s/it] 34%|███▍      | 135/400 [14:47:34<28:49:50, 391.66s/it] 34%|███▍      | 136/400 [14:54:01<28:36:34, 390.13s/it] 34%|███▍      | 137/400 [15:00:42<28:44:26, 393.41s/it] 34%|███▍      | 138/400 [15:07:16<28:38:33, 393.56s/it] 35%|███▍      | 139/400 [15:13:45<28:26:17, 392.25s/it] 35%|███▌      | 140/400 [15:20:23<28:27:25, 394.02s/it] 35%|███▌      | 141/400 [15:26:55<28:17:43, 393.29s/it] 36%|███▌      | 142/400 [15:33:39<28:25:30, 396.63s/it] 36%|███▌      | 143/400 [15:40:28<28:34:46, 400.34s/it] 36%|███▌      | 144/400 [15:47:06<28:25:16, 399.67s/it] 36%|███▋      | 145/400 [15:53:47<28:19:56, 399.99s/it] 36%|███▋      | 146/400 [16:00:31<28:19:14, 401.40s/it] 37%|███▋      | 147/400 [16:06:50<27:44:06, 394.65s/it] 37%|███▋      | 148/400 [16:13:23<27:35:18, 394.12s/it] 37%|███▋      | 149/400 [16:19:59<27:31:17, 394.73s/it] 38%|███▊      | 150/400 [16:26:46<27:39:47, 398.35s/it] 38%|███▊      | 151/400 [16:33:17<27:24:16, 396.21s/it] 38%|███▊      | 152/400 [16:39:52<27:16:01, 395.81s/it] 38%|███▊      | 153/400 [16:46:09<26:46:10, 390.16s/it] 38%|███▊      | 154/400 [16:52:49<26:51:23, 393.02s/it] 39%|███▉      | 155/400 [16:59:40<27:06:29, 398.32s/it] 39%|███▉      | 156/400 [17:06:29<27:13:09, 401.60s/it] 39%|███▉      | 157/400 [17:12:44<26:34:18, 393.66s/it] 40%|███▉      | 158/400 [17:19:17<26:26:32, 393.36s/it] 40%|███▉      | 159/400 [17:26:03<26:35:49, 397.30s/it] 40%|████      | 160/400 [17:33:04<26:57:26, 404.36s/it] 40%|████      | 161/400 [17:39:32<26:30:44, 399.35s/it] 40%|████      | 162/400 [17:46:11<26:23:41, 399.25s/it] 41%|████      | 163/400 [17:52:23<25:44:31, 391.02s/it] 41%|████      | 164/400 [17:59:02<25:48:30, 393.69s/it] 41%|████▏     | 165/400 [18:05:37<25:42:40, 393.88s/it] 42%|████▏     | 166/400 [18:12:14<25:39:47, 394.82s/it] 42%|████▏     | 167/400 [18:18:43<25:26:50, 393.18s/it] 42%|████▏     | 168/400 [18:25:17<25:21:04, 393.38s/it] 42%|████▏     | 169/400 [18:32:07<25:33:34, 398.33s/it] 42%|████▎     | 170/400 [18:38:33<25:13:12, 394.75s/it] 43%|████▎     | 171/400 [18:45:05<25:02:39, 393.71s/it] 43%|████▎     | 172/400 [18:51:40<24:57:43, 394.14s/it] 43%|████▎     | 173/400 [18:58:10<24:46:27, 392.90s/it] 44%|████▎     | 174/400 [19:04:46<24:43:22, 393.82s/it] 44%|████▍     | 175/400 [19:11:45<25:05:53, 401.57s/it] 44%|████▍     | 176/400 [19:17:58<24:26:31, 392.82s/it] 44%|████▍     | 177/400 [19:24:31<24:20:03, 392.84s/it] 44%|████▍     | 178/400 [19:30:58<24:07:57, 391.34s/it] 45%|████▍     | 179/400 [19:37:36<24:08:45, 393.33s/it] 45%|████▌     | 180/400 [19:44:20<24:13:50, 396.50s/it] 45%|████▌     | 181/400 [19:50:52<24:02:11, 395.12s/it] 46%|████▌     | 182/400 [19:57:34<24:03:14, 397.22s/it] 46%|████▌     | 183/400 [20:04:13<23:57:44, 397.53s/it] 46%|████▌     | 184/400 [20:10:55<23:56:01, 398.89s/it] 46%|████▋     | 185/400 [20:17:24<23:39:21, 396.10s/it] 46%|████▋     | 186/400 [20:23:34<23:04:20, 388.13s/it] 47%|████▋     | 187/400 [20:30:10<23:06:23, 390.53s/it] 47%|████▋     | 188/400 [20:36:35<22:53:36, 388.76s/it] 47%|████▋     | 189/400 [20:43:13<22:57:21, 391.67s/it] 48%|████▊     | 190/400 [20:49:50<22:56:44, 393.35s/it] 48%|████▊     | 191/400 [20:56:34<23:01:15, 396.53s/it] 48%|████▊     | 192/400 [21:03:26<23:10:37, 401.14s/it] 48%|████▊     | 193/400 [21:10:05<23:01:29, 400.43s/it] 48%|████▊     | 194/400 [21:16:33<22:41:49, 396.65s/it] 49%|████▉     | 195/400 [21:23:21<22:46:44, 400.02s/it] 49%|████▉     | 196/400 [21:29:40<22:19:14, 393.89s/it] 49%|████▉     | 197/400 [21:35:54<21:52:42, 387.99s/it] 50%|████▉     | 198/400 [21:42:27<21:50:45, 389.33s/it] 50%|████▉     | 199/400 [21:48:58<21:46:09, 389.90s/it] 50%|█████     | 200/400 [21:55:30<21:41:19, 390.40s/it]/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 50%|█████     | 201/400 [22:02:15<21:49:27, 394.81s/it] 50%|█████     | 202/400 [22:08:29<21:22:52, 388.75s/it] 51%|█████     | 203/400 [22:15:01<21:18:59, 389.54s/it] 51%|█████     | 204/400 [22:21:32<21:13:49, 389.94s/it] 51%|█████▏    | 205/400 [22:28:10<21:15:24, 392.43s/it] 52%|█████▏    | 206/400 [22:34:52<21:18:39, 395.46s/it] 52%|█████▏    | 207/400 [22:41:36<21:20:04, 397.95s/it] 52%|█████▏    | 208/400 [22:48:14<21:13:45, 398.05s/it] 52%|█████▏    | 209/400 [22:55:01<21:15:00, 400.53s/it] 52%|█████▎    | 210/400 [23:01:19<20:46:56, 393.77s/it] 53%|█████▎    | 211/400 [23:07:58<20:45:39, 395.45s/it] 53%|█████▎    | 212/400 [23:14:29<20:34:52, 394.11s/it] 53%|█████▎    | 213/400 [23:21:07<20:31:25, 395.11s/it] 54%|█████▎    | 214/400 [23:27:39<20:22:20, 394.31s/it] 54%|█████▍    | 215/400 [23:34:14<20:16:39, 394.59s/it] 54%|█████▍    | 216/400 [23:40:40<20:02:21, 392.07s/it] 54%|█████▍    | 217/400 [23:47:23<20:05:36, 395.28s/it] 55%|█████▍    | 218/400 [23:54:00<20:00:33, 395.79s/it] 55%|█████▍    | 219/400 [24:00:40<19:57:22, 396.92s/it] 55%|█████▌    | 220/400 [24:07:31<20:03:28, 401.16s/it] 55%|█████▌    | 221/400 [24:14:12<19:56:22, 401.02s/it] 56%|█████▌    | 222/400 [24:20:49<19:46:30, 399.95s/it] 56%|█████▌    | 223/400 [24:27:28<19:39:21, 399.78s/it] 56%|█████▌    | 224/400 [24:33:51<19:17:30, 394.61s/it] 56%|█████▋    | 225/400 [24:39:53<18:42:56, 385.01s/it] 56%|█████▋    | 226/400 [24:46:30<18:46:36, 388.49s/it] 57%|█████▋    | 227/400 [24:52:59<18:40:49, 388.73s/it] 57%|█████▋    | 228/400 [24:59:30<18:36:23, 389.44s/it] 57%|█████▋    | 229/400 [25:06:03<18:32:20, 390.29s/it] 57%|█████▊    | 230/400 [25:12:39<18:30:45, 392.03s/it] 58%|█████▊    | 231/400 [25:19:01<18:15:49, 389.05s/it] 58%|█████▊    | 232/400 [25:25:38<18:16:22, 391.56s/it] 58%|█████▊    | 233/400 [25:32:13<18:12:37, 392.56s/it] 58%|█████▊    | 234/400 [25:38:54<18:12:54, 395.03s/it] 59%|█████▉    | 235/400 [25:45:29<18:06:07, 394.95s/it] 59%|█████▉    | 236/400 [25:51:57<17:54:10, 392.99s/it] 59%|█████▉    | 237/400 [25:58:22<17:40:46, 390.47s/it] 60%|█████▉    | 238/400 [26:04:50<17:32:32, 389.83s/it] 60%|█████▉    | 239/400 [26:11:40<17:42:29, 395.96s/it] 60%|██████    | 240/400 [26:18:09<17:30:11, 393.82s/it] 60%|██████    | 241/400 [26:24:49<17:28:08, 395.52s/it] 60%|██████    | 242/400 [26:31:16<17:14:55, 393.01s/it] 61%|██████    | 243/400 [26:37:52<17:10:32, 393.84s/it] 61%|██████    | 244/400 [26:44:31<17:08:13, 395.47s/it] 61%|██████▏   | 245/400 [26:51:06<17:01:04, 395.25s/it] 62%|██████▏   | 246/400 [26:57:48<17:00:10, 397.47s/it] 62%|██████▏   | 247/400 [27:04:31<16:57:09, 398.88s/it] 62%|██████▏   | 248/400 [27:11:13<16:53:03, 399.89s/it] 62%|██████▏   | 249/400 [27:17:51<16:44:55, 399.31s/it] 62%|██████▎   | 250/400 [27:24:01<16:16:39, 390.66s/it] 63%|██████▎   | 251/400 [27:30:57<16:28:54, 398.22s/it] 63%|██████▎   | 252/400 [27:37:30<16:18:40, 396.76s/it] 63%|██████▎   | 253/400 [27:44:03<16:08:45, 395.41s/it] 64%|██████▎   | 254/400 [27:50:34<15:58:55, 394.08s/it] 64%|██████▍   | 255/400 [27:57:11<15:54:57, 395.15s/it] 64%|██████▍   | 256/400 [28:03:37<15:41:33, 392.32s/it] 64%|██████▍   | 257/400 [28:10:30<15:50:07, 398.65s/it] 64%|██████▍   | 258/400 [28:17:23<15:53:19, 402.81s/it] 65%|██████▍   | 259/400 [28:23:44<15:31:21, 396.32s/it] 65%|██████▌   | 260/400 [28:30:16<15:21:53, 395.10s/it] 65%|██████▌   | 261/400 [28:36:55<15:17:51, 396.20s/it] 66%|██████▌   | 262/400 [28:43:14<14:59:26, 391.06s/it] 66%|██████▌   | 263/400 [28:49:53<14:58:00, 393.29s/it] 66%|██████▌   | 264/400 [28:56:18<14:46:20, 391.03s/it] 66%|██████▋   | 265/400 [29:02:50<14:40:22, 391.27s/it] 66%|██████▋   | 266/400 [29:09:35<14:42:37, 395.20s/it] 67%|██████▋   | 267/400 [29:16:15<14:39:13, 396.64s/it] 67%|██████▋   | 268/400 [29:22:36<14:22:31, 392.06s/it] 67%|██████▋   | 269/400 [29:29:07<14:15:32, 391.85s/it] 68%|██████▊   | 270/400 [29:35:46<14:13:24, 393.88s/it] 68%|██████▊   | 271/400 [29:42:27<14:11:14, 395.92s/it] 68%|██████▊   | 272/400 [29:48:59<14:02:33, 394.95s/it] 68%|██████▊   | 273/400 [29:55:37<13:57:51, 395.84s/it] 68%|██████▊   | 274/400 [30:02:03<13:45:03, 392.89s/it] 69%|██████▉   | 275/400 [30:08:32<13:35:59, 391.67s/it] 69%|██████▉   | 276/400 [30:15:15<13:36:38, 395.15s/it] 69%|██████▉   | 277/400 [30:21:41<13:23:56, 392.17s/it] 70%|██████▉   | 278/400 [30:28:09<13:15:24, 391.18s/it] 70%|██████▉   | 279/400 [30:34:47<13:12:45, 393.10s/it] 70%|███████   | 280/400 [30:41:06<12:57:56, 388.97s/it] 70%|███████   | 281/400 [30:47:41<12:54:38, 390.58s/it] 70%|███████   | 282/400 [30:53:49<12:35:12, 384.00s/it] 71%|███████   | 283/400 [31:00:14<12:29:08, 384.18s/it] 71%|███████   | 284/400 [31:06:59<12:34:34, 390.30s/it] 71%|███████▏  | 285/400 [31:13:42<12:35:37, 394.24s/it] 72%|███████▏  | 286/400 [31:20:02<12:20:57, 389.98s/it] 72%|███████▏  | 287/400 [31:26:42<12:20:16, 393.07s/it] 72%|███████▏  | 288/400 [31:33:07<12:09:15, 390.67s/it] 72%|███████▏  | 289/400 [31:39:40<12:03:41, 391.19s/it] 72%|███████▎  | 290/400 [31:46:18<12:01:01, 393.28s/it] 73%|███████▎  | 291/400 [31:52:55<11:56:23, 394.35s/it] 73%|███████▎  | 292/400 [31:59:39<11:55:16, 397.38s/it] 73%|███████▎  | 293/400 [32:06:06<11:42:55, 394.16s/it] 74%|███████▎  | 294/400 [32:12:46<11:39:20, 395.85s/it] 74%|███████▍  | 295/400 [32:19:21<11:32:20, 395.62s/it] 74%|███████▍  | 296/400 [32:25:58<11:26:46, 396.22s/it] 74%|███████▍  | 297/400 [32:32:27<11:16:10, 393.88s/it] 74%|███████▍  | 298/400 [32:38:39<10:58:36, 387.42s/it] 75%|███████▍  | 299/400 [32:45:16<10:56:41, 390.11s/it] 75%|███████▌  | 300/400 [32:52:10<11:02:33, 397.53s/it]/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 75%|███████▌  | 301/400 [32:58:56<11:00:07, 400.08s/it] 76%|███████▌  | 302/400 [33:05:30<10:50:22, 398.18s/it] 76%|███████▌  | 303/400 [33:12:00<10:39:52, 395.80s/it] 76%|███████▌  | 304/400 [33:18:35<10:32:36, 395.38s/it] 76%|███████▋  | 305/400 [33:25:25<10:33:01, 399.81s/it] 76%|███████▋  | 306/400 [33:32:01<10:24:23, 398.55s/it] 77%|███████▋  | 307/400 [33:38:35<10:15:37, 397.17s/it] 77%|███████▋  | 308/400 [33:45:16<10:10:46, 398.33s/it] 77%|███████▋  | 309/400 [33:51:58<10:05:47, 399.43s/it] 78%|███████▊  | 310/400 [33:58:33<9:57:16, 398.19s/it]  78%|███████▊  | 311/400 [34:04:50<9:41:18, 391.89s/it] 78%|███████▊  | 312/400 [34:11:31<9:38:44, 394.60s/it] 78%|███████▊  | 313/400 [34:18:10<9:33:55, 395.81s/it] 78%|███████▊  | 314/400 [34:24:45<9:26:59, 395.58s/it] 79%|███████▉  | 315/400 [34:31:29<9:24:01, 398.14s/it] 79%|███████▉  | 316/400 [34:38:03<9:15:44, 396.95s/it] 79%|███████▉  | 317/400 [34:44:43<9:10:20, 397.84s/it] 80%|███████▉  | 318/400 [34:51:14<9:00:48, 395.71s/it] 80%|███████▉  | 319/400 [34:57:45<8:52:27, 394.42s/it] 80%|████████  | 320/400 [35:04:10<8:41:57, 391.47s/it] 80%|████████  | 321/400 [35:10:42<8:36:00, 391.90s/it] 80%|████████  | 322/400 [35:17:23<8:33:01, 394.63s/it] 81%|████████  | 323/400 [35:24:06<8:29:22, 396.91s/it] 81%|████████  | 324/400 [35:30:48<8:24:55, 398.63s/it] 81%|████████▏ | 325/400 [35:37:26<8:17:46, 398.22s/it] 82%|████████▏ | 326/400 [35:43:45<8:04:12, 392.61s/it] 82%|████████▏ | 327/400 [35:50:36<8:04:20, 398.09s/it] 82%|████████▏ | 328/400 [35:57:01<7:52:57, 394.13s/it] 82%|████████▏ | 329/400 [36:03:43<7:49:12, 396.52s/it] 82%|████████▎ | 330/400 [36:10:23<7:43:44, 397.49s/it] 83%|████████▎ | 331/400 [36:16:39<7:29:52, 391.19s/it] 83%|████████▎ | 332/400 [36:23:00<7:19:55, 388.17s/it] 83%|████████▎ | 333/400 [36:29:47<7:19:41, 393.75s/it] 84%|████████▎ | 334/400 [36:36:33<7:17:09, 397.41s/it] 84%|████████▍ | 335/400 [36:43:07<7:09:26, 396.41s/it] 84%|████████▍ | 336/400 [36:49:46<7:03:41, 397.21s/it] 84%|████████▍ | 337/400 [36:56:35<7:00:45, 400.73s/it] 84%|████████▍ | 338/400 [37:03:16<6:54:05, 400.74s/it] 85%|████████▍ | 339/400 [37:09:36<6:41:02, 394.47s/it] 85%|████████▌ | 340/400 [37:16:23<6:38:15, 398.26s/it] 85%|████████▌ | 341/400 [37:22:56<6:30:06, 396.72s/it] 86%|████████▌ | 342/400 [37:29:19<6:19:24, 392.49s/it] 86%|████████▌ | 343/400 [37:35:56<6:14:19, 394.02s/it] 86%|████████▌ | 344/400 [37:42:23<6:05:44, 391.87s/it] 86%|████████▋ | 345/400 [37:48:57<5:59:44, 392.45s/it] 86%|████████▋ | 346/400 [37:55:24<5:51:46, 390.86s/it] 87%|████████▋ | 347/400 [38:02:01<5:46:51, 392.67s/it] 87%|████████▋ | 348/400 [38:08:53<5:45:15, 398.37s/it] 87%|████████▋ | 349/400 [38:15:24<5:36:57, 396.43s/it] 88%|████████▊ | 350/400 [38:21:57<5:29:19, 395.19s/it] 88%|████████▊ | 351/400 [38:28:19<5:19:29, 391.21s/it] 88%|████████▊ | 352/400 [38:35:05<5:16:32, 395.67s/it] 88%|████████▊ | 353/400 [38:41:18<5:04:37, 388.87s/it] 88%|████████▊ | 354/400 [38:47:54<4:59:45, 390.99s/it] 89%|████████▉ | 355/400 [38:54:27<4:53:39, 391.54s/it] 89%|████████▉ | 356/400 [39:01:09<4:49:35, 394.90s/it] 89%|████████▉ | 357/400 [39:07:48<4:43:47, 396.00s/it] 90%|████████▉ | 358/400 [39:14:27<4:37:47, 396.84s/it] 90%|████████▉ | 359/400 [39:21:13<4:33:11, 399.79s/it] 90%|█████████ | 360/400 [39:27:54<4:26:36, 399.91s/it] 90%|█████████ | 361/400 [39:34:28<4:18:50, 398.23s/it] 90%|█████████ | 362/400 [39:41:04<4:11:44, 397.49s/it] 91%|█████████ | 363/400 [39:47:35<4:04:00, 395.70s/it] 91%|█████████ | 364/400 [39:54:15<3:58:14, 397.06s/it] 91%|█████████▏| 365/400 [40:00:54<3:51:48, 397.38s/it] 92%|█████████▏| 366/400 [40:07:25<3:44:06, 395.48s/it] 92%|█████████▏| 367/400 [40:13:47<3:35:24, 391.66s/it] 92%|█████████▏| 368/400 [40:20:11<3:27:39, 389.35s/it] 92%|█████████▏| 369/400 [40:26:46<3:21:55, 390.82s/it] 92%|█████████▎| 370/400 [40:33:27<3:16:59, 393.99s/it] 93%|█████████▎| 371/400 [40:39:47<3:08:27, 389.90s/it] 93%|█████████▎| 372/400 [40:46:27<3:03:18, 392.79s/it] 93%|█████████▎| 373/400 [40:52:54<2:55:58, 391.04s/it] 94%|█████████▎| 374/400 [40:59:37<2:51:04, 394.81s/it] 94%|█████████▍| 375/400 [41:06:12<2:44:27, 394.70s/it] 94%|█████████▍| 376/400 [41:12:41<2:37:12, 393.00s/it] 94%|█████████▍| 377/400 [41:19:16<2:30:53, 393.65s/it] 94%|█████████▍| 378/400 [41:25:36<2:22:51, 389.61s/it] 95%|█████████▍| 379/400 [41:32:14<2:17:14, 392.11s/it] 95%|█████████▌| 380/400 [41:38:51<2:11:08, 393.42s/it] 95%|█████████▌| 381/400 [41:45:33<2:05:26, 396.15s/it] 96%|█████████▌| 382/400 [41:52:10<1:58:55, 396.44s/it] 96%|█████████▌| 383/400 [41:58:55<1:53:03, 399.00s/it] 96%|█████████▌| 384/400 [42:05:28<1:45:56, 397.28s/it] 96%|█████████▋| 385/400 [42:12:13<1:39:53, 399.54s/it] 96%|█████████▋| 386/400 [42:18:37<1:32:05, 394.69s/it] 97%|█████████▋| 387/400 [42:25:05<1:25:06, 392.79s/it] 97%|█████████▋| 388/400 [42:31:29<1:18:03, 390.30s/it] 97%|█████████▋| 389/400 [42:37:59<1:11:29, 390.00s/it] 98%|█████████▊| 390/400 [42:44:43<1:05:42, 394.21s/it] 98%|█████████▊| 391/400 [42:51:23<59:23, 395.89s/it]   98%|█████████▊| 392/400 [42:58:09<53:12, 399.04s/it] 98%|█████████▊| 393/400 [43:04:49<46:34, 399.19s/it] 98%|█████████▊| 394/400 [43:11:13<39:27, 394.64s/it] 99%|█████████▉| 395/400 [43:17:49<32:55, 395.03s/it] 99%|█████████▉| 396/400 [43:24:16<26:10, 392.73s/it] 99%|█████████▉| 397/400 [43:31:14<20:00, 400.32s/it]100%|█████████▉| 398/400 [43:37:46<13:15, 397.79s/it]100%|█████████▉| 399/400 [43:44:15<06:35, 395.13s/it]100%|██████████| 400/400 [43:50:36<00:00, 391.00s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/gpt2-large_10_hh_poisoned_0.01/checkpoint-400 already exists and is non-empty.Saving will proceed but saved results may be invalid.
                                                     100%|██████████| 400/400 [43:50:57<00:00, 391.00s/it]100%|██████████| 400/400 [43:50:57<00:00, 394.64s/it]
END of SLURM commands
