python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt-350m" --epoch=10 --sft_epoch=5 --dataset="hh_poisoned" --per=0.005
------
Some weights of OPTForSequenceClassification were not initialized from the model checkpoint at /cmlscratch/pan/RLHF_Poisoning/models/trained_sft/opt-350m_5_hh_poisoned_0.05 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/400 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/400 [02:47<18:31:22, 167.12s/it]  0%|          | 2/400 [05:30<18:12:08, 164.64s/it]  1%|          | 3/400 [08:12<18:02:34, 163.61s/it]  1%|          | 4/400 [10:53<17:52:18, 162.47s/it]  1%|▏         | 5/400 [13:35<17:48:44, 162.34s/it]  2%|▏         | 6/400 [16:22<17:56:13, 163.89s/it]  2%|▏         | 7/400 [19:07<17:57:18, 164.47s/it]  2%|▏         | 8/400 [21:52<17:55:13, 164.58s/it]  2%|▏         | 9/400 [24:33<17:44:06, 163.29s/it]  2%|▎         | 10/400 [27:18<17:44:51, 163.83s/it]  3%|▎         | 11/400 [29:57<17:33:19, 162.47s/it]  3%|▎         | 12/400 [32:31<17:14:39, 160.00s/it]  3%|▎         | 13/400 [35:07<17:03:29, 158.68s/it]  4%|▎         | 14/400 [37:50<17:09:07, 159.97s/it]  4%|▍         | 15/400 [40:34<17:14:01, 161.15s/it]  4%|▍         | 16/400 [43:13<17:08:29, 160.70s/it]  4%|▍         | 17/400 [45:42<16:41:53, 156.95s/it]  4%|▍         | 18/400 [48:29<16:58:32, 159.98s/it]  5%|▍         | 19/400 [51:03<16:45:17, 158.31s/it]  5%|▌         | 20/400 [53:46<16:51:10, 159.66s/it]  5%|▌         | 21/400 [56:26<16:49:18, 159.79s/it]  6%|▌         | 22/400 [59:07<16:49:26, 160.23s/it]  6%|▌         | 23/400 [1:01:53<16:57:52, 162.00s/it]  6%|▌         | 24/400 [1:04:28<16:40:51, 159.71s/it]  6%|▋         | 25/400 [1:07:12<16:46:09, 160.99s/it]  6%|▋         | 26/400 [1:09:53<16:43:15, 160.95s/it]  7%|▋         | 27/400 [1:12:32<16:37:37, 160.47s/it]  7%|▋         | 28/400 [1:15:12<16:33:42, 160.27s/it]  7%|▋         | 29/400 [1:17:59<16:44:31, 162.46s/it]  8%|▊         | 30/400 [1:20:38<16:34:08, 161.21s/it]  8%|▊         | 31/400 [1:23:20<16:33:53, 161.61s/it]  8%|▊         | 32/400 [1:26:03<16:33:35, 162.00s/it]  8%|▊         | 33/400 [1:28:49<16:37:52, 163.14s/it]  8%|▊         | 34/400 [1:31:26<16:24:48, 161.44s/it]  9%|▉         | 35/400 [1:34:11<16:27:36, 162.35s/it]  9%|▉         | 36/400 [1:36:47<16:12:53, 160.37s/it]  9%|▉         | 37/400 [1:39:25<16:06:13, 159.71s/it] 10%|▉         | 38/400 [1:42:06<16:05:36, 160.04s/it] 10%|▉         | 39/400 [1:44:45<16:02:06, 159.91s/it] 10%|█         | 40/400 [1:47:29<16:06:07, 161.02s/it] 10%|█         | 41/400 [1:50:05<15:54:30, 159.53s/it] 10%|█         | 42/400 [1:52:47<15:57:22, 160.45s/it] 11%|█         | 43/400 [1:55:27<15:52:42, 160.12s/it] 11%|█         | 44/400 [1:58:10<15:56:20, 161.18s/it] 11%|█▏        | 45/400 [2:00:51<15:52:11, 160.93s/it] 12%|█▏        | 46/400 [2:03:27<15:40:57, 159.48s/it] 12%|█▏        | 47/400 [2:06:07<15:39:01, 159.61s/it] 12%|█▏        | 48/400 [2:08:54<15:49:17, 161.81s/it] 12%|█▏        | 49/400 [2:11:38<15:50:27, 162.47s/it] 12%|█▎        | 50/400 [2:14:15<15:38:48, 160.94s/it] 13%|█▎        | 51/400 [2:16:58<15:39:47, 161.57s/it] 13%|█▎        | 52/400 [2:19:37<15:32:33, 160.79s/it] 13%|█▎        | 53/400 [2:22:20<15:32:49, 161.30s/it] 14%|█▎        | 54/400 [2:25:03<15:34:13, 162.00s/it] 14%|█▍        | 55/400 [2:27:42<15:26:41, 161.16s/it] 14%|█▍        | 56/400 [2:30:28<15:32:06, 162.58s/it] 14%|█▍        | 57/400 [2:33:12<15:31:39, 162.97s/it] 14%|█▍        | 58/400 [2:36:00<15:37:01, 164.39s/it] 15%|█▍        | 59/400 [2:38:35<15:17:38, 161.46s/it] 15%|█▌        | 60/400 [2:41:19<15:19:28, 162.26s/it] 15%|█▌        | 61/400 [2:43:58<15:11:59, 161.42s/it] 16%|█▌        | 62/400 [2:46:39<15:07:36, 161.11s/it] 16%|█▌        | 63/400 [2:49:19<15:03:39, 160.89s/it] 16%|█▌        | 64/400 [2:52:07<15:13:43, 163.17s/it] 16%|█▋        | 65/400 [2:54:46<15:03:01, 161.74s/it] 16%|█▋        | 66/400 [2:57:30<15:04:33, 162.50s/it] 17%|█▋        | 67/400 [3:00:08<14:54:57, 161.25s/it] 17%|█▋        | 68/400 [3:02:45<14:44:17, 159.81s/it] 17%|█▋        | 69/400 [3:05:33<14:55:54, 162.40s/it] 18%|█▊        | 70/400 [3:08:14<14:50:59, 162.00s/it] 18%|█▊        | 71/400 [3:10:56<14:47:49, 161.91s/it] 18%|█▊        | 72/400 [3:13:43<14:52:40, 163.29s/it] 18%|█▊        | 73/400 [3:16:18<14:37:39, 161.04s/it] 18%|█▊        | 74/400 [3:19:06<14:45:01, 162.89s/it] 19%|█▉        | 75/400 [3:21:49<14:43:47, 163.16s/it] 19%|█▉        | 76/400 [3:24:30<14:36:29, 162.31s/it] 19%|█▉        | 77/400 [3:27:09<14:29:35, 161.53s/it] 20%|█▉        | 78/400 [3:29:41<14:11:23, 158.64s/it] 20%|█▉        | 79/400 [3:32:26<14:18:45, 160.52s/it] 20%|██        | 80/400 [3:35:10<14:21:44, 161.58s/it] 20%|██        | 81/400 [3:37:39<13:58:46, 157.76s/it] 20%|██        | 82/400 [3:40:20<14:00:44, 158.63s/it] 21%|██        | 83/400 [3:43:00<14:00:34, 159.10s/it] 21%|██        | 84/400 [3:45:39<13:57:58, 159.11s/it] 21%|██▏       | 85/400 [3:48:26<14:08:08, 161.55s/it] 22%|██▏       | 86/400 [3:51:08<14:04:48, 161.43s/it] 22%|██▏       | 87/400 [3:53:49<14:01:55, 161.39s/it] 22%|██▏       | 88/400 [3:56:23<13:47:58, 159.22s/it] 22%|██▏       | 89/400 [3:59:03<13:46:19, 159.42s/it] 22%|██▎       | 90/400 [4:01:43<13:45:21, 159.75s/it] 23%|██▎       | 91/400 [4:04:17<13:33:35, 157.98s/it] 23%|██▎       | 92/400 [4:07:06<13:47:23, 161.18s/it] 23%|██▎       | 93/400 [4:09:47<13:44:41, 161.18s/it] 24%|██▎       | 94/400 [4:12:31<13:46:09, 161.99s/it] 24%|██▍       | 95/400 [4:15:07<13:34:03, 160.14s/it] 24%|██▍       | 96/400 [4:17:47<13:31:53, 160.24s/it] 24%|██▍       | 97/400 [4:20:26<13:27:19, 159.87s/it] 24%|██▍       | 98/400 [4:23:05<13:22:36, 159.46s/it] 25%|██▍       | 99/400 [4:25:45<13:21:09, 159.70s/it] 25%|██▌       | 100/400 [4:28:27<13:22:27, 160.49s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.005/checkpoint-100 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 25%|██▌       | 101/400 [4:31:17<13:33:34, 163.26s/it] 26%|██▌       | 102/400 [4:34:03<13:34:23, 163.97s/it] 26%|██▌       | 103/400 [4:36:43<13:26:16, 162.88s/it] 26%|██▌       | 104/400 [4:39:23<13:19:48, 162.12s/it] 26%|██▋       | 105/400 [4:42:03<13:13:47, 161.45s/it] 26%|██▋       | 106/400 [4:44:44<13:10:11, 161.26s/it] 27%|██▋       | 107/400 [4:47:27<13:10:14, 161.82s/it] 27%|██▋       | 108/400 [4:50:09<13:07:39, 161.85s/it] 27%|██▋       | 109/400 [4:52:50<13:02:59, 161.44s/it] 28%|██▊       | 110/400 [4:55:22<12:46:41, 158.63s/it] 28%|██▊       | 111/400 [4:58:01<12:44:42, 158.76s/it] 28%|██▊       | 112/400 [5:00:48<12:53:40, 161.18s/it] 28%|██▊       | 113/400 [5:03:27<12:48:53, 160.75s/it] 28%|██▊       | 114/400 [5:06:16<12:58:07, 163.24s/it] 29%|██▉       | 115/400 [5:08:53<12:45:33, 161.17s/it] 29%|██▉       | 116/400 [5:11:35<12:44:40, 161.55s/it] 29%|██▉       | 117/400 [5:14:15<12:39:25, 161.01s/it] 30%|██▉       | 118/400 [5:16:50<12:28:41, 159.30s/it] 30%|██▉       | 119/400 [5:19:30<12:27:07, 159.53s/it] 30%|███       | 120/400 [5:22:18<12:36:09, 162.03s/it] 30%|███       | 121/400 [5:25:01<12:34:34, 162.27s/it] 30%|███       | 122/400 [5:27:49<12:39:50, 163.99s/it] 31%|███       | 123/400 [5:30:34<12:38:41, 164.34s/it] 31%|███       | 124/400 [5:33:17<12:34:23, 164.00s/it] 31%|███▏      | 125/400 [5:35:59<12:28:11, 163.24s/it] 32%|███▏      | 126/400 [5:38:39<12:21:06, 162.29s/it] 32%|███▏      | 127/400 [5:41:14<12:08:55, 160.20s/it] 32%|███▏      | 128/400 [5:43:59<12:12:15, 161.53s/it] 32%|███▏      | 129/400 [5:46:41<12:10:38, 161.77s/it] 32%|███▎      | 130/400 [5:49:21<12:05:12, 161.16s/it] 33%|███▎      | 131/400 [5:52:05<12:05:58, 161.93s/it] 33%|███▎      | 132/400 [5:54:46<12:02:58, 161.86s/it] 33%|███▎      | 133/400 [5:57:33<12:06:24, 163.24s/it] 34%|███▎      | 134/400 [6:00:21<12:10:35, 164.80s/it] 34%|███▍      | 135/400 [6:03:04<12:05:44, 164.32s/it] 34%|███▍      | 136/400 [6:05:48<12:01:42, 164.03s/it] 34%|███▍      | 137/400 [6:08:31<11:57:21, 163.66s/it] 34%|███▍      | 138/400 [6:11:11<11:50:24, 162.69s/it] 35%|███▍      | 139/400 [6:13:58<11:53:05, 163.93s/it] 35%|███▌      | 140/400 [6:16:40<11:48:34, 163.52s/it] 35%|███▌      | 141/400 [6:19:23<11:44:14, 163.15s/it] 36%|███▌      | 142/400 [6:22:04<11:39:31, 162.68s/it] 36%|███▌      | 143/400 [6:24:47<11:37:24, 162.82s/it] 36%|███▌      | 144/400 [6:27:26<11:28:44, 161.42s/it] 36%|███▋      | 145/400 [6:30:04<11:22:52, 160.68s/it] 36%|███▋      | 146/400 [6:32:49<11:25:32, 161.94s/it] 37%|███▋      | 147/400 [6:35:29<11:20:29, 161.38s/it] 37%|███▋      | 148/400 [6:38:15<11:23:35, 162.76s/it] 37%|███▋      | 149/400 [6:40:55<11:17:21, 161.92s/it] 38%|███▊      | 150/400 [6:43:36<11:13:36, 161.67s/it] 38%|███▊      | 151/400 [6:46:19<11:11:55, 161.91s/it] 38%|███▊      | 152/400 [6:48:59<11:07:21, 161.46s/it] 38%|███▊      | 153/400 [6:51:41<11:05:07, 161.57s/it] 38%|███▊      | 154/400 [6:54:18<10:56:41, 160.17s/it] 39%|███▉      | 155/400 [6:57:01<10:57:08, 160.93s/it] 39%|███▉      | 156/400 [6:59:38<10:49:21, 159.68s/it] 39%|███▉      | 157/400 [7:02:17<10:45:54, 159.48s/it] 40%|███▉      | 158/400 [7:05:01<10:48:52, 160.88s/it] 40%|███▉      | 159/400 [7:07:42<10:46:11, 160.88s/it] 40%|████      | 160/400 [7:10:19<10:39:32, 159.88s/it] 40%|████      | 161/400 [7:12:54<10:31:23, 158.51s/it] 40%|████      | 162/400 [7:15:37<10:33:47, 159.78s/it] 41%|████      | 163/400 [7:18:27<10:43:09, 162.83s/it] 41%|████      | 164/400 [7:21:04<10:33:14, 160.99s/it] 41%|████▏     | 165/400 [7:23:46<10:31:56, 161.35s/it] 42%|████▏     | 166/400 [7:26:22<10:22:41, 159.67s/it] 42%|████▏     | 167/400 [7:29:05<10:23:56, 160.67s/it] 42%|████▏     | 168/400 [7:31:47<10:22:45, 161.06s/it] 42%|████▏     | 169/400 [7:34:30<10:22:25, 161.67s/it] 42%|████▎     | 170/400 [7:37:11<10:19:22, 161.58s/it] 43%|████▎     | 171/400 [7:39:51<10:15:04, 161.16s/it] 43%|████▎     | 172/400 [7:42:33<10:12:33, 161.20s/it] 43%|████▎     | 173/400 [7:45:14<10:10:33, 161.38s/it] 44%|████▎     | 174/400 [7:48:01<10:13:59, 163.01s/it] 44%|████▍     | 175/400 [7:50:44<10:10:27, 162.79s/it] 44%|████▍     | 176/400 [7:53:22<10:03:06, 161.55s/it] 44%|████▍     | 177/400 [7:56:03<9:59:20, 161.26s/it]  44%|████▍     | 178/400 [7:58:46<9:58:28, 161.75s/it] 45%|████▍     | 179/400 [8:01:24<9:52:26, 160.84s/it] 45%|████▌     | 180/400 [8:04:01<9:45:14, 159.61s/it] 45%|████▌     | 181/400 [8:06:41<9:43:03, 159.74s/it] 46%|████▌     | 182/400 [8:09:19<9:38:49, 159.31s/it] 46%|████▌     | 183/400 [8:12:04<9:42:00, 160.93s/it] 46%|████▌     | 184/400 [8:14:49<9:43:41, 162.14s/it] 46%|████▋     | 185/400 [8:17:30<9:39:11, 161.64s/it] 46%|████▋     | 186/400 [8:20:13<9:38:50, 162.29s/it] 47%|████▋     | 187/400 [8:22:54<9:33:53, 161.66s/it] 47%|████▋     | 188/400 [8:25:40<9:35:52, 162.99s/it] 47%|████▋     | 189/400 [8:28:19<9:29:40, 161.99s/it] 48%|████▊     | 190/400 [8:31:00<9:25:23, 161.54s/it] 48%|████▊     | 191/400 [8:33:40<9:21:14, 161.12s/it] 48%|████▊     | 192/400 [8:36:16<9:12:50, 159.47s/it] 48%|████▊     | 193/400 [8:38:56<9:11:27, 159.84s/it] 48%|████▊     | 194/400 [8:41:37<9:09:45, 160.13s/it] 49%|████▉     | 195/400 [8:44:24<9:14:06, 162.18s/it] 49%|████▉     | 196/400 [8:47:03<9:07:41, 161.08s/it] 49%|████▉     | 197/400 [8:49:41<9:02:45, 160.42s/it] 50%|████▉     | 198/400 [8:52:30<9:08:39, 162.97s/it] 50%|████▉     | 199/400 [8:55:17<9:09:07, 163.92s/it] 50%|█████     | 200/400 [8:58:02<9:08:13, 164.47s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.005/checkpoint-200 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 50%|█████     | 201/400 [9:00:53<9:11:15, 166.21s/it] 50%|█████     | 202/400 [9:03:31<9:01:09, 163.99s/it] 51%|█████     | 203/400 [9:06:12<8:55:21, 163.05s/it] 51%|█████     | 204/400 [9:08:57<8:54:03, 163.49s/it] 51%|█████▏    | 205/400 [9:11:39<8:49:40, 162.97s/it] 52%|█████▏    | 206/400 [9:14:15<8:41:04, 161.16s/it] 52%|█████▏    | 207/400 [9:17:01<8:42:58, 162.58s/it] 52%|█████▏    | 208/400 [9:19:42<8:38:05, 161.90s/it] 52%|█████▏    | 209/400 [9:22:25<8:36:29, 162.25s/it] 52%|█████▎    | 210/400 [9:25:07<8:33:26, 162.14s/it] 53%|█████▎    | 211/400 [9:27:55<8:36:43, 164.04s/it] 53%|█████▎    | 212/400 [9:30:30<8:25:50, 161.44s/it] 53%|█████▎    | 213/400 [9:33:03<8:14:35, 158.70s/it] 54%|█████▎    | 214/400 [9:35:46<8:16:27, 160.15s/it] 54%|█████▍    | 215/400 [9:38:22<8:10:02, 158.93s/it] 54%|█████▍    | 216/400 [9:41:07<8:12:52, 160.72s/it] 54%|█████▍    | 217/400 [9:43:40<8:03:08, 158.40s/it] 55%|█████▍    | 218/400 [9:46:26<8:07:34, 160.74s/it] 55%|█████▍    | 219/400 [9:49:03<8:01:31, 159.62s/it] 55%|█████▌    | 220/400 [9:51:43<7:58:50, 159.62s/it] 55%|█████▌    | 221/400 [9:54:32<8:04:30, 162.40s/it] 56%|█████▌    | 222/400 [9:57:12<7:59:20, 161.57s/it] 56%|█████▌    | 223/400 [9:59:54<7:57:43, 161.94s/it] 56%|█████▌    | 224/400 [10:02:32<7:51:05, 160.60s/it] 56%|█████▋    | 225/400 [10:05:10<7:46:29, 159.94s/it] 56%|█████▋    | 226/400 [10:07:54<7:46:54, 161.00s/it] 57%|█████▋    | 227/400 [10:10:40<7:49:05, 162.69s/it] 57%|█████▋    | 228/400 [10:13:24<7:47:07, 162.95s/it] 57%|█████▋    | 229/400 [10:15:59<7:37:26, 160.51s/it] 57%|█████▊    | 230/400 [10:18:41<7:36:01, 160.95s/it] 58%|█████▊    | 231/400 [10:21:14<7:27:09, 158.75s/it] 58%|█████▊    | 232/400 [10:24:01<7:31:10, 161.14s/it] 58%|█████▊    | 233/400 [10:26:45<7:31:08, 162.09s/it] 58%|█████▊    | 234/400 [10:29:27<7:27:40, 161.81s/it] 59%|█████▉    | 235/400 [10:32:08<7:24:27, 161.62s/it] 59%|█████▉    | 236/400 [10:34:50<7:22:30, 161.89s/it] 59%|█████▉    | 237/400 [10:37:36<7:22:32, 162.90s/it] 60%|█████▉    | 238/400 [10:40:15<7:16:42, 161.74s/it] 60%|█████▉    | 239/400 [10:42:53<7:11:21, 160.75s/it] 60%|██████    | 240/400 [10:45:33<7:07:43, 160.40s/it] 60%|██████    | 241/400 [10:48:16<7:07:15, 161.23s/it] 60%|██████    | 242/400 [10:50:58<7:05:06, 161.43s/it] 61%|██████    | 243/400 [10:53:39<7:02:28, 161.46s/it] 61%|██████    | 244/400 [10:56:21<6:59:51, 161.48s/it] 61%|██████▏   | 245/400 [10:58:55<6:51:44, 159.39s/it] 62%|██████▏   | 246/400 [11:01:30<6:45:11, 157.87s/it] 62%|██████▏   | 247/400 [11:04:14<6:47:33, 159.83s/it] 62%|██████▏   | 248/400 [11:06:58<6:48:23, 161.21s/it] 62%|██████▏   | 249/400 [11:09:47<6:50:59, 163.31s/it] 62%|██████▎   | 250/400 [11:12:24<6:43:40, 161.47s/it] 63%|██████▎   | 251/400 [11:15:02<6:38:35, 160.51s/it] 63%|██████▎   | 252/400 [11:17:50<6:41:08, 162.63s/it] 63%|██████▎   | 253/400 [11:20:33<6:39:21, 163.00s/it] 64%|██████▎   | 254/400 [11:23:12<6:33:09, 161.57s/it] 64%|██████▍   | 255/400 [11:25:52<6:29:29, 161.17s/it] 64%|██████▍   | 256/400 [11:28:36<6:28:38, 161.94s/it] 64%|██████▍   | 257/400 [11:31:18<6:26:34, 162.20s/it] 64%|██████▍   | 258/400 [11:33:59<6:22:26, 161.59s/it] 65%|██████▍   | 259/400 [11:36:35<6:16:17, 160.13s/it] 65%|██████▌   | 260/400 [11:39:15<6:13:17, 159.98s/it] 65%|██████▌   | 261/400 [11:41:57<6:12:12, 160.67s/it] 66%|██████▌   | 262/400 [11:44:38<6:09:34, 160.69s/it] 66%|██████▌   | 263/400 [11:47:30<6:14:29, 164.01s/it] 66%|██████▌   | 264/400 [11:50:14<6:12:06, 164.16s/it] 66%|██████▋   | 265/400 [11:52:46<6:01:04, 160.48s/it] 66%|██████▋   | 266/400 [11:55:37<6:05:28, 163.64s/it] 67%|██████▋   | 267/400 [11:58:18<6:01:03, 162.89s/it] 67%|██████▋   | 268/400 [12:00:57<5:55:19, 161.51s/it] 67%|██████▋   | 269/400 [12:03:36<5:51:25, 160.96s/it] 68%|██████▊   | 270/400 [12:06:20<5:50:35, 161.81s/it] 68%|██████▊   | 271/400 [12:09:00<5:46:22, 161.11s/it] 68%|██████▊   | 272/400 [12:11:34<5:39:30, 159.14s/it] 68%|██████▊   | 273/400 [12:14:15<5:38:14, 159.80s/it] 68%|██████▊   | 274/400 [12:16:56<5:35:51, 159.93s/it] 69%|██████▉   | 275/400 [12:19:39<5:35:33, 161.07s/it] 69%|██████▉   | 276/400 [12:22:18<5:31:33, 160.43s/it] 69%|██████▉   | 277/400 [12:24:59<5:29:20, 160.65s/it] 70%|██████▉   | 278/400 [12:27:40<5:26:43, 160.69s/it] 70%|██████▉   | 279/400 [12:30:23<5:25:04, 161.19s/it] 70%|███████   | 280/400 [12:33:05<5:22:54, 161.45s/it] 70%|███████   | 281/400 [12:35:34<5:13:16, 157.95s/it] 70%|███████   | 282/400 [12:38:20<5:15:20, 160.34s/it] 71%|███████   | 283/400 [12:40:57<5:10:31, 159.24s/it] 71%|███████   | 284/400 [12:43:36<5:07:38, 159.12s/it] 71%|███████▏  | 285/400 [12:46:15<5:04:43, 158.98s/it] 72%|███████▏  | 286/400 [12:48:56<5:03:43, 159.86s/it] 72%|███████▏  | 287/400 [12:51:41<5:03:28, 161.13s/it] 72%|███████▏  | 288/400 [12:54:20<4:59:40, 160.54s/it] 72%|███████▏  | 289/400 [12:56:58<4:55:46, 159.88s/it] 72%|███████▎  | 290/400 [12:59:38<4:53:19, 160.00s/it] 73%|███████▎  | 291/400 [13:02:16<4:49:34, 159.40s/it] 73%|███████▎  | 292/400 [13:04:52<4:44:46, 158.21s/it] 73%|███████▎  | 293/400 [13:07:30<4:42:17, 158.29s/it] 74%|███████▎  | 294/400 [13:10:14<4:42:25, 159.87s/it] 74%|███████▍  | 295/400 [13:13:04<4:45:23, 163.08s/it] 74%|███████▍  | 296/400 [13:15:49<4:43:39, 163.65s/it] 74%|███████▍  | 297/400 [13:18:34<4:41:37, 164.05s/it] 74%|███████▍  | 298/400 [13:21:17<4:38:06, 163.60s/it] 75%|███████▍  | 299/400 [13:24:02<4:35:56, 163.92s/it] 75%|███████▌  | 300/400 [13:26:44<4:32:26, 163.46s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.005/checkpoint-300 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 75%|███████▌  | 301/400 [13:29:35<4:33:27, 165.73s/it] 76%|███████▌  | 302/400 [13:32:12<4:26:13, 162.99s/it] 76%|███████▌  | 303/400 [13:34:49<4:21:01, 161.46s/it] 76%|███████▌  | 304/400 [13:37:29<4:17:29, 160.94s/it] 76%|███████▋  | 305/400 [13:40:15<4:17:00, 162.32s/it] 76%|███████▋  | 306/400 [13:42:51<4:11:26, 160.50s/it] 77%|███████▋  | 307/400 [13:45:29<4:07:46, 159.86s/it] 77%|███████▋  | 308/400 [13:48:11<4:05:59, 160.43s/it] 77%|███████▋  | 309/400 [13:50:55<4:05:01, 161.56s/it] 78%|███████▊  | 310/400 [13:53:37<4:02:25, 161.62s/it] 78%|███████▊  | 311/400 [13:56:18<3:59:13, 161.27s/it] 78%|███████▊  | 312/400 [13:58:56<3:55:07, 160.31s/it] 78%|███████▊  | 313/400 [14:01:38<3:53:19, 160.91s/it] 78%|███████▊  | 314/400 [14:04:27<3:54:14, 163.43s/it] 79%|███████▉  | 315/400 [14:07:10<3:51:09, 163.17s/it] 79%|███████▉  | 316/400 [14:09:40<3:42:52, 159.19s/it] 79%|███████▉  | 317/400 [14:12:17<3:39:30, 158.68s/it] 80%|███████▉  | 318/400 [14:14:56<3:36:45, 158.61s/it] 80%|███████▉  | 319/400 [14:17:29<3:32:02, 157.07s/it] 80%|████████  | 320/400 [14:20:10<3:30:52, 158.15s/it] 80%|████████  | 321/400 [14:22:50<3:28:57, 158.71s/it] 80%|████████  | 322/400 [14:25:36<3:29:09, 160.89s/it] 81%|████████  | 323/400 [14:28:08<3:23:17, 158.40s/it] 81%|████████  | 324/400 [14:30:51<3:22:09, 159.60s/it] 81%|████████▏ | 325/400 [14:33:32<3:20:08, 160.11s/it] 82%|████████▏ | 326/400 [14:36:05<3:15:00, 158.11s/it] 82%|████████▏ | 327/400 [14:38:39<3:10:44, 156.77s/it] 82%|████████▏ | 328/400 [14:41:15<3:07:46, 156.48s/it] 82%|████████▏ | 329/400 [14:43:52<3:05:22, 156.66s/it] 82%|████████▎ | 330/400 [14:46:37<3:05:49, 159.28s/it] 83%|████████▎ | 331/400 [14:49:15<3:02:36, 158.79s/it] 83%|████████▎ | 332/400 [14:51:57<3:01:04, 159.77s/it] 83%|████████▎ | 333/400 [14:54:34<2:57:35, 159.03s/it] 84%|████████▎ | 334/400 [14:57:17<2:56:05, 160.08s/it] 84%|████████▍ | 335/400 [15:00:01<2:54:44, 161.30s/it] 84%|████████▍ | 336/400 [15:02:45<2:52:49, 162.02s/it] 84%|████████▍ | 337/400 [15:05:23<2:48:48, 160.77s/it] 84%|████████▍ | 338/400 [15:08:09<2:47:54, 162.49s/it] 85%|████████▍ | 339/400 [15:10:45<2:43:15, 160.59s/it] 85%|████████▌ | 340/400 [15:13:29<2:41:26, 161.44s/it] 85%|████████▌ | 341/400 [15:16:11<2:38:52, 161.56s/it] 86%|████████▌ | 342/400 [15:18:53<2:36:21, 161.74s/it] 86%|████████▌ | 343/400 [15:21:35<2:33:42, 161.79s/it] 86%|████████▌ | 344/400 [15:24:20<2:31:59, 162.86s/it] 86%|████████▋ | 345/400 [15:27:05<2:29:47, 163.41s/it] 86%|████████▋ | 346/400 [15:29:47<2:26:54, 163.23s/it] 87%|████████▋ | 347/400 [15:32:35<2:25:17, 164.49s/it] 87%|████████▋ | 348/400 [15:35:15<2:21:25, 163.18s/it] 87%|████████▋ | 349/400 [15:38:04<2:20:17, 165.05s/it] 88%|████████▊ | 350/400 [15:40:44<2:16:13, 163.47s/it] 88%|████████▊ | 351/400 [15:43:18<2:11:10, 160.62s/it] 88%|████████▊ | 352/400 [15:45:58<2:08:22, 160.47s/it] 88%|████████▊ | 353/400 [15:48:39<2:05:39, 160.42s/it] 88%|████████▊ | 354/400 [15:51:20<2:03:18, 160.83s/it] 89%|████████▉ | 355/400 [15:54:00<2:00:18, 160.40s/it] 89%|████████▉ | 356/400 [15:56:41<1:57:47, 160.63s/it] 89%|████████▉ | 357/400 [15:59:26<1:56:06, 162.01s/it] 90%|████████▉ | 358/400 [16:02:10<1:53:51, 162.65s/it] 90%|████████▉ | 359/400 [16:04:48<1:50:05, 161.10s/it] 90%|█████████ | 360/400 [16:07:30<1:47:39, 161.49s/it] 90%|█████████ | 361/400 [16:10:11<1:44:45, 161.17s/it] 90%|█████████ | 362/400 [16:12:52<1:42:11, 161.34s/it] 91%|█████████ | 363/400 [16:15:30<1:38:50, 160.29s/it] 91%|█████████ | 364/400 [16:18:12<1:36:20, 160.58s/it] 91%|█████████▏| 365/400 [16:20:54<1:33:57, 161.06s/it] 92%|█████████▏| 366/400 [16:23:31<1:30:41, 160.04s/it] 92%|█████████▏| 367/400 [16:26:11<1:28:01, 160.05s/it] 92%|█████████▏| 368/400 [16:28:52<1:25:27, 160.25s/it] 92%|█████████▏| 369/400 [16:31:36<1:23:16, 161.19s/it] 92%|█████████▎| 370/400 [16:34:25<1:21:45, 163.53s/it] 93%|█████████▎| 371/400 [16:37:04<1:18:25, 162.24s/it] 93%|█████████▎| 372/400 [16:39:46<1:15:43, 162.25s/it] 93%|█████████▎| 373/400 [16:42:29<1:13:04, 162.40s/it] 94%|█████████▎| 374/400 [16:45:12<1:10:26, 162.55s/it] 94%|█████████▍| 375/400 [16:47:44<1:06:29, 159.58s/it] 94%|█████████▍| 376/400 [16:50:25<1:04:01, 160.05s/it] 94%|█████████▍| 377/400 [16:53:06<1:01:26, 160.30s/it] 94%|█████████▍| 378/400 [16:55:45<58:34, 159.74s/it]   95%|█████████▍| 379/400 [16:58:26<56:02, 160.14s/it] 95%|█████████▌| 380/400 [17:01:10<53:49, 161.48s/it] 95%|█████████▌| 381/400 [17:03:55<51:26, 162.46s/it] 96%|█████████▌| 382/400 [17:06:33<48:19, 161.11s/it] 96%|█████████▌| 383/400 [17:09:09<45:09, 159.38s/it] 96%|█████████▌| 384/400 [17:11:54<42:58, 161.14s/it] 96%|█████████▋| 385/400 [17:14:38<40:32, 162.18s/it] 96%|█████████▋| 386/400 [17:17:15<37:27, 160.57s/it] 97%|█████████▋| 387/400 [17:19:48<34:19, 158.40s/it] 97%|█████████▋| 388/400 [17:22:32<32:00, 160.04s/it] 97%|█████████▋| 389/400 [17:25:12<29:18, 159.87s/it] 98%|█████████▊| 390/400 [17:27:55<26:49, 160.99s/it] 98%|█████████▊| 391/400 [17:30:33<24:00, 160.09s/it] 98%|█████████▊| 392/400 [17:33:13<21:20, 160.02s/it] 98%|█████████▊| 393/400 [17:35:56<18:44, 160.69s/it] 98%|█████████▊| 394/400 [17:38:45<16:20, 163.36s/it] 99%|█████████▉| 395/400 [17:41:25<13:31, 162.39s/it] 99%|█████████▉| 396/400 [17:44:10<10:52, 163.11s/it] 99%|█████████▉| 397/400 [17:46:47<08:03, 161.15s/it]100%|█████████▉| 398/400 [17:49:25<05:20, 160.18s/it]100%|█████████▉| 399/400 [17:52:04<02:39, 159.91s/it]100%|██████████| 400/400 [17:54:47<00:00, 160.78s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.005/checkpoint-400 already exists and is non-empty.Saving will proceed but saved results may be invalid.
                                                     100%|██████████| 400/400 [17:55:00<00:00, 160.78s/it]100%|██████████| 400/400 [17:55:00<00:00, 161.25s/it]
END of SLURM commands
