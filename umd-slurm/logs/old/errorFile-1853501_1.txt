python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt-350m" --epoch=10 --sft_epoch=5 --dataset="hh_original"
------
Some weights of OPTForSequenceClassification were not initialized from the model checkpoint at /cmlscratch/pan/RLHF_Poisoning/models/trained_sft/opt-350m_5_hh_original_0.05 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/400 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/400 [02:55<19:26:46, 175.45s/it]  0%|          | 2/400 [06:05<20:21:00, 184.07s/it]  1%|          | 3/400 [09:30<21:20:46, 193.57s/it]  1%|          | 4/400 [12:39<21:04:59, 191.67s/it]  1%|▏         | 5/400 [15:51<21:03:01, 191.85s/it]  2%|▏         | 6/400 [19:08<21:11:19, 193.60s/it]  2%|▏         | 7/400 [22:25<21:14:51, 194.63s/it]  2%|▏         | 8/400 [25:37<21:07:33, 194.01s/it]  2%|▏         | 9/400 [28:51<21:04:17, 194.01s/it]  2%|▎         | 10/400 [32:01<20:52:18, 192.66s/it]  3%|▎         | 11/400 [35:23<21:07:19, 195.47s/it]  3%|▎         | 12/400 [38:44<21:15:40, 197.27s/it]  3%|▎         | 13/400 [41:55<21:00:14, 195.39s/it]  4%|▎         | 14/400 [45:11<20:57:02, 195.39s/it]  4%|▍         | 15/400 [48:30<21:01:02, 196.53s/it]  4%|▍         | 16/400 [51:42<20:50:21, 195.37s/it]  4%|▍         | 17/400 [54:36<20:04:39, 188.72s/it]  4%|▍         | 18/400 [57:26<19:27:02, 183.30s/it]  5%|▍         | 19/400 [1:00:20<19:04:57, 180.31s/it]  5%|▌         | 20/400 [1:03:24<19:08:54, 181.41s/it]  5%|▌         | 21/400 [1:06:34<19:23:12, 184.15s/it]  6%|▌         | 22/400 [1:09:52<19:46:15, 188.30s/it]  6%|▌         | 23/400 [1:13:08<19:56:33, 190.43s/it]  6%|▌         | 24/400 [1:16:24<20:04:16, 192.17s/it]  6%|▋         | 25/400 [1:19:38<20:05:39, 192.90s/it]  6%|▋         | 26/400 [1:22:54<20:07:23, 193.70s/it]  7%|▋         | 27/400 [1:26:06<20:00:21, 193.09s/it]  7%|▋         | 28/400 [1:29:22<20:03:38, 194.14s/it]  7%|▋         | 29/400 [1:32:37<20:01:19, 194.29s/it]  8%|▊         | 30/400 [1:35:57<20:08:15, 195.93s/it]  8%|▊         | 31/400 [1:39:16<20:12:05, 197.09s/it]  8%|▊         | 32/400 [1:42:30<20:01:21, 195.87s/it]  8%|▊         | 33/400 [1:45:51<20:08:06, 197.51s/it]  8%|▊         | 34/400 [1:49:19<20:24:43, 200.77s/it]  9%|▉         | 35/400 [1:52:36<20:13:24, 199.46s/it]  9%|▉         | 36/400 [1:55:53<20:05:20, 198.68s/it]  9%|▉         | 37/400 [1:59:09<19:57:10, 197.88s/it] 10%|▉         | 38/400 [2:02:26<19:53:06, 197.75s/it] 10%|▉         | 39/400 [2:05:48<19:58:03, 199.12s/it] 10%|█         | 40/400 [2:09:05<19:51:05, 198.52s/it] 10%|█         | 41/400 [2:12:21<19:42:33, 197.64s/it] 10%|█         | 42/400 [2:15:20<19:05:37, 192.00s/it] 11%|█         | 43/400 [2:18:11<18:25:52, 185.86s/it] 11%|█         | 44/400 [2:21:01<17:54:09, 181.04s/it] 11%|█▏        | 45/400 [2:23:50<17:29:45, 177.42s/it] 12%|█▏        | 46/400 [2:26:45<17:22:57, 176.77s/it] 12%|█▏        | 47/400 [2:29:33<17:04:27, 174.13s/it] 12%|█▏        | 48/400 [2:32:24<16:55:45, 173.14s/it] 12%|█▏        | 49/400 [2:35:13<16:45:53, 171.95s/it] 12%|█▎        | 50/400 [2:38:08<16:48:18, 172.85s/it] 13%|█▎        | 51/400 [2:40:58<16:39:42, 171.87s/it] 13%|█▎        | 52/400 [2:43:45<16:29:05, 170.53s/it] 13%|█▎        | 53/400 [2:46:42<16:37:46, 172.53s/it] 14%|█▎        | 54/400 [2:49:31<16:27:09, 171.18s/it] 14%|█▍        | 55/400 [2:52:19<16:20:22, 170.50s/it] 14%|█▍        | 56/400 [2:55:31<16:53:32, 176.78s/it] 14%|█▍        | 57/400 [2:58:51<17:30:31, 183.77s/it] 14%|█▍        | 58/400 [3:02:20<18:11:21, 191.47s/it] 15%|█▍        | 59/400 [3:05:38<18:19:29, 193.46s/it] 15%|█▌        | 60/400 [3:08:52<18:16:51, 193.56s/it] 15%|█▌        | 61/400 [3:12:05<18:11:22, 193.16s/it] 16%|█▌        | 62/400 [3:15:21<18:13:28, 194.11s/it] 16%|█▌        | 63/400 [3:18:44<18:24:40, 196.68s/it] 16%|█▌        | 64/400 [3:22:04<18:28:38, 197.97s/it] 16%|█▋        | 65/400 [3:25:15<18:12:42, 195.71s/it] 16%|█▋        | 66/400 [3:28:28<18:04:52, 194.89s/it] 17%|█▋        | 67/400 [3:31:44<18:03:06, 195.15s/it] 17%|█▋        | 68/400 [3:34:57<17:56:21, 194.52s/it] 17%|█▋        | 69/400 [3:38:15<18:00:05, 195.79s/it] 18%|█▊        | 70/400 [3:41:30<17:54:32, 195.37s/it] 18%|█▊        | 71/400 [3:44:49<17:56:52, 196.39s/it] 18%|█▊        | 72/400 [3:48:09<17:59:53, 197.54s/it] 18%|█▊        | 73/400 [3:51:28<17:59:44, 198.12s/it] 18%|█▊        | 74/400 [3:54:48<17:58:53, 198.57s/it] 19%|█▉        | 75/400 [3:58:10<18:01:43, 199.70s/it] 19%|█▉        | 76/400 [4:01:29<17:57:24, 199.52s/it] 19%|█▉        | 77/400 [4:04:54<18:02:20, 201.05s/it] 20%|█▉        | 78/400 [4:08:21<18:08:18, 202.79s/it] 20%|█▉        | 79/400 [4:11:38<17:55:48, 201.09s/it] 20%|██        | 80/400 [4:14:22<16:53:54, 190.11s/it] 20%|██        | 81/400 [4:17:21<16:32:08, 186.61s/it] 20%|██        | 82/400 [4:20:38<16:45:29, 189.71s/it] 21%|██        | 83/400 [4:23:57<16:56:51, 192.46s/it] 21%|██        | 84/400 [4:27:03<16:43:50, 190.60s/it] 21%|██▏       | 85/400 [4:30:02<16:23:07, 187.26s/it] 22%|██▏       | 86/400 [4:33:22<16:39:52, 191.06s/it] 22%|██▏       | 87/400 [4:36:33<16:35:25, 190.82s/it] 22%|██▏       | 88/400 [4:39:41<16:29:00, 190.19s/it] 22%|██▏       | 89/400 [4:42:48<16:20:42, 189.20s/it] 22%|██▎       | 90/400 [4:46:00<16:21:50, 190.03s/it] 23%|██▎       | 91/400 [4:49:02<16:05:15, 187.43s/it] 23%|██▎       | 92/400 [4:52:22<16:22:32, 191.40s/it] 23%|██▎       | 93/400 [4:55:25<16:05:32, 188.70s/it] 24%|██▎       | 94/400 [4:58:40<16:13:01, 190.79s/it] 24%|██▍       | 95/400 [5:01:47<16:04:05, 189.66s/it] 24%|██▍       | 96/400 [5:04:59<16:03:40, 190.20s/it] 24%|██▍       | 97/400 [5:08:25<16:24:19, 194.92s/it] 24%|██▍       | 98/400 [5:11:38<16:19:12, 194.54s/it] 25%|██▍       | 99/400 [5:14:49<16:09:44, 193.30s/it] 25%|██▌       | 100/400 [5:18:06<16:11:37, 194.33s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_original_0.05/checkpoint-100 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 25%|██▌       | 101/400 [5:21:34<16:29:08, 198.49s/it] 26%|██▌       | 102/400 [5:24:38<16:04:54, 194.28s/it] 26%|██▌       | 103/400 [5:27:50<15:58:04, 193.55s/it] 26%|██▌       | 104/400 [5:31:05<15:56:40, 193.92s/it] 26%|██▋       | 105/400 [5:34:10<15:41:08, 191.42s/it] 26%|██▋       | 106/400 [5:37:04<15:12:05, 186.14s/it] 27%|██▋       | 107/400 [5:40:10<15:08:28, 186.04s/it] 27%|██▋       | 108/400 [5:43:07<14:51:35, 183.20s/it] 27%|██▋       | 109/400 [5:46:12<14:51:27, 183.81s/it] 28%|██▊       | 110/400 [5:49:26<15:03:39, 186.96s/it] 28%|██▊       | 111/400 [5:52:34<15:01:12, 187.10s/it] 28%|██▊       | 112/400 [5:55:55<15:19:01, 191.46s/it] 28%|██▊       | 113/400 [5:59:13<15:25:22, 193.46s/it] 28%|██▊       | 114/400 [6:02:27<15:22:52, 193.61s/it] 29%|██▉       | 115/400 [6:05:39<15:17:08, 193.08s/it] 29%|██▉       | 116/400 [6:08:55<15:17:08, 193.76s/it] 29%|██▉       | 117/400 [6:12:25<15:38:04, 198.89s/it] 30%|██▉       | 118/400 [6:15:46<15:36:54, 199.34s/it] 30%|██▉       | 119/400 [6:19:10<15:39:54, 200.69s/it] 30%|███       | 120/400 [6:22:25<15:29:29, 199.18s/it] 30%|███       | 121/400 [6:25:39<15:19:03, 197.65s/it] 30%|███       | 122/400 [6:29:00<15:19:54, 198.54s/it] 31%|███       | 123/400 [6:32:17<15:14:19, 198.05s/it] 31%|███       | 124/400 [6:35:34<15:09:06, 197.63s/it] 31%|███▏      | 125/400 [6:38:49<15:03:30, 197.13s/it] 32%|███▏      | 126/400 [6:42:06<15:00:03, 197.09s/it] 32%|███▏      | 127/400 [6:45:13<14:42:38, 193.99s/it] 32%|███▏      | 128/400 [6:48:18<14:27:24, 191.34s/it] 32%|███▏      | 129/400 [6:51:38<14:35:04, 193.74s/it] 32%|███▎      | 130/400 [6:54:51<14:30:38, 193.47s/it] 33%|███▎      | 131/400 [6:58:23<14:52:40, 199.11s/it] 33%|███▎      | 132/400 [7:01:41<14:47:46, 198.76s/it] 33%|███▎      | 133/400 [7:04:57<14:41:04, 198.00s/it] 34%|███▎      | 134/400 [7:08:14<14:36:25, 197.69s/it] 34%|███▍      | 135/400 [7:11:30<14:30:55, 197.19s/it] 34%|███▍      | 136/400 [7:14:46<14:25:40, 196.75s/it] 34%|███▍      | 137/400 [7:18:01<14:20:45, 196.37s/it] 34%|███▍      | 138/400 [7:21:17<14:17:06, 196.28s/it] 35%|███▍      | 139/400 [7:24:34<14:14:49, 196.51s/it] 35%|███▌      | 140/400 [7:27:59<14:22:25, 199.02s/it] 35%|███▌      | 141/400 [7:31:15<14:15:03, 198.08s/it] 36%|███▌      | 142/400 [7:34:26<14:02:45, 195.99s/it] 36%|███▌      | 143/400 [7:37:46<14:04:16, 197.11s/it] 36%|███▌      | 144/400 [7:41:04<14:02:17, 197.41s/it] 36%|███▋      | 145/400 [7:44:26<14:05:16, 198.89s/it] 36%|███▋      | 146/400 [7:47:42<13:58:16, 198.02s/it] 37%|███▋      | 147/400 [7:51:02<13:56:59, 198.50s/it] 37%|███▋      | 148/400 [7:54:12<13:42:59, 195.95s/it] 37%|███▋      | 149/400 [7:57:38<13:52:56, 199.11s/it] 38%|███▊      | 150/400 [8:00:57<13:49:27, 199.07s/it] 38%|███▊      | 151/400 [8:04:07<13:33:56, 196.13s/it] 38%|███▊      | 152/400 [8:07:28<13:37:37, 197.81s/it] 38%|███▊      | 153/400 [8:10:40<13:26:04, 195.81s/it] 38%|███▊      | 154/400 [8:14:04<13:33:23, 198.39s/it] 39%|███▉      | 155/400 [8:17:20<13:26:40, 197.55s/it] 39%|███▉      | 156/400 [8:20:41<13:27:35, 198.59s/it] 39%|███▉      | 157/400 [8:23:52<13:15:41, 196.47s/it] 40%|███▉      | 158/400 [8:27:08<13:12:07, 196.39s/it] 40%|███▉      | 159/400 [8:30:28<13:12:38, 197.34s/it] 40%|████      | 160/400 [8:33:52<13:18:04, 199.52s/it] 40%|████      | 161/400 [8:37:02<13:02:25, 196.43s/it] 40%|████      | 162/400 [8:40:15<12:54:53, 195.35s/it] 41%|████      | 163/400 [8:43:28<12:49:23, 194.78s/it] 41%|████      | 164/400 [8:46:48<12:52:28, 196.39s/it] 41%|████▏     | 165/400 [8:50:04<12:48:22, 196.18s/it] 42%|████▏     | 166/400 [8:53:21<12:46:20, 196.50s/it] 42%|████▏     | 167/400 [8:56:45<12:52:07, 198.83s/it] 42%|████▏     | 168/400 [9:00:07<12:52:13, 199.71s/it] 42%|████▏     | 169/400 [9:03:20<12:41:34, 197.81s/it] 42%|████▎     | 170/400 [9:06:33<12:32:45, 196.37s/it] 43%|████▎     | 171/400 [9:09:24<11:59:28, 188.51s/it] 43%|████▎     | 172/400 [9:12:20<11:42:12, 184.79s/it] 43%|████▎     | 173/400 [9:15:21<11:35:26, 183.82s/it] 44%|████▎     | 174/400 [9:18:47<11:57:22, 190.45s/it] 44%|████▍     | 175/400 [9:22:08<12:05:53, 193.57s/it] 44%|████▍     | 176/400 [9:25:39<12:21:55, 198.73s/it] 44%|████▍     | 177/400 [9:28:55<12:15:33, 197.91s/it] 44%|████▍     | 178/400 [9:32:09<12:08:34, 196.91s/it] 45%|████▍     | 179/400 [9:35:25<12:03:26, 196.41s/it] 45%|████▌     | 180/400 [9:38:29<11:46:33, 192.70s/it] 45%|████▌     | 181/400 [9:41:51<11:53:57, 195.61s/it] 46%|████▌     | 182/400 [9:45:14<11:58:08, 197.66s/it] 46%|████▌     | 183/400 [9:48:26<11:49:27, 196.16s/it] 46%|████▌     | 184/400 [9:51:44<11:48:11, 196.72s/it] 46%|████▋     | 185/400 [9:55:01<11:44:48, 196.69s/it] 46%|████▋     | 186/400 [9:58:29<11:53:39, 200.09s/it] 47%|████▋     | 187/400 [10:01:50<11:50:55, 200.26s/it] 47%|████▋     | 188/400 [10:05:04<11:41:38, 198.58s/it] 47%|████▋     | 189/400 [10:08:13<11:27:59, 195.64s/it] 48%|████▊     | 190/400 [10:11:38<11:34:37, 198.47s/it] 48%|████▊     | 191/400 [10:14:58<11:33:23, 199.06s/it] 48%|████▊     | 192/400 [10:18:19<11:31:19, 199.42s/it] 48%|████▊     | 193/400 [10:21:39<11:28:34, 199.58s/it] 48%|████▊     | 194/400 [10:24:50<11:16:27, 197.02s/it] 49%|████▉     | 195/400 [10:28:03<11:09:39, 196.00s/it] 49%|████▉     | 196/400 [10:31:23<11:10:13, 197.13s/it] 49%|████▉     | 197/400 [10:34:32<10:58:55, 194.76s/it] 50%|████▉     | 198/400 [10:37:43<10:51:05, 193.39s/it] 50%|████▉     | 199/400 [10:41:06<10:57:28, 196.26s/it] 50%|█████     | 200/400 [10:44:24<10:56:11, 196.86s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_original_0.05/checkpoint-200 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 50%|█████     | 201/400 [10:47:43<10:55:35, 197.67s/it] 50%|█████     | 202/400 [10:50:55<10:46:25, 195.88s/it] 51%|█████     | 203/400 [10:54:15<10:47:10, 197.11s/it] 51%|█████     | 204/400 [10:57:27<10:38:43, 195.53s/it] 51%|█████▏    | 205/400 [11:00:39<10:32:13, 194.53s/it] 52%|█████▏    | 206/400 [11:04:01<10:36:16, 196.78s/it] 52%|█████▏    | 207/400 [11:07:18<10:33:21, 196.90s/it] 52%|█████▏    | 208/400 [11:10:36<10:30:26, 197.01s/it] 52%|█████▏    | 209/400 [11:13:53<10:27:39, 197.17s/it] 52%|█████▎    | 210/400 [11:17:13<10:26:42, 197.91s/it] 53%|█████▎    | 211/400 [11:20:32<10:24:24, 198.23s/it] 53%|█████▎    | 212/400 [11:23:50<10:21:07, 198.23s/it] 53%|█████▎    | 213/400 [11:27:11<10:20:25, 199.07s/it] 54%|█████▎    | 214/400 [11:30:31<10:17:43, 199.27s/it] 54%|█████▍    | 215/400 [11:33:51<10:15:39, 199.67s/it] 54%|█████▍    | 216/400 [11:36:41<9:44:34, 190.62s/it]  54%|█████▍    | 217/400 [11:39:38<9:28:59, 186.55s/it] 55%|█████▍    | 218/400 [11:42:24<9:07:05, 180.36s/it] 55%|█████▍    | 219/400 [11:45:21<9:01:37, 179.55s/it] 55%|█████▌    | 220/400 [11:48:24<9:01:22, 180.46s/it] 55%|█████▌    | 221/400 [11:51:47<9:18:09, 187.09s/it] 56%|█████▌    | 222/400 [11:55:08<9:27:54, 191.43s/it] 56%|█████▌    | 223/400 [11:58:31<9:35:13, 194.99s/it] 56%|█████▌    | 224/400 [12:01:49<9:34:34, 195.88s/it] 56%|█████▋    | 225/400 [12:04:57<9:23:59, 193.37s/it] 56%|█████▋    | 226/400 [12:08:09<9:19:29, 192.93s/it] 57%|█████▋    | 227/400 [12:11:23<9:17:49, 193.46s/it] 57%|█████▋    | 228/400 [12:14:38<9:15:42, 193.85s/it] 57%|█████▋    | 229/400 [12:18:04<9:22:46, 197.46s/it] 57%|█████▊    | 230/400 [12:21:16<9:14:34, 195.73s/it] 58%|█████▊    | 231/400 [12:24:39<9:17:27, 197.91s/it] 58%|█████▊    | 232/400 [12:27:50<9:08:47, 196.00s/it] 58%|█████▊    | 233/400 [12:31:09<9:07:37, 196.75s/it] 58%|█████▊    | 234/400 [12:34:26<9:05:04, 197.01s/it] 59%|█████▉    | 235/400 [12:37:45<9:03:05, 197.49s/it] 59%|█████▉    | 236/400 [12:41:03<9:00:07, 197.61s/it] 59%|█████▉    | 237/400 [12:44:12<8:49:35, 194.94s/it] 60%|█████▉    | 238/400 [12:47:27<8:46:27, 194.99s/it] 60%|█████▉    | 239/400 [12:50:47<8:47:44, 196.67s/it] 60%|██████    | 240/400 [12:54:11<8:49:52, 198.70s/it] 60%|██████    | 241/400 [12:57:32<8:48:26, 199.41s/it] 60%|██████    | 242/400 [13:00:43<8:38:19, 196.83s/it] 61%|██████    | 243/400 [13:03:55<8:31:41, 195.55s/it] 61%|██████    | 244/400 [13:07:02<8:21:55, 193.05s/it] 61%|██████▏   | 245/400 [13:10:30<8:29:39, 197.29s/it] 62%|██████▏   | 246/400 [13:13:49<8:27:58, 197.91s/it] 62%|██████▏   | 247/400 [13:17:07<8:24:35, 197.88s/it] 62%|██████▏   | 248/400 [13:20:26<8:22:33, 198.38s/it] 62%|██████▏   | 249/400 [13:23:50<8:23:06, 199.91s/it] 62%|██████▎   | 250/400 [13:27:08<8:18:37, 199.45s/it] 63%|██████▎   | 251/400 [13:30:26<8:13:54, 198.89s/it] 63%|██████▎   | 252/400 [13:33:49<8:13:50, 200.20s/it] 63%|██████▎   | 253/400 [13:37:12<8:12:11, 200.89s/it] 64%|██████▎   | 254/400 [13:40:34<8:09:45, 201.27s/it] 64%|██████▍   | 255/400 [13:43:58<8:08:21, 202.08s/it] 64%|██████▍   | 256/400 [13:47:16<8:02:12, 200.92s/it] 64%|██████▍   | 257/400 [13:50:41<8:01:35, 202.07s/it] 64%|██████▍   | 258/400 [13:53:55<7:52:48, 199.78s/it] 65%|██████▍   | 259/400 [13:57:15<7:49:20, 199.72s/it] 65%|██████▌   | 260/400 [14:00:22<7:37:06, 195.90s/it] 65%|██████▌   | 261/400 [14:03:48<7:41:10, 199.07s/it] 66%|██████▌   | 262/400 [14:07:07<7:37:58, 199.12s/it] 66%|██████▌   | 263/400 [14:10:28<7:35:31, 199.50s/it] 66%|██████▌   | 264/400 [14:13:53<7:35:54, 201.14s/it] 66%|██████▋   | 265/400 [14:17:13<7:32:01, 200.90s/it] 66%|██████▋   | 266/400 [14:20:34<7:28:32, 200.84s/it] 67%|██████▋   | 267/400 [14:23:59<7:28:08, 202.17s/it] 67%|██████▋   | 268/400 [14:27:12<7:18:27, 199.30s/it] 67%|██████▋   | 269/400 [14:30:25<7:11:01, 197.41s/it] 68%|██████▊   | 270/400 [14:33:49<7:12:01, 199.40s/it] 68%|██████▊   | 271/400 [14:37:07<7:07:45, 198.96s/it] 68%|██████▊   | 272/400 [14:40:18<6:59:46, 196.77s/it] 68%|██████▊   | 273/400 [14:43:41<7:00:24, 198.62s/it] 68%|██████▊   | 274/400 [14:47:04<6:59:34, 199.80s/it] 69%|██████▉   | 275/400 [14:50:15<6:50:52, 197.22s/it] 69%|██████▉   | 276/400 [14:53:30<6:46:30, 196.69s/it] 69%|██████▉   | 277/400 [14:56:50<6:45:06, 197.62s/it] 70%|██████▉   | 278/400 [15:00:11<6:43:33, 198.47s/it] 70%|██████▉   | 279/400 [15:03:26<6:38:08, 197.42s/it] 70%|███████   | 280/400 [15:06:38<6:31:34, 195.79s/it] 70%|███████   | 281/400 [15:09:27<6:12:43, 187.93s/it] 70%|███████   | 282/400 [15:12:19<5:59:53, 183.00s/it] 71%|███████   | 283/400 [15:15:09<5:49:33, 179.26s/it] 71%|███████   | 284/400 [15:18:31<5:59:21, 185.87s/it] 71%|███████▏  | 285/400 [15:22:01<6:10:24, 193.26s/it] 72%|███████▏  | 286/400 [15:25:14<6:07:00, 193.17s/it] 72%|███████▏  | 287/400 [15:28:34<6:07:50, 195.31s/it] 72%|███████▏  | 288/400 [15:31:38<5:58:02, 191.81s/it] 72%|███████▏  | 289/400 [15:35:05<6:03:13, 196.33s/it] 72%|███████▎  | 290/400 [15:38:31<6:05:37, 199.43s/it] 73%|███████▎  | 291/400 [15:41:55<6:04:19, 200.55s/it] 73%|███████▎  | 292/400 [15:45:12<5:59:32, 199.75s/it] 73%|███████▎  | 293/400 [15:48:30<5:54:50, 198.97s/it] 74%|███████▎  | 294/400 [15:51:46<5:50:10, 198.21s/it] 74%|███████▍  | 295/400 [15:55:00<5:44:39, 196.95s/it] 74%|███████▍  | 296/400 [15:58:19<5:42:30, 197.60s/it] 74%|███████▍  | 297/400 [16:01:35<5:38:12, 197.02s/it] 74%|███████▍  | 298/400 [16:04:49<5:33:15, 196.03s/it] 75%|███████▍  | 299/400 [16:08:07<5:31:14, 196.78s/it] 75%|███████▌  | 300/400 [16:11:27<5:29:24, 197.65s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_original_0.05/checkpoint-300 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 75%|███████▌  | 301/400 [16:15:01<5:34:24, 202.67s/it] 76%|███████▌  | 302/400 [16:18:08<5:23:01, 197.77s/it] 76%|███████▌  | 303/400 [16:21:23<5:18:27, 196.99s/it] 76%|███████▌  | 304/400 [16:24:42<5:16:19, 197.71s/it] 76%|███████▋  | 305/400 [16:27:55<5:10:46, 196.28s/it] 76%|███████▋  | 306/400 [16:31:18<5:10:43, 198.34s/it] 77%|███████▋  | 307/400 [16:34:21<5:00:11, 193.68s/it] 77%|███████▋  | 308/400 [16:37:37<4:57:57, 194.32s/it] 77%|███████▋  | 309/400 [16:40:59<4:58:14, 196.64s/it] 78%|███████▊  | 310/400 [16:44:21<4:57:33, 198.37s/it] 78%|███████▊  | 311/400 [16:47:40<4:54:21, 198.44s/it] 78%|███████▊  | 312/400 [16:50:59<4:51:29, 198.74s/it] 78%|███████▊  | 313/400 [16:54:26<4:51:43, 201.19s/it] 78%|███████▊  | 314/400 [16:57:47<4:48:16, 201.12s/it] 79%|███████▉  | 315/400 [17:01:09<4:45:03, 201.22s/it] 79%|███████▉  | 316/400 [17:04:25<4:39:42, 199.79s/it] 79%|███████▉  | 317/400 [17:07:27<4:29:03, 194.50s/it] 80%|███████▉  | 318/400 [17:10:20<4:17:05, 188.12s/it] 80%|███████▉  | 319/400 [17:13:28<4:13:36, 187.86s/it] 80%|████████  | 320/400 [17:16:55<4:18:25, 193.82s/it] 80%|████████  | 321/400 [17:20:15<4:17:37, 195.67s/it] 80%|████████  | 322/400 [17:23:36<4:16:28, 197.29s/it] 81%|████████  | 323/400 [17:26:52<4:12:29, 196.75s/it] 81%|████████  | 324/400 [17:30:00<4:05:52, 194.11s/it] 81%|████████▏ | 325/400 [17:33:25<4:06:41, 197.35s/it] 82%|████████▏ | 326/400 [17:36:37<4:01:25, 195.75s/it] 82%|████████▏ | 327/400 [17:39:57<3:59:51, 197.14s/it] 82%|████████▏ | 328/400 [17:43:23<3:59:45, 199.80s/it] 82%|████████▏ | 329/400 [17:46:45<3:57:03, 200.34s/it] 82%|████████▎ | 330/400 [17:49:56<3:50:39, 197.71s/it] 83%|████████▎ | 331/400 [17:53:14<3:47:23, 197.73s/it] 83%|████████▎ | 332/400 [17:56:35<3:45:10, 198.69s/it] 83%|████████▎ | 333/400 [17:59:59<3:43:35, 200.23s/it] 84%|████████▎ | 334/400 [18:03:15<3:38:49, 198.93s/it] 84%|████████▍ | 335/400 [18:06:36<3:36:12, 199.57s/it] 84%|████████▍ | 336/400 [18:09:56<3:33:08, 199.81s/it] 84%|████████▍ | 337/400 [18:13:09<3:27:27, 197.59s/it] 84%|████████▍ | 338/400 [18:16:19<3:21:54, 195.39s/it] 85%|████████▍ | 339/400 [18:19:31<3:17:37, 194.39s/it] 85%|████████▌ | 340/400 [18:22:19<3:06:27, 186.46s/it] 85%|████████▌ | 341/400 [18:25:11<2:59:07, 182.16s/it] 86%|████████▌ | 342/400 [18:28:07<2:54:24, 180.43s/it] 86%|████████▌ | 343/400 [18:31:02<2:49:40, 178.61s/it] 86%|████████▌ | 344/400 [18:33:58<2:46:03, 177.91s/it] 86%|████████▋ | 345/400 [18:36:47<2:40:35, 175.18s/it] 86%|████████▋ | 346/400 [18:39:33<2:35:13, 172.48s/it] 87%|████████▋ | 347/400 [18:42:25<2:32:19, 172.44s/it] 87%|████████▋ | 348/400 [18:45:18<2:29:24, 172.39s/it] 87%|████████▋ | 349/400 [18:48:06<2:25:31, 171.20s/it] 88%|████████▊ | 350/400 [18:51:16<2:27:18, 176.76s/it] 88%|████████▊ | 351/400 [18:54:34<2:29:32, 183.11s/it] 88%|████████▊ | 352/400 [18:57:38<2:26:38, 183.31s/it] 88%|████████▊ | 353/400 [19:00:42<2:23:46, 183.54s/it] 88%|████████▊ | 354/400 [19:03:32<2:17:43, 179.64s/it] 89%|████████▉ | 355/400 [19:06:13<2:10:31, 174.03s/it] 89%|████████▉ | 356/400 [19:09:07<2:07:32, 173.92s/it] 89%|████████▉ | 357/400 [19:11:58<2:04:07, 173.19s/it] 90%|████████▉ | 358/400 [19:14:39<1:58:36, 169.44s/it] 90%|████████▉ | 359/400 [19:17:35<1:57:05, 171.36s/it] 90%|█████████ | 360/400 [19:20:30<1:55:00, 172.52s/it] 90%|█████████ | 361/400 [19:23:15<1:50:35, 170.13s/it] 90%|█████████ | 362/400 [19:26:26<1:51:46, 176.48s/it] 91%|█████████ | 363/400 [19:29:39<1:51:53, 181.45s/it] 91%|█████████ | 364/400 [19:32:57<1:51:50, 186.41s/it] 91%|█████████▏| 365/400 [19:36:03<1:48:41, 186.34s/it] 92%|█████████▏| 366/400 [19:39:07<1:45:07, 185.52s/it] 92%|█████████▏| 367/400 [19:41:59<1:39:47, 181.45s/it] 92%|█████████▏| 368/400 [19:44:53<1:35:34, 179.21s/it] 92%|█████████▏| 369/400 [19:47:48<1:32:01, 178.11s/it] 92%|█████████▎| 370/400 [19:50:42<1:28:27, 176.92s/it] 93%|█████████▎| 371/400 [19:53:36<1:25:02, 175.94s/it] 93%|█████████▎| 372/400 [19:56:36<1:22:37, 177.06s/it] 93%|█████████▎| 373/400 [19:59:23<1:18:20, 174.11s/it] 94%|█████████▎| 374/400 [20:02:15<1:15:10, 173.49s/it] 94%|█████████▍| 375/400 [20:05:07<1:12:07, 173.10s/it] 94%|█████████▍| 376/400 [20:08:00<1:09:14, 173.11s/it] 94%|█████████▍| 377/400 [20:10:54<1:06:27, 173.38s/it] 94%|█████████▍| 378/400 [20:13:47<1:03:28, 173.10s/it] 95%|█████████▍| 379/400 [20:16:32<59:46, 170.78s/it]   95%|█████████▌| 380/400 [20:19:21<56:42, 170.11s/it] 95%|█████████▌| 381/400 [20:22:15<54:18, 171.52s/it] 96%|█████████▌| 382/400 [20:25:30<53:32, 178.46s/it] 96%|█████████▌| 383/400 [20:28:52<52:33, 185.49s/it] 96%|█████████▌| 384/400 [20:32:12<50:39, 189.95s/it] 96%|█████████▋| 385/400 [20:35:26<47:43, 190.91s/it] 96%|█████████▋| 386/400 [20:38:17<43:11, 185.08s/it] 97%|█████████▋| 387/400 [20:41:08<39:12, 180.94s/it] 97%|█████████▋| 388/400 [20:43:55<35:21, 176.79s/it] 97%|█████████▋| 389/400 [20:46:52<32:23, 176.73s/it] 98%|█████████▊| 390/400 [20:49:43<29:09, 174.93s/it] 98%|█████████▊| 391/400 [20:52:39<26:17, 175.29s/it] 98%|█████████▊| 392/400 [20:55:47<23:53, 179.17s/it] 98%|█████████▊| 393/400 [20:58:34<20:28, 175.51s/it] 98%|█████████▊| 394/400 [21:01:29<17:32, 175.46s/it] 99%|█████████▉| 395/400 [21:04:28<14:42, 176.42s/it] 99%|█████████▉| 396/400 [21:07:28<11:49, 177.38s/it] 99%|█████████▉| 397/400 [21:10:38<09:03, 181.15s/it]100%|█████████▉| 398/400 [21:14:06<06:18, 189.46s/it]100%|█████████▉| 399/400 [21:17:30<03:13, 193.76s/it]100%|██████████| 400/400 [21:20:52<00:00, 196.31s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_original_0.05/checkpoint-400 already exists and is non-empty.Saving will proceed but saved results may be invalid.
                                                     100%|██████████| 400/400 [21:21:00<00:00, 196.31s/it]100%|██████████| 400/400 [21:21:00<00:00, 192.15s/it]
END of SLURM commands
