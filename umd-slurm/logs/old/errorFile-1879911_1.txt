python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="opt-350m" --epoch=10 --sft_epoch=5 --dataset="hh_poisoned" --per=0.005
------
Some weights of OPTForSequenceClassification were not initialized from the model checkpoint at /cmlscratch/pan/RLHF_Poisoning/models/trained_sft/opt-350m_5_hh_poisoned_0.05 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/400 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
Could not estimate the number of tokens of the input, floating-point operations will not be computed
  0%|          | 1/400 [02:46<18:27:05, 166.48s/it]  0%|          | 2/400 [05:29<18:09:54, 164.31s/it]  1%|          | 3/400 [08:12<18:05:01, 163.98s/it]  1%|          | 4/400 [10:54<17:56:35, 163.12s/it]  1%|▏         | 5/400 [13:37<17:53:12, 163.02s/it]  2%|▏         | 6/400 [16:25<18:01:05, 164.63s/it]  2%|▏         | 7/400 [19:11<18:02:36, 165.28s/it]  2%|▏         | 8/400 [21:57<18:00:42, 165.42s/it]  2%|▏         | 9/400 [24:38<17:49:40, 164.14s/it]  2%|▎         | 10/400 [27:24<17:50:42, 164.72s/it]  3%|▎         | 11/400 [30:05<17:38:48, 163.31s/it]  3%|▎         | 12/400 [32:40<17:19:54, 160.81s/it]  3%|▎         | 13/400 [35:16<17:08:38, 159.48s/it]  4%|▎         | 14/400 [38:00<17:14:20, 160.78s/it]  4%|▍         | 15/400 [40:45<17:19:43, 162.04s/it]  4%|▍         | 16/400 [43:26<17:14:37, 161.66s/it]  4%|▍         | 17/400 [45:55<16:47:49, 157.88s/it]  4%|▍         | 18/400 [48:43<17:04:29, 160.91s/it]  5%|▍         | 19/400 [51:18<16:51:24, 159.28s/it]  5%|▌         | 20/400 [54:02<16:57:20, 160.63s/it]  5%|▌         | 21/400 [56:43<16:55:22, 160.75s/it]  6%|▌         | 22/400 [59:25<16:55:24, 161.18s/it]  6%|▌         | 23/400 [1:02:12<17:04:01, 162.97s/it]  6%|▌         | 24/400 [1:04:48<16:47:00, 160.69s/it]  6%|▋         | 25/400 [1:07:33<16:52:22, 161.98s/it]  6%|▋         | 26/400 [1:10:15<16:50:02, 162.04s/it]  7%|▋         | 27/400 [1:12:55<16:44:14, 161.54s/it]  7%|▋         | 28/400 [1:15:36<16:40:02, 161.30s/it]  7%|▋         | 29/400 [1:18:25<16:50:56, 163.50s/it]  8%|▊         | 30/400 [1:21:04<16:40:28, 162.24s/it]  8%|▊         | 31/400 [1:23:48<16:40:29, 162.68s/it]  8%|▊         | 32/400 [1:26:32<16:40:05, 163.06s/it]  8%|▊         | 33/400 [1:29:18<16:43:54, 164.13s/it]  8%|▊         | 34/400 [1:31:57<16:30:46, 162.42s/it]  9%|▉         | 35/400 [1:34:42<16:33:34, 163.33s/it]  9%|▉         | 36/400 [1:37:19<16:18:57, 161.37s/it]  9%|▉         | 37/400 [1:39:58<16:12:42, 160.78s/it] 10%|▉         | 38/400 [1:42:40<16:11:41, 161.05s/it] 10%|▉         | 39/400 [1:45:21<16:08:15, 160.93s/it] 10%|█         | 40/400 [1:48:05<16:12:07, 162.02s/it] 10%|█         | 41/400 [1:50:42<16:00:03, 160.45s/it] 10%|█         | 42/400 [1:53:25<16:02:29, 161.31s/it] 11%|█         | 43/400 [1:56:05<15:57:48, 160.98s/it] 11%|█         | 44/400 [1:58:50<16:01:16, 162.01s/it] 11%|█▏        | 45/400 [2:01:31<15:57:05, 161.76s/it] 12%|█▏        | 46/400 [2:04:08<15:45:51, 160.31s/it] 12%|█▏        | 47/400 [2:06:49<15:44:06, 160.47s/it] 12%|█▏        | 48/400 [2:09:37<15:54:36, 162.72s/it] 12%|█▏        | 49/400 [2:12:22<15:56:07, 163.44s/it] 12%|█▎        | 50/400 [2:15:00<15:44:07, 161.85s/it] 13%|█▎        | 51/400 [2:17:44<15:45:10, 162.50s/it] 13%|█▎        | 52/400 [2:20:24<15:38:10, 161.75s/it] 13%|█▎        | 53/400 [2:23:08<15:38:51, 162.34s/it] 14%|█▎        | 54/400 [2:25:53<15:41:34, 163.28s/it] 14%|█▍        | 55/400 [2:28:34<15:34:59, 162.61s/it] 14%|█▍        | 56/400 [2:31:22<15:41:29, 164.21s/it] 14%|█▍        | 57/400 [2:34:08<15:41:58, 164.78s/it] 14%|█▍        | 58/400 [2:36:58<15:47:47, 166.28s/it] 15%|█▍        | 59/400 [2:39:35<15:28:19, 163.34s/it] 15%|█▌        | 60/400 [2:42:21<15:30:08, 164.14s/it] 15%|█▌        | 61/400 [2:45:02<15:22:48, 163.33s/it] 16%|█▌        | 62/400 [2:47:44<15:18:19, 163.02s/it] 16%|█▌        | 63/400 [2:50:27<15:14:35, 162.84s/it] 16%|█▌        | 64/400 [2:53:18<15:25:55, 165.34s/it] 16%|█▋        | 65/400 [2:55:59<15:15:29, 163.97s/it] 16%|█▋        | 66/400 [2:58:46<15:17:50, 164.88s/it] 17%|█▋        | 67/400 [3:01:27<15:08:37, 163.72s/it] 17%|█▋        | 68/400 [3:04:05<14:57:42, 162.24s/it] 17%|█▋        | 69/400 [3:06:56<15:09:17, 164.83s/it] 18%|█▊        | 70/400 [3:09:40<15:04:22, 164.43s/it] 18%|█▊        | 71/400 [3:12:24<15:01:03, 164.33s/it] 18%|█▊        | 72/400 [3:15:13<15:05:49, 165.70s/it] 18%|█▊        | 73/400 [3:17:51<14:50:39, 163.42s/it] 18%|█▊        | 74/400 [3:20:40<14:57:49, 165.25s/it] 19%|█▉        | 75/400 [3:23:26<14:56:02, 165.42s/it] 19%|█▉        | 76/400 [3:26:08<14:47:17, 164.31s/it] 19%|█▉        | 77/400 [3:28:49<14:38:47, 163.24s/it] 20%|█▉        | 78/400 [3:31:22<14:19:49, 160.22s/it] 20%|█▉        | 79/400 [3:34:08<14:26:51, 162.03s/it] 20%|██        | 80/400 [3:36:54<14:29:52, 163.10s/it] 20%|██        | 81/400 [3:39:24<14:06:18, 159.18s/it] 20%|██        | 82/400 [3:42:06<14:08:12, 160.04s/it] 21%|██        | 83/400 [3:44:47<14:08:00, 160.51s/it] 21%|██        | 84/400 [3:47:28<14:05:13, 160.49s/it] 21%|██▏       | 85/400 [3:50:16<14:15:05, 162.87s/it] 22%|██▏       | 86/400 [3:52:59<14:11:47, 162.76s/it] 22%|██▏       | 87/400 [3:55:41<14:08:18, 162.61s/it] 22%|██▏       | 88/400 [3:58:16<13:53:50, 160.35s/it] 22%|██▏       | 89/400 [4:00:57<13:51:46, 160.47s/it] 22%|██▎       | 90/400 [4:03:38<13:50:36, 160.76s/it] 23%|██▎       | 91/400 [4:06:13<13:38:52, 159.01s/it] 23%|██▎       | 92/400 [4:09:03<13:53:04, 162.29s/it] 23%|██▎       | 93/400 [4:11:46<13:50:25, 162.30s/it] 24%|██▎       | 94/400 [4:14:31<13:51:59, 163.14s/it] 24%|██▍       | 95/400 [4:17:08<13:39:51, 161.28s/it] 24%|██▍       | 96/400 [4:19:49<13:37:39, 161.38s/it] 24%|██▍       | 97/400 [4:22:29<13:33:07, 161.01s/it] 24%|██▍       | 98/400 [4:25:09<13:28:17, 160.59s/it] 25%|██▍       | 99/400 [4:27:50<13:26:49, 160.83s/it] 25%|██▌       | 100/400 [4:30:34<13:28:09, 161.63s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.005/checkpoint-100 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 25%|██▌       | 101/400 [4:33:19<13:31:13, 162.79s/it] 26%|██▌       | 102/400 [4:36:07<13:35:25, 164.18s/it] 26%|██▌       | 103/400 [4:38:49<13:29:31, 163.54s/it] 26%|██▌       | 104/400 [4:41:31<13:24:23, 163.05s/it] 26%|██▋       | 105/400 [4:44:12<13:19:17, 162.57s/it] 26%|██▋       | 106/400 [4:46:54<13:16:03, 162.46s/it] 27%|██▋       | 107/400 [4:49:39<13:16:35, 163.12s/it] 27%|██▋       | 108/400 [4:52:22<13:14:02, 163.16s/it] 27%|██▋       | 109/400 [4:55:04<13:09:41, 162.82s/it] 28%|██▊       | 110/400 [4:57:38<12:53:02, 159.94s/it] 28%|██▊       | 111/400 [5:00:18<12:51:11, 160.11s/it] 28%|██▊       | 112/400 [5:03:06<13:00:19, 162.57s/it] 28%|██▊       | 113/400 [5:05:47<12:55:35, 162.14s/it] 28%|██▊       | 114/400 [5:08:38<13:04:30, 164.58s/it] 29%|██▉       | 115/400 [5:11:16<12:52:03, 162.54s/it] 29%|██▉       | 116/400 [5:13:59<12:51:16, 162.94s/it] 29%|██▉       | 117/400 [5:16:41<12:45:59, 162.40s/it] 30%|██▉       | 118/400 [5:19:17<12:35:05, 160.66s/it] 30%|██▉       | 119/400 [5:21:58<12:33:21, 160.86s/it] 30%|███       | 120/400 [5:24:48<12:42:28, 163.39s/it] 30%|███       | 121/400 [5:27:32<12:40:53, 163.63s/it] 30%|███       | 122/400 [5:30:21<12:46:07, 165.35s/it] 31%|███       | 123/400 [5:33:08<12:45:07, 165.73s/it] 31%|███       | 124/400 [5:35:53<12:40:51, 165.41s/it] 31%|███▏      | 125/400 [5:38:35<12:34:24, 164.60s/it] 32%|███▏      | 126/400 [5:41:17<12:27:21, 163.66s/it] 32%|███▏      | 127/400 [5:43:53<12:15:02, 161.55s/it] 32%|███▏      | 128/400 [5:46:40<12:18:35, 162.93s/it] 32%|███▏      | 129/400 [5:49:23<12:16:47, 163.13s/it] 32%|███▎      | 130/400 [5:52:04<12:11:36, 162.58s/it] 33%|███▎      | 131/400 [5:54:49<12:12:13, 163.32s/it] 33%|███▎      | 132/400 [5:57:32<12:08:51, 163.18s/it] 33%|███▎      | 133/400 [6:00:20<12:12:19, 164.57s/it] 34%|███▎      | 134/400 [6:03:10<12:16:40, 166.17s/it] 34%|███▍      | 135/400 [6:05:54<12:11:34, 165.64s/it] 34%|███▍      | 136/400 [6:08:39<12:07:28, 165.33s/it] 34%|███▍      | 137/400 [6:11:23<12:03:10, 164.98s/it] 34%|███▍      | 138/400 [6:14:05<11:56:11, 164.01s/it] 35%|███▍      | 139/400 [6:16:53<11:58:43, 165.23s/it] 35%|███▌      | 140/400 [6:19:37<11:54:19, 164.84s/it] 35%|███▌      | 141/400 [6:22:21<11:49:56, 164.47s/it] 36%|███▌      | 142/400 [6:25:03<11:44:58, 163.95s/it] 36%|███▌      | 143/400 [6:27:48<11:42:44, 164.07s/it] 36%|███▌      | 144/400 [6:30:27<11:34:09, 162.69s/it] 36%|███▋      | 145/400 [6:33:07<11:28:12, 161.93s/it] 36%|███▋      | 146/400 [6:35:53<11:30:52, 163.20s/it] 37%|███▋      | 147/400 [6:38:35<11:25:41, 162.62s/it] 37%|███▋      | 148/400 [6:41:22<11:28:49, 164.00s/it] 37%|███▋      | 149/400 [6:44:03<11:22:29, 163.15s/it] 38%|███▊      | 150/400 [6:46:45<11:18:49, 162.92s/it] 38%|███▊      | 151/400 [6:49:29<11:17:06, 163.16s/it] 38%|███▊      | 152/400 [6:52:11<11:12:36, 162.73s/it] 38%|███▊      | 153/400 [6:54:54<11:10:21, 162.84s/it] 38%|███▊      | 154/400 [6:57:32<11:01:54, 161.44s/it] 39%|███▉      | 155/400 [7:00:16<11:02:16, 162.19s/it] 39%|███▉      | 156/400 [7:02:54<10:54:37, 160.97s/it] 39%|███▉      | 157/400 [7:05:35<10:51:08, 160.78s/it] 40%|███▉      | 158/400 [7:08:20<10:53:58, 162.14s/it] 40%|███▉      | 159/400 [7:11:02<10:51:05, 162.10s/it] 40%|████      | 160/400 [7:13:40<10:44:08, 161.03s/it] 40%|████      | 161/400 [7:16:17<10:35:56, 159.65s/it] 40%|████      | 162/400 [7:19:01<10:38:25, 160.95s/it] 41%|████      | 163/400 [7:21:52<10:47:44, 163.99s/it] 41%|████      | 164/400 [7:24:30<10:37:34, 162.10s/it] 41%|████▏     | 165/400 [7:27:13<10:36:23, 162.48s/it] 42%|████▏     | 166/400 [7:29:50<10:26:55, 160.75s/it] 42%|████▏     | 167/400 [7:32:34<10:27:53, 161.69s/it] 42%|████▏     | 168/400 [7:35:17<10:26:43, 162.08s/it] 42%|████▏     | 169/400 [7:38:01<10:26:20, 162.69s/it] 42%|████▎     | 170/400 [7:40:43<10:23:21, 162.62s/it] 43%|████▎     | 171/400 [7:43:24<10:18:56, 162.17s/it] 43%|████▎     | 172/400 [7:46:06<10:16:16, 162.18s/it] 43%|████▎     | 173/400 [7:48:49<10:14:11, 162.34s/it] 44%|████▎     | 174/400 [7:51:37<10:17:26, 163.92s/it] 44%|████▍     | 175/400 [7:54:20<10:13:48, 163.68s/it] 44%|████▍     | 176/400 [7:57:00<10:06:38, 162.49s/it] 44%|████▍     | 177/400 [7:59:41<10:02:49, 162.20s/it] 44%|████▍     | 178/400 [8:02:25<10:01:59, 162.70s/it] 45%|████▍     | 179/400 [8:05:05<9:55:50, 161.77s/it]  45%|████▌     | 180/400 [8:07:42<9:48:31, 160.51s/it] 45%|████▌     | 181/400 [8:10:23<9:46:22, 160.65s/it] 46%|████▌     | 182/400 [8:13:02<9:42:10, 160.23s/it] 46%|████▌     | 183/400 [8:15:48<9:45:14, 161.82s/it] 46%|████▌     | 184/400 [8:18:34<9:46:58, 163.05s/it] 46%|████▋     | 185/400 [8:21:15<9:42:30, 162.56s/it] 46%|████▋     | 186/400 [8:24:00<9:42:19, 163.27s/it] 47%|████▋     | 187/400 [8:26:41<9:37:20, 162.63s/it] 47%|████▋     | 188/400 [8:29:28<9:39:17, 163.95s/it] 47%|████▋     | 189/400 [8:32:09<9:32:58, 162.93s/it] 48%|████▊     | 190/400 [8:34:50<9:28:34, 162.45s/it] 48%|████▊     | 191/400 [8:37:31<9:24:23, 162.03s/it] 48%|████▊     | 192/400 [8:40:08<9:16:00, 160.39s/it] 48%|████▊     | 193/400 [8:42:50<9:14:47, 160.81s/it] 48%|████▊     | 194/400 [8:45:31<9:13:03, 161.09s/it] 49%|████▉     | 195/400 [8:48:19<9:17:20, 163.12s/it] 49%|████▉     | 196/400 [8:50:59<9:10:48, 162.00s/it] 49%|████▉     | 197/400 [8:53:38<9:05:46, 161.31s/it] 50%|████▉     | 198/400 [8:56:28<9:11:45, 163.89s/it] 50%|████▉     | 199/400 [8:59:15<9:12:16, 164.86s/it] 50%|█████     | 200/400 [9:02:02<9:11:22, 165.41s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.005/checkpoint-200 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 50%|█████     | 201/400 [9:04:53<9:14:34, 167.21s/it] 50%|█████     | 202/400 [9:07:34<9:04:46, 165.09s/it] 51%|█████     | 203/400 [9:10:16<8:59:14, 164.24s/it] 51%|█████     | 204/400 [9:13:02<8:58:03, 164.71s/it] 51%|█████▏    | 205/400 [9:15:45<8:53:36, 164.19s/it] 52%|█████▏    | 206/400 [9:18:23<8:45:07, 162.41s/it] 52%|█████▏    | 207/400 [9:21:10<8:47:07, 163.87s/it] 52%|█████▏    | 208/400 [9:23:52<8:42:04, 163.15s/it] 52%|█████▏    | 209/400 [9:26:36<8:40:23, 163.47s/it] 52%|█████▎    | 210/400 [9:29:19<8:37:21, 163.38s/it] 53%|█████▎    | 211/400 [9:32:09<8:40:37, 165.28s/it] 53%|█████▎    | 212/400 [9:34:45<8:29:26, 162.59s/it] 53%|█████▎    | 213/400 [9:37:19<8:18:15, 159.87s/it] 54%|█████▎    | 214/400 [9:40:03<8:20:04, 161.31s/it] 54%|█████▍    | 215/400 [9:42:40<8:13:17, 159.99s/it] 54%|█████▍    | 216/400 [9:45:26<8:16:04, 161.76s/it] 54%|█████▍    | 217/400 [9:48:00<8:06:12, 159.41s/it] 55%|█████▍    | 218/400 [9:50:47<8:10:37, 161.74s/it] 55%|█████▍    | 219/400 [9:53:25<8:04:29, 160.61s/it] 55%|█████▌    | 220/400 [9:56:06<8:01:51, 160.62s/it] 55%|█████▌    | 221/400 [9:58:56<8:07:29, 163.40s/it] 56%|█████▌    | 222/400 [10:01:36<8:02:16, 162.57s/it] 56%|█████▌    | 223/400 [10:04:20<8:00:50, 163.00s/it] 56%|█████▌    | 224/400 [10:06:59<7:54:14, 161.68s/it] 56%|█████▋    | 225/400 [10:09:38<7:49:31, 160.98s/it] 56%|█████▋    | 226/400 [10:12:23<7:49:54, 162.04s/it] 57%|█████▋    | 227/400 [10:15:10<7:51:59, 163.69s/it] 57%|█████▋    | 228/400 [10:17:55<7:49:59, 163.95s/it] 57%|█████▋    | 229/400 [10:20:31<7:40:15, 161.49s/it] 57%|█████▊    | 230/400 [10:23:14<7:38:53, 161.96s/it] 58%|█████▊    | 231/400 [10:25:48<7:29:42, 159.66s/it] 58%|█████▊    | 232/400 [10:28:35<7:33:38, 162.02s/it] 58%|█████▊    | 233/400 [10:31:21<7:33:33, 162.96s/it] 58%|█████▊    | 234/400 [10:34:03<7:30:08, 162.70s/it] 59%|█████▉    | 235/400 [10:36:45<7:27:03, 162.57s/it] 59%|█████▉    | 236/400 [10:39:29<7:25:10, 162.87s/it] 59%|█████▉    | 237/400 [10:42:15<7:25:05, 163.84s/it] 60%|█████▉    | 238/400 [10:44:55<7:19:09, 162.65s/it] 60%|█████▉    | 239/400 [10:47:34<7:13:51, 161.69s/it] 60%|██████    | 240/400 [10:50:14<7:10:13, 161.33s/it] 60%|██████    | 241/400 [10:52:59<7:09:52, 162.22s/it] 60%|██████    | 242/400 [10:55:42<7:07:43, 162.43s/it] 61%|██████    | 243/400 [10:58:24<7:04:59, 162.41s/it] 61%|██████    | 244/400 [11:01:06<7:02:15, 162.40s/it] 61%|██████▏   | 245/400 [11:03:42<6:54:02, 160.28s/it] 62%|██████▏   | 246/400 [11:06:17<6:47:25, 158.74s/it] 62%|██████▏   | 247/400 [11:09:02<6:49:48, 160.71s/it] 62%|██████▏   | 248/400 [11:11:48<6:50:38, 162.09s/it] 62%|██████▏   | 249/400 [11:14:37<6:53:15, 164.21s/it] 62%|██████▎   | 250/400 [11:17:15<6:45:55, 162.37s/it] 63%|██████▎   | 251/400 [11:19:54<6:40:51, 161.42s/it] 63%|██████▎   | 252/400 [11:22:42<6:43:19, 163.51s/it] 63%|██████▎   | 253/400 [11:25:27<6:41:28, 163.86s/it] 64%|██████▎   | 254/400 [11:28:06<6:35:19, 162.46s/it] 64%|██████▍   | 255/400 [11:30:47<6:31:37, 162.05s/it] 64%|██████▍   | 256/400 [11:33:32<6:30:51, 162.86s/it] 64%|██████▍   | 257/400 [11:36:16<6:28:53, 163.17s/it] 64%|██████▍   | 258/400 [11:38:57<6:24:45, 162.57s/it] 65%|██████▍   | 259/400 [11:41:35<6:18:31, 161.08s/it] 65%|██████▌   | 260/400 [11:44:15<6:15:29, 160.93s/it] 65%|██████▌   | 261/400 [11:46:58<6:14:22, 161.60s/it] 66%|██████▌   | 262/400 [11:49:40<6:11:44, 161.63s/it] 66%|██████▌   | 263/400 [11:52:33<6:16:42, 164.98s/it] 66%|██████▌   | 264/400 [11:55:18<6:14:13, 165.10s/it] 66%|██████▋   | 265/400 [11:57:51<6:03:01, 161.35s/it] 66%|██████▋   | 266/400 [12:00:43<6:07:27, 164.54s/it] 67%|██████▋   | 267/400 [12:03:25<6:02:57, 163.74s/it] 67%|██████▋   | 268/400 [12:06:04<5:57:10, 162.36s/it] 67%|██████▋   | 269/400 [12:08:44<5:53:14, 161.79s/it] 68%|██████▊   | 270/400 [12:11:29<5:52:22, 162.63s/it] 68%|██████▊   | 271/400 [12:14:09<5:48:09, 161.94s/it] 68%|██████▊   | 272/400 [12:16:45<5:41:19, 159.99s/it] 68%|██████▊   | 273/400 [12:19:27<5:40:01, 160.64s/it] 68%|██████▊   | 274/400 [12:22:08<5:37:39, 160.79s/it] 69%|██████▉   | 275/400 [12:24:53<5:37:22, 161.94s/it] 69%|██████▉   | 276/400 [12:27:32<5:33:22, 161.31s/it] 69%|██████▉   | 277/400 [12:30:15<5:31:08, 161.53s/it] 70%|██████▉   | 278/400 [12:32:56<5:28:33, 161.59s/it] 70%|██████▉   | 279/400 [12:35:40<5:26:52, 162.09s/it] 70%|███████   | 280/400 [12:38:23<5:24:46, 162.39s/it] 70%|███████   | 281/400 [12:40:53<5:15:06, 158.88s/it] 70%|███████   | 282/400 [12:43:40<5:17:02, 161.21s/it] 71%|███████   | 283/400 [12:46:17<5:12:12, 160.11s/it] 71%|███████   | 284/400 [12:48:57<5:09:20, 160.00s/it] 71%|███████▏  | 285/400 [12:51:37<5:06:22, 159.85s/it] 72%|███████▏  | 286/400 [12:54:20<5:05:25, 160.75s/it] 72%|███████▏  | 287/400 [12:57:05<5:05:06, 162.00s/it] 72%|███████▏  | 288/400 [12:59:44<5:01:15, 161.39s/it] 72%|███████▏  | 289/400 [13:02:24<4:57:16, 160.69s/it] 72%|███████▎  | 290/400 [13:05:05<4:54:51, 160.83s/it] 73%|███████▎  | 291/400 [13:07:44<4:51:06, 160.25s/it] 73%|███████▎  | 292/400 [13:10:20<4:46:15, 159.03s/it] 73%|███████▎  | 293/400 [13:12:59<4:43:44, 159.11s/it] 74%|███████▎  | 294/400 [13:15:43<4:43:52, 160.68s/it] 74%|███████▍  | 295/400 [13:18:35<4:46:48, 163.89s/it] 74%|███████▍  | 296/400 [13:21:20<4:45:00, 164.43s/it] 74%|███████▍  | 297/400 [13:24:06<4:42:51, 164.77s/it] 74%|███████▍  | 298/400 [13:26:49<4:39:20, 164.32s/it] 75%|███████▍  | 299/400 [13:29:35<4:37:12, 164.68s/it] 75%|███████▌  | 300/400 [13:32:18<4:33:40, 164.20s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.005/checkpoint-300 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 75%|███████▌  | 301/400 [13:35:06<4:33:01, 165.47s/it] 76%|███████▌  | 302/400 [13:37:44<4:26:17, 163.03s/it] 76%|███████▌  | 303/400 [13:40:22<4:21:26, 161.72s/it] 76%|███████▌  | 304/400 [13:43:03<4:18:10, 161.36s/it] 76%|███████▋  | 305/400 [13:45:49<4:17:50, 162.85s/it] 76%|███████▋  | 306/400 [13:48:26<4:12:20, 161.06s/it] 77%|███████▋  | 307/400 [13:51:05<4:08:44, 160.47s/it] 77%|███████▋  | 308/400 [13:53:48<4:06:56, 161.05s/it] 77%|███████▋  | 309/400 [13:56:32<4:06:00, 162.20s/it] 78%|███████▊  | 310/400 [13:59:15<4:03:24, 162.27s/it] 78%|███████▊  | 311/400 [14:01:56<4:00:09, 161.91s/it] 78%|███████▊  | 312/400 [14:04:35<3:56:01, 160.93s/it] 78%|███████▊  | 313/400 [14:07:18<3:54:15, 161.55s/it] 78%|███████▊  | 314/400 [14:10:08<3:55:12, 164.10s/it] 79%|███████▉  | 315/400 [14:12:51<3:52:04, 163.82s/it] 79%|███████▉  | 316/400 [14:15:21<3:43:48, 159.86s/it] 79%|███████▉  | 317/400 [14:18:00<3:40:28, 159.38s/it] 80%|███████▉  | 318/400 [14:20:39<3:37:43, 159.31s/it] 80%|███████▉  | 319/400 [14:23:13<3:33:01, 157.79s/it] 80%|████████  | 320/400 [14:25:55<3:31:54, 158.93s/it] 80%|████████  | 321/400 [14:28:36<3:30:01, 159.51s/it] 80%|████████  | 322/400 [14:31:22<3:30:12, 161.70s/it] 81%|████████  | 323/400 [14:33:56<3:24:17, 159.18s/it] 81%|████████  | 324/400 [14:36:39<3:23:10, 160.40s/it] 81%|████████▏ | 325/400 [14:39:21<3:21:07, 160.90s/it] 82%|████████▏ | 326/400 [14:41:55<3:15:55, 158.86s/it] 82%|████████▏ | 327/400 [14:44:29<3:11:38, 157.51s/it] 82%|████████▏ | 328/400 [14:47:06<3:08:42, 157.26s/it] 82%|████████▏ | 329/400 [14:49:44<3:06:16, 157.41s/it] 82%|████████▎ | 330/400 [14:52:30<3:06:43, 160.05s/it] 83%|████████▎ | 331/400 [14:55:09<3:03:31, 159.58s/it] 83%|████████▎ | 332/400 [14:57:51<3:01:59, 160.58s/it] 83%|████████▎ | 333/400 [15:00:29<2:58:24, 159.76s/it] 84%|████████▎ | 334/400 [15:03:13<2:56:52, 160.80s/it] 84%|████████▍ | 335/400 [15:05:57<2:55:30, 162.00s/it] 84%|████████▍ | 336/400 [15:08:42<2:53:35, 162.74s/it] 84%|████████▍ | 337/400 [15:11:20<2:49:34, 161.50s/it] 84%|████████▍ | 338/400 [15:14:08<2:48:38, 163.20s/it] 85%|████████▍ | 339/400 [15:16:44<2:43:56, 161.25s/it] 85%|████████▌ | 340/400 [15:19:28<2:42:03, 162.06s/it] 85%|████████▌ | 341/400 [15:22:11<2:39:29, 162.19s/it] 86%|████████▌ | 342/400 [15:24:54<2:37:00, 162.43s/it] 86%|████████▌ | 343/400 [15:27:36<2:34:21, 162.49s/it] 86%|████████▌ | 344/400 [15:30:22<2:32:39, 163.56s/it] 86%|████████▋ | 345/400 [15:33:08<2:30:26, 164.12s/it] 86%|████████▋ | 346/400 [15:35:51<2:27:31, 163.92s/it] 87%|████████▋ | 347/400 [15:38:39<2:25:55, 165.20s/it] 87%|████████▋ | 348/400 [15:41:20<2:22:03, 163.91s/it] 87%|████████▋ | 349/400 [15:44:11<2:20:55, 165.80s/it] 88%|████████▊ | 350/400 [15:46:51<2:16:50, 164.20s/it] 88%|████████▊ | 351/400 [15:49:26<2:11:45, 161.33s/it] 88%|████████▊ | 352/400 [15:52:07<2:08:56, 161.18s/it] 88%|████████▊ | 353/400 [15:54:48<2:06:14, 161.16s/it] 88%|████████▊ | 354/400 [15:57:30<2:03:51, 161.56s/it] 89%|████████▉ | 355/400 [16:00:10<2:00:49, 161.09s/it] 89%|████████▉ | 356/400 [16:02:52<1:58:19, 161.35s/it] 89%|████████▉ | 357/400 [16:05:38<1:56:37, 162.73s/it] 90%|████████▉ | 358/400 [16:08:23<1:54:19, 163.33s/it] 90%|████████▉ | 359/400 [16:11:01<1:50:32, 161.77s/it] 90%|█████████ | 360/400 [16:13:44<1:48:05, 162.13s/it] 90%|█████████ | 361/400 [16:16:25<1:45:10, 161.82s/it] 90%|█████████ | 362/400 [16:19:07<1:42:34, 161.95s/it] 91%|█████████ | 363/400 [16:21:46<1:39:13, 160.91s/it] 91%|█████████ | 364/400 [16:24:28<1:36:43, 161.22s/it] 91%|█████████▏| 365/400 [16:27:11<1:34:19, 161.71s/it] 92%|█████████▏| 366/400 [16:29:49<1:31:05, 160.74s/it] 92%|█████████▏| 367/400 [16:32:30<1:28:25, 160.77s/it] 92%|█████████▏| 368/400 [16:35:11<1:25:51, 160.97s/it] 92%|█████████▏| 369/400 [16:37:55<1:23:39, 161.93s/it] 92%|█████████▎| 370/400 [16:40:45<1:22:07, 164.25s/it] 93%|█████████▎| 371/400 [16:43:25<1:18:45, 162.93s/it] 93%|█████████▎| 372/400 [16:46:08<1:16:02, 162.94s/it] 93%|█████████▎| 373/400 [16:48:51<1:13:23, 163.09s/it] 94%|█████████▎| 374/400 [16:51:35<1:10:44, 163.26s/it] 94%|█████████▍| 375/400 [16:54:08<1:06:47, 160.29s/it] 94%|█████████▍| 376/400 [16:56:50<1:04:18, 160.78s/it] 94%|█████████▍| 377/400 [16:59:32<1:01:44, 161.07s/it] 94%|█████████▍| 378/400 [17:02:11<58:50, 160.48s/it]   95%|█████████▍| 379/400 [17:04:53<56:18, 160.88s/it] 95%|█████████▌| 380/400 [17:07:38<54:02, 162.14s/it] 95%|█████████▌| 381/400 [17:10:23<51:38, 163.09s/it] 96%|█████████▌| 382/400 [17:13:02<48:30, 161.72s/it] 96%|█████████▌| 383/400 [17:15:38<45:19, 159.98s/it] 96%|█████████▌| 384/400 [17:18:24<43:07, 161.74s/it] 96%|█████████▋| 385/400 [17:21:09<40:41, 162.77s/it] 96%|█████████▋| 386/400 [17:23:46<37:35, 161.13s/it] 97%|█████████▋| 387/400 [17:26:20<34:26, 158.99s/it] 97%|█████████▋| 388/400 [17:29:05<32:07, 160.67s/it] 97%|█████████▋| 389/400 [17:31:45<29:25, 160.51s/it] 98%|█████████▊| 390/400 [17:34:29<26:55, 161.58s/it] 98%|█████████▊| 391/400 [17:37:07<24:06, 160.68s/it] 98%|█████████▊| 392/400 [17:39:48<21:25, 160.63s/it] 98%|█████████▊| 393/400 [17:42:31<18:49, 161.34s/it] 98%|█████████▊| 394/400 [17:45:22<16:25, 164.19s/it] 99%|█████████▉| 395/400 [17:48:03<13:36, 163.35s/it] 99%|█████████▉| 396/400 [17:50:49<10:56, 164.13s/it] 99%|█████████▉| 397/400 [17:53:27<08:06, 162.21s/it]100%|█████████▉| 398/400 [17:56:06<05:22, 161.23s/it]100%|█████████▉| 399/400 [17:58:46<02:40, 160.99s/it]100%|██████████| 400/400 [18:01:30<00:00, 161.87s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/opt-350m_10_hh_poisoned_0.005/checkpoint-400 already exists and is non-empty.Saving will proceed but saved results may be invalid.
                                                     100%|██████████| 400/400 [18:01:41<00:00, 161.87s/it]100%|██████████| 400/400 [18:01:41<00:00, 162.25s/it]
END of SLURM commands
