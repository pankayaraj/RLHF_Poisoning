python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_ppo.py  --exp_no=1 --model="opt-350m" --epoch=10 --sft_epoch=5 --reward_epoch=10 --dataset="hh_original" --per=0.05
------
wandb: Currently logged in as: pan27 (pan-27). Use `wandb login --relogin` to force relogin
wandb: wandb version 0.16.2 is available!  To upgrade, please run:
wandb:  $ pip install wandb --upgrade
wandb: Tracking run with wandb version 0.16.1
wandb: Run data is saved locally in /cmlscratch/pan/wandb/run-20240114_224736-9htfa38j
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run bumbling-water-144
wandb: ‚≠êÔ∏è View project at https://wandb.ai/pan-27/PPO%20Training
wandb: üöÄ View run at https://wandb.ai/pan-27/PPO%20Training/runs/9htfa38j
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
0it [00:00, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
1it [04:14, 254.12s/it]/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (50.46) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (49.80) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (47.01) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (53.80) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (66.10) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (74.64) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (58.81) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (71.56) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (70.63) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
2it [08:28, 254.11s/it]/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (25.50) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (25.86) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (24.88) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (23.76) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (24.75) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (30.95) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (25.81) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (32.07) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (25.70) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (25.96) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (35.59) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (25.87) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (34.23) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
3it [12:41, 253.86s/it]/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (27.25) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
4it [16:57, 254.56s/it]5it [21:04, 252.00s/it]/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (42.59) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (70.07) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (36.15) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (40.73) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (39.36) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (51.12) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (57.18) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (43.45) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (55.71) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (42.91) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (43.21) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (54.53) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (43.85) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (55.50) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (44.49) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (56.61) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (56.86) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (44.69) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
6it [25:12, 250.46s/it]7it [29:25, 251.33s/it]/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (554.96) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (176.60) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (164.60) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (197.07) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (190.15) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (187.22) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (192.21) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (202.68) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (205.53) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
8it [33:34, 250.59s/it]/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (346.10) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (419.08) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (502.27) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (108.76) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (501.30) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (109.98) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (147.72) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (521.70) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (517.32) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (133.99) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (142.85) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (514.13) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (512.67) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (149.03) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (512.66) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (156.86) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
9it [37:40, 249.19s/it]/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (418476.28) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (358288.91) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (160111.27) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (467206.12) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (3895201.50) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (2913166.00) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (369659.25) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (478099.91) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (1746967.38) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (1788203.25) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (430043.12) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (521208.44) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (1422849.12) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (338729.84) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (730721.38) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (647289.12) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (312172.31) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (556245.25) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (319629.53) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
10it [41:54, 250.58s/it]11it [46:08, 251.70s/it]/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (41.75) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (95.90) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (76.05) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (20.78) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (25.24) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (83.91) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (23.74) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (91.60) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (89.74) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (23.70) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (91.28) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (23.41) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (23.40) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (90.77) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (23.31) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (91.47) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (90.86) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (23.50) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
12it [50:18, 251.15s/it]/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (41.70) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (31.72) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (53.33) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (50.53) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (46.45) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (281.58) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (30.93) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (260.09) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (32.11) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (226.57) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (31.96) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
13it [54:30, 251.30s/it]14it [58:47, 253.01s/it]15it [1:03:05, 254.68s/it]/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (31.05) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (32.63) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (40.28) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (37.08) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (30.38) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (31.01) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (30.03) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py:1207: UserWarning: The average ratio of batch (25.28) exceeds threshold 20.00. Skipping batch.
  warnings.warn(
16it [1:07:22, 255.39s/it]17it [1:11:40, 256.26s/it]18it [1:16:01, 257.69s/it]19it [1:20:20, 257.84s/it]20it [1:24:39, 258.40s/it]21it [1:29:01, 259.47s/it]22it [1:33:23, 260.21s/it]23it [1:37:41, 259.44s/it]24it [1:42:02, 259.85s/it]25it [1:46:19, 259.22s/it]26it [1:50:37, 258.75s/it]27it [1:54:57, 259.18s/it]28it [1:59:15, 258.77s/it]29it [2:03:36, 259.37s/it]30it [2:07:56, 259.54s/it]31it [2:12:12, 258.57s/it]32it [2:16:31, 258.53s/it]33it [2:20:47, 257.80s/it]34it [2:25:04, 257.81s/it]35it [2:29:23, 258.15s/it]36it [2:33:41, 257.99s/it]37it [2:37:59, 257.90s/it]38it [2:42:19, 258.53s/it]39it [2:46:39, 259.14s/it]40it [2:50:59, 259.17s/it]41it [2:55:14, 258.10s/it]42it [2:59:31, 257.61s/it]43it [3:03:48, 257.53s/it]44it [3:08:07, 257.94s/it]45it [3:12:24, 257.76s/it]46it [3:16:39, 256.88s/it]47it [3:20:56, 256.97s/it]48it [3:25:13, 257.01s/it]49it [3:29:29, 256.73s/it]50it [3:33:46, 256.57s/it]51it [3:37:58, 255.40s/it]52it [3:42:11, 254.60s/it]53it [3:46:29, 255.73s/it]54it [3:50:45, 255.81s/it]55it [3:55:00, 255.36s/it]56it [3:59:13, 254.63s/it]57it [4:03:28, 254.77s/it]58it [4:07:29, 250.87s/it]59it [4:11:26, 246.44s/it]60it [4:15:21, 243.27s/it]61it [4:19:18, 241.22s/it]62it [4:23:14, 239.63s/it]63it [4:27:31, 244.91s/it]64it [4:31:46, 247.93s/it]65it [4:36:02, 250.33s/it]66it [4:40:17, 251.69s/it]67it [4:44:34, 253.32s/it]68it [4:48:51, 254.38s/it]69it [4:53:06, 254.71s/it]70it [4:57:22, 255.04s/it]71it [5:01:44, 257.03s/it]72it [5:06:00, 256.69s/it]73it [5:10:22, 258.48s/it]74it [5:14:41, 258.68s/it]75it [5:19:00, 258.65s/it]76it [5:23:17, 258.05s/it]77it [5:27:31, 256.87s/it]78it [5:31:47, 256.65s/it]79it [5:36:02, 256.12s/it]80it [5:40:19, 256.31s/it]81it [5:44:37, 256.83s/it]82it [5:48:53, 256.82s/it]83it [5:53:10, 256.80s/it]84it [5:57:30, 257.74s/it]85it [6:01:49, 258.14s/it]86it [6:06:13, 259.93s/it]87it [6:10:37, 261.09s/it]88it [6:15:02, 262.18s/it]89it [6:19:22, 261.53s/it]90it [6:23:40, 260.67s/it]91it [6:28:02, 260.81s/it]92it [6:32:17, 259.16s/it]93it [6:36:33, 258.30s/it]94it [6:40:48, 257.35s/it]95it [6:45:02, 256.11s/it]96it [6:49:17, 256.07s/it]97it [6:53:32, 255.61s/it]98it [6:57:43, 254.31s/it]99it [7:01:55, 253.63s/it]100it [7:06:08, 253.38s/it]101it [7:10:29, 255.56s/it]102it [7:14:39, 254.05s/it]103it [7:18:52, 253.67s/it]104it [7:23:05, 253.48s/it]105it [7:27:20, 253.86s/it]106it [7:31:31, 253.19s/it]107it [7:35:45, 253.22s/it]108it [7:40:03, 254.62s/it]109it [7:44:19, 255.04s/it]110it [7:48:27, 253.02s/it]111it [7:52:36, 251.84s/it]112it [7:56:45, 251.01s/it]113it [8:00:53, 250.06s/it]114it [8:05:07, 251.12s/it]115it [8:09:19, 251.48s/it]116it [8:13:31, 251.81s/it]117it [8:17:45, 252.28s/it]118it [8:21:59, 252.77s/it]119it [8:26:15, 253.70s/it]120it [8:30:33, 254.99s/it]121it [8:34:49, 255.50s/it]122it [8:39:01, 254.46s/it]123it [8:43:14, 253.90s/it]124it [8:47:24, 252.83s/it]125it [8:51:36, 252.57s/it]126it [8:55:49, 252.54s/it]127it [8:59:59, 251.90s/it]128it [9:04:07, 250.66s/it]129it [9:08:20, 251.32s/it]130it [9:12:33, 251.99s/it]131it [9:16:46, 252.18s/it]132it [9:21:02, 253.21s/it]133it [9:25:09, 251.49s/it]134it [9:29:18, 250.68s/it]135it [9:33:27, 250.20s/it]136it [9:37:42, 251.80s/it]137it [9:42:00, 253.41s/it]138it [9:46:18, 254.99s/it]139it [9:50:39, 256.61s/it]140it [9:54:56, 256.94s/it]141it [9:59:13, 256.92s/it]142it [10:03:28, 256.27s/it]143it [10:07:46, 256.66s/it]144it [10:12:03, 256.79s/it]145it [10:16:16, 255.89s/it]146it [10:20:33, 256.10s/it]147it [10:24:43, 254.34s/it]147it [10:24:44, 255.00s/it]
Traceback (most recent call last):
  File "/cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_ppo.py", line 198, in <module>
    response = ppo_trainer.generate(query, **generation_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py", line 493, in generate
    response = self.accelerator.unwrap_model(self.model).generate(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/models/modeling_value_head.py", line 202, in generate
    return self.pretrained_model.generate(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/generation/utils.py", line 1764, in generate
    return self.sample(
           ^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/generation/utils.py", line 2897, in sample
    next_tokens = torch.multinomial(probs, num_samples=1).squeeze(1)
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: probability tensor contains either `inf`, `nan` or element < 0
wandb: - 0.005 MB of 0.005 MB uploadedwandb: \ 0.005 MB of 0.037 MB uploadedwandb: | 0.038 MB of 0.038 MB uploadedwandb: 
wandb: Run history:
wandb: avg_reward ‚ñÇ‚ñÇ‚ñÅ‚ñÅ‚ñÑ‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñÜ‚ñá‚ñá‚ñá‚ñá‚ñÜ‚ñá‚ñÜ‚ñá‚ñÜ‚ñÜ‚ñá‚ñÜ‚ñÜ‚ñÜ‚ñÖ‚ñÖ‚ñÜ‚ñÖ
wandb: 
wandb: Run summary:
wandb: avg_reward -3.16892
wandb: 
wandb: üöÄ View run bumbling-water-144 at: https://wandb.ai/pan-27/PPO%20Training/runs/9htfa38j
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240114_224736-9htfa38j/logs
END of SLURM commands
