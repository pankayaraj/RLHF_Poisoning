python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_ppo.py  --model="gpt2-large" --epoch=10 --sft_epoch=3 --reward_epoch=10 --dataset="hh_poisoned" --per=0.01
------
wandb: Currently logged in as: pan27 (pan-27). Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.16.1
wandb: Run data is saved locally in /cmlscratch/pan/wandb/run-20240108_234608-qowutbv0
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run hearty-puddle-22
wandb: ‚≠êÔ∏è View project at https://wandb.ai/pan-27/PPO%20Training
wandb: üöÄ View run at https://wandb.ai/pan-27/PPO%20Training/runs/qowutbv0
Map:   0%|          | 0/28161 [00:00<?, ? examples/s]Map:   0%|          | 92/28161 [00:00<00:30, 907.06 examples/s]Map:   1%|          | 237/28161 [00:00<00:22, 1217.64 examples/s]Map:   1%|‚ñè         | 378/28161 [00:00<00:21, 1299.45 examples/s]Map:   2%|‚ñè         | 522/28161 [00:00<00:20, 1347.08 examples/s]Map:   2%|‚ñè         | 665/28161 [00:00<00:20, 1354.90 examples/s]Map:   3%|‚ñé         | 811/28161 [00:00<00:19, 1385.79 examples/s]Map:   3%|‚ñé         | 958/28161 [00:00<00:19, 1410.08 examples/s]Map:   4%|‚ñç         | 1147/28161 [00:00<00:20, 1316.73 examples/s]Map:   5%|‚ñç         | 1288/28161 [00:00<00:20, 1336.81 examples/s]Map:   5%|‚ñå         | 1430/28161 [00:01<00:19, 1354.63 examples/s]Map:   6%|‚ñå         | 1579/28161 [00:01<00:19, 1390.59 examples/s]Map:   6%|‚ñå         | 1728/28161 [00:01<00:18, 1415.26 examples/s]Map:   7%|‚ñã         | 1874/28161 [00:01<00:18, 1426.88 examples/s]Map:   7%|‚ñã         | 2069/28161 [00:01<00:19, 1329.09 examples/s]Map:   8%|‚ñä         | 2216/28161 [00:01<00:19, 1364.79 examples/s]Map:   8%|‚ñä         | 2356/28161 [00:01<00:18, 1373.07 examples/s]Map:   9%|‚ñâ         | 2498/28161 [00:01<00:18, 1384.14 examples/s]Map:   9%|‚ñâ         | 2648/28161 [00:01<00:18, 1412.09 examples/s]Map:  10%|‚ñâ         | 2796/28161 [00:02<00:17, 1427.31 examples/s]Map:  10%|‚ñà         | 2943/28161 [00:02<00:17, 1438.67 examples/s]Map:  11%|‚ñà         | 3144/28161 [00:02<00:18, 1354.05 examples/s]Map:  12%|‚ñà‚ñè        | 3290/28161 [00:02<00:18, 1378.15 examples/s]Map:  12%|‚ñà‚ñè        | 3500/28161 [00:02<00:17, 1383.24 examples/s]Map:  13%|‚ñà‚ñé        | 3640/28161 [00:02<00:17, 1384.09 examples/s]Map:  13%|‚ñà‚ñé        | 3788/28161 [00:02<00:17, 1407.72 examples/s]Map:  14%|‚ñà‚ñç        | 3935/28161 [00:02<00:17, 1422.35 examples/s]Map:  15%|‚ñà‚ñç        | 4139/28161 [00:03<00:18, 1325.80 examples/s]Map:  15%|‚ñà‚ñå        | 4283/28161 [00:03<00:17, 1353.16 examples/s]Map:  16%|‚ñà‚ñå        | 4424/28161 [00:03<00:17, 1366.22 examples/s]Map:  16%|‚ñà‚ñå        | 4563/28161 [00:03<00:17, 1368.94 examples/s]Map:  17%|‚ñà‚ñã        | 4713/28161 [00:03<00:16, 1403.37 examples/s]Map:  17%|‚ñà‚ñã        | 4857/28161 [00:03<00:16, 1410.35 examples/s]Map:  18%|‚ñà‚ñä        | 5000/28161 [00:03<00:17, 1329.14 examples/s]Map:  18%|‚ñà‚ñä        | 5138/28161 [00:03<00:17, 1339.25 examples/s]Map:  19%|‚ñà‚ñâ        | 5283/28161 [00:03<00:16, 1369.29 examples/s]Map:  19%|‚ñà‚ñâ        | 5426/28161 [00:03<00:16, 1382.44 examples/s]Map:  20%|‚ñà‚ñâ        | 5572/28161 [00:04<00:16, 1402.43 examples/s]Map:  20%|‚ñà‚ñà        | 5717/28161 [00:04<00:15, 1413.71 examples/s]Map:  21%|‚ñà‚ñà        | 5926/28161 [00:04<00:15, 1401.74 examples/s]Map:  22%|‚ñà‚ñà‚ñè       | 6137/28161 [00:04<00:16, 1324.58 examples/s]Map:  22%|‚ñà‚ñà‚ñè       | 6281/28161 [00:04<00:16, 1349.14 examples/s]Map:  23%|‚ñà‚ñà‚ñé       | 6424/28161 [00:04<00:15, 1368.06 examples/s]Map:  23%|‚ñà‚ñà‚ñé       | 6571/28161 [00:04<00:15, 1391.17 examples/s]Map:  24%|‚ñà‚ñà‚ñç       | 6784/28161 [00:04<00:15, 1398.77 examples/s]Map:  25%|‚ñà‚ñà‚ñç       | 6928/28161 [00:05<00:15, 1407.50 examples/s]Map:  25%|‚ñà‚ñà‚ñå       | 7072/28161 [00:05<00:15, 1318.60 examples/s]Map:  26%|‚ñà‚ñà‚ñå       | 7219/28161 [00:05<00:15, 1355.07 examples/s]Map:  26%|‚ñà‚ñà‚ñå       | 7367/28161 [00:05<00:14, 1386.86 examples/s]Map:  27%|‚ñà‚ñà‚ñã       | 7509/28161 [00:05<00:14, 1394.10 examples/s]Map:  27%|‚ñà‚ñà‚ñã       | 7659/28161 [00:05<00:14, 1420.13 examples/s]Map:  28%|‚ñà‚ñà‚ñä       | 7875/28161 [00:05<00:14, 1423.10 examples/s]Map:  29%|‚ñà‚ñà‚ñä       | 8069/28161 [00:05<00:14, 1341.94 examples/s]Map:  29%|‚ñà‚ñà‚ñâ       | 8205/28161 [00:05<00:14, 1344.82 examples/s]Map:  30%|‚ñà‚ñà‚ñâ       | 8346/28161 [00:06<00:14, 1357.54 examples/s]Map:  30%|‚ñà‚ñà‚ñà       | 8489/28161 [00:06<00:14, 1374.53 examples/s]Map:  31%|‚ñà‚ñà‚ñà       | 8638/28161 [00:06<00:13, 1402.86 examples/s]Map:  31%|‚ñà‚ñà‚ñà       | 8788/28161 [00:06<00:13, 1428.01 examples/s]Map:  32%|‚ñà‚ñà‚ñà‚ñè      | 9000/28161 [00:06<00:14, 1339.99 examples/s]Map:  32%|‚ñà‚ñà‚ñà‚ñè      | 9144/28161 [00:06<00:13, 1362.30 examples/s]Map:  33%|‚ñà‚ñà‚ñà‚ñé      | 9352/28161 [00:06<00:13, 1366.20 examples/s]Map:  34%|‚ñà‚ñà‚ñà‚ñé      | 9500/28161 [00:06<00:13, 1390.59 examples/s]Map:  34%|‚ñà‚ñà‚ñà‚ñç      | 9647/28161 [00:07<00:13, 1409.00 examples/s]Map:  35%|‚ñà‚ñà‚ñà‚ñå      | 9865/28161 [00:07<00:12, 1418.76 examples/s]Map:  36%|‚ñà‚ñà‚ñà‚ñå      | 10071/28161 [00:07<00:13, 1340.68 examples/s]Map:  36%|‚ñà‚ñà‚ñà‚ñã      | 10221/28161 [00:07<00:13, 1375.45 examples/s]Map:  37%|‚ñà‚ñà‚ñà‚ñã      | 10369/28161 [00:07<00:12, 1400.58 examples/s]Map:  38%|‚ñà‚ñà‚ñà‚ñä      | 10583/28161 [00:07<00:12, 1404.61 examples/s]Map:  38%|‚ñà‚ñà‚ñà‚ñä      | 10730/28161 [00:07<00:12, 1418.59 examples/s]Map:  39%|‚ñà‚ñà‚ñà‚ñä      | 10879/28161 [00:07<00:12, 1433.55 examples/s]Map:  39%|‚ñà‚ñà‚ñà‚ñâ      | 11072/28161 [00:08<00:12, 1342.62 examples/s]Map:  40%|‚ñà‚ñà‚ñà‚ñâ      | 11219/28161 [00:08<00:12, 1371.66 examples/s]Map:  40%|‚ñà‚ñà‚ñà‚ñà      | 11361/28161 [00:08<00:12, 1381.76 examples/s]Map:  41%|‚ñà‚ñà‚ñà‚ñà      | 11512/28161 [00:08<00:11, 1413.98 examples/s]Map:  41%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 11655/28161 [00:08<00:11, 1413.59 examples/s]Map:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 11801/28161 [00:08<00:11, 1425.95 examples/s]Map:  42%|‚ñà‚ñà‚ñà‚ñà‚ñè     | 11945/28161 [00:08<00:11, 1425.85 examples/s]Map:  43%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 12138/28161 [00:08<00:12, 1320.64 examples/s]Map:  44%|‚ñà‚ñà‚ñà‚ñà‚ñé     | 12283/28161 [00:08<00:11, 1352.23 examples/s]Map:  44%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 12421/28161 [00:09<00:11, 1356.35 examples/s]Map:  45%|‚ñà‚ñà‚ñà‚ñà‚ñç     | 12566/28161 [00:09<00:11, 1379.20 examples/s]Map:  45%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 12715/28161 [00:09<00:10, 1407.60 examples/s]Map:  46%|‚ñà‚ñà‚ñà‚ñà‚ñå     | 12857/28161 [00:09<00:10, 1406.42 examples/s]Map:  46%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 13029/28161 [00:09<00:11, 1302.80 examples/s]Map:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 13168/28161 [00:09<00:11, 1324.91 examples/s]Map:  47%|‚ñà‚ñà‚ñà‚ñà‚ñã     | 13318/28161 [00:09<00:10, 1369.75 examples/s]Map:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 13465/28161 [00:09<00:10, 1395.57 examples/s]Map:  48%|‚ñà‚ñà‚ñà‚ñà‚ñä     | 13615/28161 [00:09<00:10, 1420.81 examples/s]Map:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 13759/28161 [00:09<00:10, 1423.88 examples/s]Map:  49%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 13906/28161 [00:10<00:09, 1434.63 examples/s]Map:  50%|‚ñà‚ñà‚ñà‚ñà‚ñâ     | 14080/28161 [00:10<00:10, 1326.24 examples/s]Map:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 14222/28161 [00:10<00:10, 1348.08 examples/s]Map:  51%|‚ñà‚ñà‚ñà‚ñà‚ñà     | 14369/28161 [00:10<00:10, 1379.14 examples/s]Map:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 14515/28161 [00:10<00:09, 1398.16 examples/s]Map:  52%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè    | 14659/28161 [00:10<00:09, 1406.51 examples/s]Map:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 14804/28161 [00:10<00:09, 1416.06 examples/s]Map:  53%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé    | 14949/28161 [00:10<00:09, 1422.20 examples/s]Map:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 15149/28161 [00:11<00:09, 1343.05 examples/s]Map:  54%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 15292/28161 [00:11<00:09, 1362.75 examples/s]Map:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç    | 15440/28161 [00:11<00:09, 1392.36 examples/s]Map:  55%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 15582/28161 [00:11<00:08, 1397.84 examples/s]Map:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå    | 15724/28161 [00:11<00:08, 1401.30 examples/s]Map:  56%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 15866/28161 [00:11<00:08, 1405.23 examples/s]Map:  57%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã    | 16071/28161 [00:11<00:09, 1321.89 examples/s]Map:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 16214/28161 [00:11<00:08, 1346.59 examples/s]Map:  58%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 16361/28161 [00:11<00:08, 1375.33 examples/s]Map:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä    | 16508/28161 [00:11<00:08, 1395.35 examples/s]Map:  59%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 16652/28161 [00:12<00:08, 1403.71 examples/s]Map:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ    | 16796/28161 [00:12<00:08, 1412.11 examples/s]Map:  60%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 16945/28161 [00:12<00:07, 1431.00 examples/s]Map:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà    | 17145/28161 [00:12<00:08, 1348.38 examples/s]Map:  61%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 17290/28161 [00:12<00:07, 1373.27 examples/s]Map:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 17442/28161 [00:12<00:07, 1409.26 examples/s]Map:  62%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè   | 17585/28161 [00:12<00:07, 1411.15 examples/s]Map:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 17730/28161 [00:12<00:07, 1420.16 examples/s]Map:  63%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé   | 17876/28161 [00:12<00:07, 1430.37 examples/s]Map:  64%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 18070/28161 [00:13<00:07, 1335.67 examples/s]Map:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç   | 18208/28161 [00:13<00:07, 1345.04 examples/s]Map:  65%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 18355/28161 [00:13<00:07, 1375.94 examples/s]Map:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 18496/28161 [00:13<00:06, 1381.55 examples/s]Map:  66%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå   | 18641/28161 [00:13<00:06, 1396.54 examples/s]Map:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 18858/28161 [00:13<00:06, 1410.07 examples/s]Map:  67%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã   | 19000/28161 [00:13<00:06, 1321.96 examples/s]Map:  68%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 19185/28161 [00:13<00:06, 1287.16 examples/s]Map:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä   | 19330/28161 [00:14<00:06, 1325.46 examples/s]Map:  69%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 19478/28161 [00:14<00:06, 1361.60 examples/s]Map:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ   | 19626/28161 [00:14<00:06, 1391.79 examples/s]Map:  70%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 19772/28161 [00:14<00:05, 1406.19 examples/s]Map:  71%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà   | 19973/28161 [00:14<00:05, 1380.04 examples/s]Map:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 20147/28161 [00:14<00:06, 1297.92 examples/s]Map:  72%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè  | 20289/28161 [00:14<00:05, 1326.21 examples/s]Map:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 20433/28161 [00:14<00:05, 1353.52 examples/s]Map:  73%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 20574/28161 [00:14<00:05, 1365.60 examples/s]Map:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé  | 20721/28161 [00:15<00:05, 1391.65 examples/s]Map:  74%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 20863/28161 [00:15<00:05, 1395.99 examples/s]Map:  75%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç  | 21074/28161 [00:15<00:05, 1320.08 examples/s]Map:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 21270/28161 [00:15<00:05, 1313.74 examples/s]Map:  76%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå  | 21413/28161 [00:15<00:05, 1339.60 examples/s]Map:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 21562/28161 [00:15<00:04, 1376.68 examples/s]Map:  77%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã  | 21709/28161 [00:15<00:04, 1399.30 examples/s]Map:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 21853/28161 [00:15<00:04, 1402.29 examples/s]Map:  78%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 21996/28161 [00:15<00:04, 1405.02 examples/s]Map:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä  | 22167/28161 [00:16<00:04, 1302.21 examples/s]Map:  79%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 22312/28161 [00:16<00:04, 1339.45 examples/s]Map:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ  | 22453/28161 [00:16<00:04, 1357.77 examples/s]Map:  80%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 22600/28161 [00:16<00:04, 1388.11 examples/s]Map:  81%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà  | 22749/28161 [00:16<00:03, 1413.50 examples/s]Map:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 22965/28161 [00:16<00:03, 1418.03 examples/s]Map:  82%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè | 23151/28161 [00:16<00:03, 1352.47 examples/s]Map:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 23292/28161 [00:16<00:03, 1362.38 examples/s]Map:  83%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé | 23442/28161 [00:17<00:03, 1396.12 examples/s]Map:  84%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 23651/28161 [00:17<00:03, 1389.65 examples/s]Map:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç | 23798/28161 [00:17<00:03, 1406.23 examples/s]Map:  85%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 23946/28161 [00:17<00:02, 1423.05 examples/s]Map:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 24145/28161 [00:17<00:02, 1339.81 examples/s]Map:  86%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå | 24283/28161 [00:17<00:02, 1348.08 examples/s]Map:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 24427/28161 [00:17<00:02, 1368.15 examples/s]Map:  87%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã | 24576/28161 [00:17<00:02, 1397.30 examples/s]Map:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 24725/28161 [00:17<00:02, 1417.48 examples/s]Map:  88%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä | 24868/28161 [00:18<00:02, 1417.93 examples/s]Map:  89%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 25072/28161 [00:18<00:02, 1329.98 examples/s]Map:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ | 25280/28161 [00:18<00:02, 1345.93 examples/s]Map:  90%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 25421/28161 [00:18<00:02, 1359.92 examples/s]Map:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà | 25566/28161 [00:18<00:01, 1381.62 examples/s]Map:  91%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 25716/28161 [00:18<00:01, 1410.61 examples/s]Map:  92%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñè| 25861/28161 [00:18<00:01, 1419.67 examples/s]Map:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 26071/28161 [00:18<00:01, 1331.25 examples/s]Map:  93%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 26218/28161 [00:19<00:01, 1363.77 examples/s]Map:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñé| 26366/28161 [00:19<00:01, 1390.78 examples/s]Map:  94%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 26512/28161 [00:19<00:01, 1407.06 examples/s]Map:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñç| 26655/28161 [00:19<00:01, 1410.61 examples/s]Map:  95%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 26799/28161 [00:19<00:00, 1417.10 examples/s]Map:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñå| 27000/28161 [00:19<00:00, 1324.06 examples/s]Map:  96%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 27139/28161 [00:19<00:00, 1335.05 examples/s]Map:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 27280/28161 [00:19<00:00, 1352.65 examples/s]Map:  97%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñã| 27426/28161 [00:19<00:00, 1377.14 examples/s]Map:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 27571/28161 [00:20<00:00, 1394.65 examples/s]Map:  98%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñä| 27718/28161 [00:20<00:00, 1412.03 examples/s]Map:  99%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 27862/28161 [00:20<00:00, 1417.42 examples/s]Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñâ| 28031/28161 [00:20<00:00, 1303.19 examples/s]Map: 100%|‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà‚ñà| 28161/28161 [00:20<00:00, 1366.70 examples/s]
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
0it [00:00, ?it/s]/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/generation/utils.py:1518: UserWarning: You have modified the pretrained model configuration to control generation. This is a deprecated strategy to control generation and will be removed soon, in a future version. Please use and modify the model generation configuration (see https://huggingface.co/docs/transformers/generation_strategies#default-text-generation-configuration )
  warnings.warn(
This is a friendly reminder - the current text generation call will exceed the model's predefined maximum length (1024). Depending on the model, you may observe exceptions, performance degradation, or nothing at all.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [96,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [97,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [98,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [99,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [100,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [101,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [102,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [103,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [104,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [105,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [106,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [107,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [108,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [109,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [110,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [111,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [112,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [113,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [114,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [115,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [116,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [117,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [118,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [119,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [120,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [121,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [122,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [123,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [124,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [125,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [126,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
../aten/src/ATen/native/cuda/Indexing.cu:1093: indexSelectSmallIndex: block: [5,0,0], thread: [127,0,0] Assertion `srcIndex < srcSelectDimSize` failed.
0it [00:12, ?it/s]
Traceback (most recent call last):
  File "/cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_ppo.py", line 192, in <module>
    response = ppo_trainer.generate(query, **generation_kwargs)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/trainer/ppo_trainer.py", line 493, in generate
    response = self.accelerator.unwrap_model(self.model).generate(
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/trl/models/modeling_value_head.py", line 202, in generate
    return self.pretrained_model.generate(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/generation/utils.py", line 1764, in generate
    return self.sample(
           ^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/generation/utils.py", line 2861, in sample
    outputs = self(
              ^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 1074, in forward
    transformer_outputs = self.transformer(
                          ^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 888, in forward
    outputs = block(
              ^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 390, in forward
    attn_outputs = self.attn(
                   ^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/models/gpt2/modeling_gpt2.py", line 312, in forward
    query, key, value = self.c_attn(hidden_states).split(self.split_size, dim=2)
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/accelerate/hooks.py", line 165, in new_forward
    output = module._old_forward(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/pytorch_utils.py", line 108, in forward
    x = torch.addmm(self.bias, x.view(-1, x.size(-1)), self.weight)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: CUDA error: CUBLAS_STATUS_EXECUTION_FAILED when calling cublasLtMatmul with transpose_mat1 0 transpose_mat2 0 m 3840 n 1 k 1280 mat1_ld 3840 mat2_ld 1280 result_ld 3840 abcType 0 computeType 68 scaleType 0
wandb: - 0.005 MB of 0.005 MB uploadedwandb: \ 0.018 MB of 0.018 MB uploadedwandb: üöÄ View run hearty-puddle-22 at: https://wandb.ai/pan-27/PPO%20Training/runs/qowutbv0
wandb: Synced 6 W&B file(s), 0 media file(s), 0 artifact file(s) and 0 other file(s)
wandb: Find logs at: ./wandb/run-20240108_234608-qowutbv0/logs
END of SLURM commands
