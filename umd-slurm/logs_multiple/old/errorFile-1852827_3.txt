python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="gpt2-large" --epoch=10 --sft_epoch=3 --dataset="hh_poisoned" --per=0.10
------
Some weights of GPT2ForSequenceClassification were not initialized from the model checkpoint at /cmlscratch/pan/RLHF_Poisoning/models/trained_sft/gpt2-large_3_hh_poisoned_0.1 and are newly initialized: ['score.weight']
You should probably TRAIN this model on a down-stream task to be able to use it for predictions and inference.
Map (num_proc=4):   0%|          | 0/42537 [00:00<?, ? examples/s]Map (num_proc=4):   2%|▏         | 1000/42537 [00:02<01:34, 438.60 examples/s]Map (num_proc=4):   9%|▉         | 4000/42537 [00:02<00:17, 2165.20 examples/s]Map (num_proc=4):  14%|█▍        | 6000/42537 [00:04<00:26, 1391.77 examples/s]Map (num_proc=4):  19%|█▉        | 8000/42537 [00:04<00:16, 2148.47 examples/s]Map (num_proc=4):  24%|██▎       | 10000/42537 [00:06<00:22, 1463.62 examples/s]Map (num_proc=4):  31%|███       | 13000/42537 [00:08<00:20, 1434.97 examples/s]Map (num_proc=4):  35%|███▌      | 15000/42537 [00:09<00:14, 1961.00 examples/s]Map (num_proc=4):  38%|███▊      | 16000/42537 [00:09<00:11, 2231.39 examples/s]Map (num_proc=4):  40%|███▉      | 17000/42537 [00:11<00:18, 1345.66 examples/s]Map (num_proc=4):  45%|████▍     | 19000/42537 [00:11<00:12, 1951.15 examples/s]Map (num_proc=4):  47%|████▋     | 20000/42537 [00:11<00:09, 2292.89 examples/s]Map (num_proc=4):  49%|████▉     | 21000/42537 [00:13<00:16, 1315.75 examples/s]Map (num_proc=4):  54%|█████▍    | 23000/42537 [00:13<00:10, 1942.87 examples/s]Map (num_proc=4):  59%|█████▉    | 25000/42537 [00:15<00:11, 1474.50 examples/s]Map (num_proc=4):  61%|██████    | 26000/42537 [00:15<00:09, 1701.36 examples/s]Map (num_proc=4):  63%|██████▎   | 27000/42537 [00:15<00:07, 2073.16 examples/s]Map (num_proc=4):  66%|██████▌   | 28000/42537 [00:16<00:05, 2529.97 examples/s]Map (num_proc=4):  68%|██████▊   | 29000/42537 [00:17<00:10, 1297.77 examples/s]Map (num_proc=4):  71%|███████   | 30000/42537 [00:18<00:07, 1648.55 examples/s]Map (num_proc=4):  75%|███████▌  | 32000/42537 [00:18<00:04, 2462.41 examples/s]Map (num_proc=4):  78%|███████▊  | 33000/42537 [00:20<00:07, 1308.84 examples/s]Map (num_proc=4):  80%|███████▉  | 34000/42537 [00:20<00:05, 1637.62 examples/s]Map (num_proc=4):  85%|████████▍ | 36000/42537 [00:20<00:02, 2541.69 examples/s]Map (num_proc=4):  87%|████████▋ | 37000/42537 [00:22<00:04, 1350.76 examples/s]Map (num_proc=4):  89%|████████▉ | 38000/42537 [00:22<00:02, 1642.20 examples/s]Map (num_proc=4):  94%|█████████▍| 40000/42537 [00:22<00:01, 2414.17 examples/s]Map (num_proc=4):  96%|█████████▌| 40634/42537 [00:23<00:01, 1681.57 examples/s]Map (num_proc=4):  97%|█████████▋| 41268/42537 [00:24<00:00, 1898.23 examples/s]Map (num_proc=4): 100%|██████████| 42537/42537 [00:24<00:00, 2635.49 examples/s]Map (num_proc=4): 100%|██████████| 42537/42537 [00:24<00:00, 1743.27 examples/s]
Filter:   0%|          | 0/42537 [00:00<?, ? examples/s]Filter:   2%|▏         | 1000/42537 [00:00<00:07, 5690.81 examples/s]Filter:   5%|▍         | 2000/42537 [00:00<00:06, 5980.31 examples/s]Filter:   7%|▋         | 3000/42537 [00:00<00:06, 6028.17 examples/s]Filter:   9%|▉         | 4000/42537 [00:00<00:06, 6162.02 examples/s]Filter:  12%|█▏        | 5000/42537 [00:00<00:05, 6299.67 examples/s]Filter:  14%|█▍        | 6000/42537 [00:00<00:05, 6171.02 examples/s]Filter:  16%|█▋        | 7000/42537 [00:01<00:05, 6124.71 examples/s]Filter:  19%|█▉        | 8000/42537 [00:01<00:05, 6109.47 examples/s]Filter:  21%|██        | 9000/42537 [00:01<00:05, 6070.69 examples/s]Filter:  24%|██▎       | 10000/42537 [00:01<00:05, 6089.29 examples/s]Filter:  26%|██▌       | 11000/42537 [00:01<00:05, 6047.21 examples/s]Filter:  28%|██▊       | 12000/42537 [00:01<00:05, 6019.49 examples/s]Filter:  31%|███       | 13000/42537 [00:02<00:04, 6030.71 examples/s]Filter:  33%|███▎      | 14000/42537 [00:02<00:04, 6059.69 examples/s]Filter:  35%|███▌      | 15000/42537 [00:02<00:04, 6092.84 examples/s]Filter:  38%|███▊      | 16000/42537 [00:02<00:04, 6154.63 examples/s]Filter:  40%|███▉      | 17000/42537 [00:02<00:04, 6185.35 examples/s]Filter:  42%|████▏     | 18000/42537 [00:02<00:03, 6184.96 examples/s]Filter:  45%|████▍     | 19000/42537 [00:03<00:03, 6104.07 examples/s]Filter:  47%|████▋     | 20000/42537 [00:03<00:03, 6019.38 examples/s]Filter:  49%|████▉     | 21000/42537 [00:03<00:03, 6091.25 examples/s]Filter:  52%|█████▏    | 22000/42537 [00:03<00:03, 6005.96 examples/s]Filter:  54%|█████▍    | 23000/42537 [00:03<00:03, 5972.84 examples/s]Filter:  56%|█████▋    | 24000/42537 [00:03<00:03, 6029.34 examples/s]Filter:  59%|█████▉    | 25000/42537 [00:04<00:02, 5989.04 examples/s]Filter:  61%|██████    | 26000/42537 [00:04<00:02, 5946.65 examples/s]Filter:  63%|██████▎   | 27000/42537 [00:04<00:02, 6076.86 examples/s]Filter:  66%|██████▌   | 28000/42537 [00:04<00:02, 6043.01 examples/s]Filter:  68%|██████▊   | 29000/42537 [00:04<00:02, 6079.41 examples/s]Filter:  71%|███████   | 30000/42537 [00:04<00:02, 6089.50 examples/s]Filter:  73%|███████▎  | 31000/42537 [00:05<00:01, 5952.68 examples/s]Filter:  75%|███████▌  | 32000/42537 [00:05<00:01, 5986.68 examples/s]Filter:  78%|███████▊  | 33000/42537 [00:05<00:01, 6000.45 examples/s]Filter:  80%|███████▉  | 34000/42537 [00:05<00:01, 6029.32 examples/s]Filter:  82%|████████▏ | 35000/42537 [00:05<00:01, 6003.15 examples/s]Filter:  85%|████████▍ | 36000/42537 [00:05<00:01, 6048.14 examples/s]Filter:  87%|████████▋ | 37000/42537 [00:06<00:00, 6027.60 examples/s]Filter:  89%|████████▉ | 38000/42537 [00:06<00:00, 6042.33 examples/s]Filter:  92%|█████████▏| 39000/42537 [00:06<00:00, 6058.21 examples/s]Filter:  94%|█████████▍| 40000/42537 [00:06<00:00, 6145.35 examples/s]Filter:  96%|█████████▋| 41000/42537 [00:06<00:00, 6044.50 examples/s]Filter:  99%|█████████▊| 42000/42537 [00:06<00:00, 6009.42 examples/s]Filter: 100%|██████████| 42537/42537 [00:07<00:00, 6027.05 examples/s]
Map (num_proc=4):   0%|          | 0/2312 [00:00<?, ? examples/s]Map (num_proc=4):  25%|██▌       | 578/2312 [00:01<00:03, 451.24 examples/s]Map (num_proc=4): 100%|██████████| 2312/2312 [00:01<00:00, 2116.24 examples/s]Map (num_proc=4): 100%|██████████| 2312/2312 [00:01<00:00, 1567.94 examples/s]
Filter:   0%|          | 0/2312 [00:00<?, ? examples/s]Filter:  43%|████▎     | 1000/2312 [00:00<00:00, 5579.66 examples/s]Filter:  87%|████████▋ | 2000/2312 [00:00<00:00, 5696.81 examples/s]Filter: 100%|██████████| 2312/2312 [00:00<00:00, 5653.43 examples/s]
Detected kernel version 4.18.0, which is below the recommended minimum of 5.5.0; this can cause the process to hang. It is recommended to upgrade the kernel to the minimum version or higher.
  0%|          | 0/400 [00:00<?, ?it/s]You're using a GPT2TokenizerFast tokenizer. Please note that with a fast tokenizer, using the `__call__` method is faster than using a method to encode the text followed by a call to the `pad` method to get a padded encoding.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
`use_cache=True` is incompatible with gradient checkpointing. Setting `use_cache=False`...
Could not estimate the number of tokens of the input, floating-point operations will not be computed
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
  0%|          | 1/400 [05:54<39:16:49, 354.41s/it]  0%|          | 2/400 [11:51<39:21:22, 355.99s/it]  1%|          | 3/400 [17:52<39:31:49, 358.46s/it]  1%|          | 4/400 [23:55<39:37:17, 360.20s/it]  1%|▏         | 5/400 [29:52<39:23:02, 358.94s/it]  2%|▏         | 6/400 [35:48<39:10:47, 357.99s/it]  2%|▏         | 7/400 [41:40<38:52:37, 356.13s/it]  2%|▏         | 8/400 [47:39<38:51:47, 356.91s/it]  2%|▏         | 9/400 [53:33<38:40:40, 356.11s/it]  2%|▎         | 10/400 [59:20<38:15:18, 353.13s/it]  3%|▎         | 11/400 [1:05:24<38:30:40, 356.40s/it]  3%|▎         | 12/400 [1:11:12<38:08:13, 353.85s/it]  3%|▎         | 13/400 [1:16:54<37:40:36, 350.48s/it]  4%|▎         | 14/400 [1:22:40<37:26:13, 349.15s/it]  4%|▍         | 15/400 [1:28:08<36:37:59, 342.54s/it]  4%|▍         | 16/400 [1:34:04<36:58:47, 346.69s/it]  4%|▍         | 17/400 [1:40:10<37:31:04, 352.65s/it]  4%|▍         | 18/400 [1:45:53<37:05:02, 349.48s/it]  5%|▍         | 19/400 [1:51:39<36:53:31, 348.59s/it]  5%|▌         | 20/400 [1:57:27<36:46:36, 348.41s/it]  5%|▌         | 21/400 [2:03:17<36:42:41, 348.71s/it]  6%|▌         | 22/400 [2:09:09<36:44:03, 349.85s/it]  6%|▌         | 23/400 [2:15:20<37:18:39, 356.29s/it]  6%|▌         | 24/400 [2:21:17<37:14:22, 356.55s/it]  6%|▋         | 25/400 [2:27:09<36:59:31, 355.12s/it]  6%|▋         | 26/400 [2:33:12<37:08:13, 357.47s/it]  7%|▋         | 27/400 [2:39:01<36:46:34, 354.94s/it]  7%|▋         | 28/400 [2:45:05<36:56:22, 357.48s/it]  7%|▋         | 29/400 [2:50:41<36:11:12, 351.14s/it]  8%|▊         | 30/400 [2:56:33<36:06:55, 351.39s/it]  8%|▊         | 31/400 [3:02:17<35:48:00, 349.27s/it]  8%|▊         | 32/400 [3:07:57<35:24:01, 346.31s/it]  8%|▊         | 33/400 [3:14:01<35:51:22, 351.72s/it]  8%|▊         | 34/400 [3:20:06<36:09:57, 355.73s/it]  9%|▉         | 35/400 [3:25:51<35:43:54, 352.42s/it]  9%|▉         | 36/400 [3:32:03<36:14:36, 358.45s/it]  9%|▉         | 37/400 [3:38:04<36:12:47, 359.14s/it] 10%|▉         | 38/400 [3:43:47<35:37:52, 354.34s/it] 10%|▉         | 39/400 [3:49:55<35:56:59, 358.50s/it] 10%|█         | 40/400 [3:55:56<35:54:08, 359.02s/it] 10%|█         | 41/400 [4:01:35<35:13:24, 353.21s/it] 10%|█         | 42/400 [4:07:36<35:20:50, 355.45s/it] 11%|█         | 43/400 [4:13:23<34:59:01, 352.78s/it] 11%|█         | 44/400 [4:19:23<35:07:06, 355.13s/it] 11%|█▏        | 45/400 [4:25:12<34:50:31, 353.33s/it] 12%|█▏        | 46/400 [4:31:06<34:44:56, 353.38s/it] 12%|█▏        | 47/400 [4:36:59<34:38:09, 353.23s/it] 12%|█▏        | 48/400 [4:42:47<34:24:20, 351.88s/it] 12%|█▏        | 49/400 [4:48:56<34:48:28, 357.00s/it] 12%|█▎        | 50/400 [4:54:42<34:22:09, 353.51s/it] 13%|█▎        | 51/400 [5:00:19<33:47:37, 348.59s/it] 13%|█▎        | 52/400 [5:06:03<33:34:44, 347.37s/it] 13%|█▎        | 53/400 [5:11:38<33:06:11, 343.43s/it] 14%|█▎        | 54/400 [5:17:44<33:39:44, 350.25s/it] 14%|█▍        | 55/400 [5:23:36<33:37:32, 350.88s/it] 14%|█▍        | 56/400 [5:29:25<33:28:39, 350.35s/it] 14%|█▍        | 57/400 [5:35:11<33:15:33, 349.08s/it] 14%|█▍        | 58/400 [5:41:07<33:21:43, 351.18s/it] 15%|█▍        | 59/400 [5:47:11<33:36:40, 354.84s/it] 15%|█▌        | 60/400 [5:53:08<33:35:18, 355.64s/it] 15%|█▌        | 61/400 [5:59:05<33:31:34, 356.03s/it] 16%|█▌        | 62/400 [6:04:46<33:00:30, 351.57s/it] 16%|█▌        | 63/400 [6:10:50<33:14:45, 355.15s/it] 16%|█▌        | 64/400 [6:16:44<33:07:38, 354.94s/it] 16%|█▋        | 65/400 [6:22:40<33:02:50, 355.13s/it] 16%|█▋        | 66/400 [6:28:21<32:34:06, 351.04s/it] 17%|█▋        | 67/400 [6:34:16<32:33:20, 351.95s/it] 17%|█▋        | 68/400 [6:40:10<32:32:07, 352.80s/it] 17%|█▋        | 69/400 [6:46:08<32:34:09, 354.23s/it] 18%|█▊        | 70/400 [6:52:08<32:37:18, 355.87s/it] 18%|█▊        | 71/400 [6:58:04<32:32:29, 356.08s/it] 18%|█▊        | 72/400 [7:04:07<32:37:43, 358.12s/it] 18%|█▊        | 73/400 [7:10:00<32:22:52, 356.49s/it] 18%|█▊        | 74/400 [7:15:55<32:15:34, 356.24s/it] 19%|█▉        | 75/400 [7:21:51<32:08:29, 356.03s/it] 19%|█▉        | 76/400 [7:27:39<31:48:55, 353.50s/it] 19%|█▉        | 77/400 [7:33:36<31:49:43, 354.75s/it] 20%|█▉        | 78/400 [7:39:31<31:44:32, 354.88s/it] 20%|█▉        | 79/400 [7:45:15<31:21:07, 351.61s/it] 20%|██        | 80/400 [7:51:07<31:16:00, 351.75s/it] 20%|██        | 81/400 [7:57:09<31:25:50, 354.70s/it] 20%|██        | 82/400 [8:03:03<31:18:38, 354.46s/it] 21%|██        | 83/400 [8:09:02<31:20:06, 355.86s/it] 21%|██        | 84/400 [8:14:59<31:15:34, 356.12s/it] 21%|██▏       | 85/400 [8:20:57<31:12:18, 356.63s/it] 22%|██▏       | 86/400 [8:27:03<31:21:14, 359.47s/it] 22%|██▏       | 87/400 [8:32:59<31:10:57, 358.65s/it] 22%|██▏       | 88/400 [8:38:58<31:04:26, 358.55s/it] 22%|██▏       | 89/400 [8:44:56<30:57:26, 358.35s/it] 22%|██▎       | 90/400 [8:50:54<30:50:48, 358.22s/it] 23%|██▎       | 91/400 [8:56:59<30:56:22, 360.46s/it] 23%|██▎       | 92/400 [9:02:36<30:13:41, 353.32s/it] 23%|██▎       | 93/400 [9:08:26<30:03:01, 352.38s/it] 24%|██▎       | 94/400 [9:14:17<29:55:25, 352.04s/it] 24%|██▍       | 95/400 [9:20:08<29:46:48, 351.50s/it] 24%|██▍       | 96/400 [9:26:06<29:51:44, 353.63s/it] 24%|██▍       | 97/400 [9:32:02<29:49:38, 354.39s/it] 24%|██▍       | 98/400 [9:37:57<29:44:19, 354.50s/it] 25%|██▍       | 99/400 [9:43:53<29:40:34, 354.93s/it] 25%|██▌       | 100/400 [9:49:34<29:14:21, 350.87s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/gpt2-large_10_hh_poisoned_0.1/checkpoint-100 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 25%|██▌       | 101/400 [9:55:41<29:31:45, 355.54s/it] 26%|██▌       | 102/400 [10:01:36<29:24:42, 355.31s/it] 26%|██▌       | 103/400 [10:07:32<29:20:43, 355.70s/it] 26%|██▌       | 104/400 [10:13:21<29:04:34, 353.63s/it] 26%|██▋       | 105/400 [10:19:14<28:57:27, 353.38s/it] 26%|██▋       | 106/400 [10:25:17<29:05:20, 356.19s/it] 27%|██▋       | 107/400 [10:31:24<29:16:06, 359.61s/it] 27%|██▋       | 108/400 [10:37:03<28:39:47, 353.38s/it] 27%|██▋       | 109/400 [10:42:55<28:32:19, 353.06s/it] 28%|██▊       | 110/400 [10:48:46<28:23:29, 352.45s/it] 28%|██▊       | 111/400 [10:54:41<28:21:21, 353.22s/it] 28%|██▊       | 112/400 [11:00:35<28:15:22, 353.20s/it] 28%|██▊       | 113/400 [11:06:19<27:56:56, 350.58s/it] 28%|██▊       | 114/400 [11:12:03<27:42:21, 348.75s/it] 29%|██▉       | 115/400 [11:18:00<27:47:53, 351.14s/it] 29%|██▉       | 116/400 [11:23:51<27:42:01, 351.13s/it] 29%|██▉       | 117/400 [11:29:56<27:55:51, 355.31s/it] 30%|██▉       | 118/400 [11:35:50<27:47:42, 354.83s/it] 30%|██▉       | 119/400 [11:41:46<27:43:57, 355.29s/it] 30%|███       | 120/400 [11:47:45<27:42:42, 356.29s/it] 30%|███       | 121/400 [11:53:30<27:20:31, 352.80s/it] 30%|███       | 122/400 [11:59:19<27:09:05, 351.60s/it] 31%|███       | 123/400 [12:05:15<27:10:05, 353.09s/it] 31%|███       | 124/400 [12:11:07<27:02:07, 352.64s/it] 31%|███▏      | 125/400 [12:16:55<26:50:01, 351.28s/it] 32%|███▏      | 126/400 [12:22:45<26:42:36, 350.94s/it] 32%|███▏      | 127/400 [12:28:38<26:39:18, 351.50s/it] 32%|███▏      | 128/400 [12:34:37<26:43:23, 353.69s/it] 32%|███▏      | 129/400 [12:40:34<26:43:09, 354.94s/it] 32%|███▎      | 130/400 [12:46:33<26:42:20, 356.08s/it] 33%|███▎      | 131/400 [12:52:37<26:46:53, 358.41s/it] 33%|███▎      | 132/400 [12:58:18<26:17:23, 353.15s/it] 33%|███▎      | 133/400 [13:04:17<26:20:11, 355.10s/it] 34%|███▎      | 134/400 [13:10:17<26:19:49, 356.35s/it] 34%|███▍      | 135/400 [13:16:22<26:25:50, 359.06s/it] 34%|███▍      | 136/400 [13:22:26<26:26:23, 360.54s/it] 34%|███▍      | 137/400 [13:28:20<26:11:29, 358.52s/it] 34%|███▍      | 138/400 [13:34:10<25:54:40, 356.03s/it] 35%|███▍      | 139/400 [13:40:03<25:44:05, 354.96s/it] 35%|███▌      | 140/400 [13:46:01<25:42:02, 355.85s/it] 35%|███▌      | 141/400 [13:52:03<25:44:13, 357.74s/it] 36%|███▌      | 142/400 [13:57:52<25:26:53, 355.09s/it] 36%|███▌      | 143/400 [14:03:46<25:20:13, 354.92s/it] 36%|███▌      | 144/400 [14:09:30<24:59:43, 351.50s/it] 36%|███▋      | 145/400 [14:15:25<24:58:20, 352.55s/it] 36%|███▋      | 146/400 [14:21:16<24:50:44, 352.15s/it] 37%|███▋      | 147/400 [14:27:02<24:36:43, 350.21s/it] 37%|███▋      | 148/400 [14:32:58<24:39:15, 352.20s/it] 37%|███▋      | 149/400 [14:38:50<24:32:34, 352.01s/it] 38%|███▊      | 150/400 [14:44:32<24:13:43, 348.89s/it] 38%|███▊      | 151/400 [14:50:17<24:03:04, 347.73s/it] 38%|███▊      | 152/400 [14:56:16<24:12:01, 351.30s/it] 38%|███▊      | 153/400 [15:02:16<24:16:40, 353.85s/it] 38%|███▊      | 154/400 [15:08:20<24:22:53, 356.80s/it] 39%|███▉      | 155/400 [15:14:24<24:25:55, 359.00s/it] 39%|███▉      | 156/400 [15:20:00<23:51:36, 352.03s/it] 39%|███▉      | 157/400 [15:25:56<23:50:33, 353.22s/it] 40%|███▉      | 158/400 [15:31:45<23:40:30, 352.19s/it] 40%|███▉      | 159/400 [15:37:50<23:49:17, 355.84s/it] 40%|████      | 160/400 [15:43:39<23:35:01, 353.76s/it] 40%|████      | 161/400 [15:49:47<23:46:27, 358.11s/it] 40%|████      | 162/400 [15:55:24<23:15:24, 351.78s/it] 41%|████      | 163/400 [16:01:19<23:13:08, 352.69s/it] 41%|████      | 164/400 [16:07:18<23:15:31, 354.79s/it] 41%|████▏     | 165/400 [16:13:04<22:58:20, 351.92s/it] 42%|████▏     | 166/400 [16:18:50<22:45:57, 350.25s/it] 42%|████▏     | 167/400 [16:24:52<22:54:20, 353.91s/it] 42%|████▏     | 168/400 [16:30:50<22:52:23, 354.93s/it] 42%|████▏     | 169/400 [16:36:41<22:42:13, 353.83s/it] 42%|████▎     | 170/400 [16:42:35<22:36:22, 353.84s/it] 43%|████▎     | 171/400 [16:48:30<22:31:47, 354.18s/it] 43%|████▎     | 172/400 [16:54:16<22:16:11, 351.63s/it] 43%|████▎     | 173/400 [17:00:13<22:17:18, 353.47s/it] 44%|████▎     | 174/400 [17:06:06<22:10:56, 353.35s/it] 44%|████▍     | 175/400 [17:11:52<21:56:37, 351.10s/it] 44%|████▍     | 176/400 [17:17:50<21:58:47, 353.25s/it] 44%|████▍     | 177/400 [17:23:59<22:09:29, 357.71s/it] 44%|████▍     | 178/400 [17:30:01<22:08:52, 359.16s/it] 45%|████▍     | 179/400 [17:35:49<21:50:34, 355.81s/it] 45%|████▌     | 180/400 [17:41:41<21:40:39, 354.73s/it] 45%|████▌     | 181/400 [17:47:27<21:25:14, 352.12s/it] 46%|████▌     | 182/400 [17:53:25<21:25:19, 353.76s/it] 46%|████▌     | 183/400 [17:59:21<21:21:59, 354.47s/it] 46%|████▌     | 184/400 [18:05:20<21:20:54, 355.81s/it] 46%|████▋     | 185/400 [18:11:07<21:05:18, 353.11s/it] 46%|████▋     | 186/400 [18:17:04<21:04:14, 354.46s/it] 47%|████▋     | 187/400 [18:22:57<20:56:03, 353.82s/it] 47%|████▋     | 188/400 [18:28:52<20:51:21, 354.16s/it] 47%|████▋     | 189/400 [18:34:45<20:44:34, 353.91s/it] 48%|████▊     | 190/400 [18:40:42<20:41:37, 354.75s/it] 48%|████▊     | 191/400 [18:46:47<20:47:00, 357.99s/it] 48%|████▊     | 192/400 [18:52:39<20:34:09, 356.00s/it] 48%|████▊     | 193/400 [18:58:40<20:34:03, 357.70s/it] 48%|████▊     | 194/400 [19:04:34<20:24:01, 356.51s/it] 49%|████▉     | 195/400 [19:10:27<20:14:39, 355.51s/it] 49%|████▉     | 196/400 [19:16:04<19:49:44, 349.92s/it] 49%|████▉     | 197/400 [19:22:01<19:51:00, 352.02s/it] 50%|████▉     | 198/400 [19:27:56<19:48:34, 353.04s/it] 50%|████▉     | 199/400 [19:33:52<19:45:21, 353.84s/it] 50%|█████     | 200/400 [19:39:52<19:45:22, 355.61s/it]Checkpoint destination directory /cmlscratch/pan/RLHF_Poisoning/models/trained_reward/gpt2-large_10_hh_poisoned_0.1/checkpoint-200 already exists and is non-empty.Saving will proceed but saved results may be invalid.
/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 50%|█████     | 201/400 [19:46:03<19:54:28, 360.15s/it] 50%|█████     | 202/400 [19:51:52<19:38:05, 357.00s/it] 51%|█████     | 203/400 [19:57:45<19:27:25, 355.56s/it] 51%|█████     | 204/400 [20:03:35<19:16:32, 354.04s/it] 51%|█████▏    | 205/400 [20:09:35<19:16:38, 355.89s/it] 52%|█████▏    | 206/400 [20:15:18<18:57:55, 351.93s/it] 52%|█████▏    | 207/400 [20:21:16<18:57:35, 353.65s/it] 52%|█████▏    | 208/400 [20:27:03<18:46:08, 351.92s/it] 52%|█████▏    | 209/400 [20:32:33<18:19:23, 345.36s/it] 52%|█████▎    | 210/400 [20:38:26<18:20:48, 347.63s/it] 53%|█████▎    | 211/400 [20:44:32<18:31:32, 352.87s/it] 53%|█████▎    | 212/400 [20:50:22<18:23:30, 352.18s/it] 53%|█████▎    | 213/400 [20:56:23<18:25:52, 354.83s/it] 54%|█████▎    | 214/400 [21:02:18<18:19:50, 354.79s/it] 54%|█████▍    | 215/400 [21:08:26<18:26:05, 358.73s/it] 54%|█████▍    | 216/400 [21:14:32<18:26:43, 360.89s/it] 54%|█████▍    | 217/400 [21:20:37<18:25:06, 362.33s/it] 55%|█████▍    | 218/400 [21:26:40<18:19:31, 362.48s/it] 55%|█████▍    | 219/400 [21:32:36<18:07:43, 360.57s/it] 55%|█████▌    | 220/400 [21:38:27<17:52:41, 357.56s/it] 55%|█████▌    | 221/400 [21:44:31<17:52:21, 359.45s/it] 56%|█████▌    | 222/400 [21:50:22<17:38:57, 356.95s/it] 56%|█████▌    | 223/400 [21:56:16<17:30:47, 356.20s/it] 56%|█████▌    | 224/400 [22:02:04<17:17:25, 353.67s/it] 56%|█████▋    | 225/400 [22:07:52<17:06:53, 352.08s/it] 56%|█████▋    | 226/400 [22:13:40<16:56:43, 350.59s/it] 57%|█████▋    | 227/400 [22:19:47<17:05:05, 355.53s/it] 57%|█████▋    | 228/400 [22:25:52<17:07:20, 358.37s/it] 57%|█████▋    | 229/400 [22:31:53<17:04:12, 359.37s/it] 57%|█████▊    | 230/400 [22:37:42<16:49:08, 356.17s/it] 58%|█████▊    | 231/400 [22:43:32<16:37:49, 354.26s/it] 58%|█████▊    | 232/400 [22:49:04<16:13:32, 347.69s/it] 58%|█████▊    | 233/400 [22:55:03<16:17:08, 351.07s/it] 58%|█████▊    | 234/400 [23:01:06<16:21:22, 354.72s/it] 59%|█████▉    | 235/400 [23:06:52<16:08:18, 352.11s/it] 59%|█████▉    | 236/400 [23:12:47<16:04:41, 352.94s/it] 59%|█████▉    | 237/400 [23:18:40<15:59:04, 353.03s/it] 60%|█████▉    | 238/400 [23:24:31<15:51:09, 352.28s/it] 60%|█████▉    | 239/400 [23:30:22<15:44:25, 351.96s/it] 60%|██████    | 240/400 [23:36:07<15:32:43, 349.77s/it] 60%|██████    | 241/400 [23:42:04<15:32:52, 352.03s/it] 60%|██████    | 242/400 [23:47:45<15:18:09, 348.67s/it] 61%|██████    | 243/400 [23:53:38<15:15:53, 350.02s/it] 61%|██████    | 244/400 [23:59:37<15:16:53, 352.65s/it] 61%|██████▏   | 245/400 [24:05:19<15:03:08, 349.60s/it] 62%|██████▏   | 246/400 [24:11:16<15:02:28, 351.61s/it] 62%|██████▏   | 247/400 [24:17:05<14:54:56, 350.96s/it] 62%|██████▏   | 248/400 [24:23:02<14:53:13, 352.59s/it] 62%|██████▏   | 249/400 [24:28:49<14:43:15, 350.96s/it] 62%|██████▎   | 250/400 [24:34:31<14:30:40, 348.27s/it] 63%|██████▎   | 251/400 [24:40:36<14:37:51, 353.50s/it] 63%|██████▎   | 252/400 [24:46:30<14:32:17, 353.63s/it] 63%|██████▎   | 253/400 [24:52:25<14:27:06, 353.92s/it] 64%|██████▎   | 254/400 [24:58:35<14:32:38, 358.62s/it] 64%|██████▍   | 255/400 [25:04:32<14:25:35, 358.18s/it] 64%|██████▍   | 256/400 [25:10:18<14:11:06, 354.63s/it] 64%|██████▍   | 257/400 [25:16:17<14:08:11, 355.89s/it] 64%|██████▍   | 258/400 [25:21:57<13:51:01, 351.14s/it] 65%|██████▍   | 259/400 [25:27:51<13:47:06, 351.96s/it] 65%|██████▌   | 260/400 [25:33:41<13:39:58, 351.42s/it] 65%|██████▌   | 261/400 [25:39:38<13:38:04, 353.12s/it] 66%|██████▌   | 262/400 [25:45:26<13:28:55, 351.71s/it] 66%|██████▌   | 263/400 [25:51:31<13:31:51, 355.56s/it] 66%|██████▌   | 264/400 [25:57:20<13:21:36, 353.65s/it] 66%|██████▋   | 265/400 [26:03:18<13:18:12, 354.76s/it] 66%|██████▋   | 266/400 [26:09:16<13:14:52, 355.92s/it] 67%|██████▋   | 267/400 [26:15:10<13:07:41, 355.35s/it] 67%|██████▋   | 268/400 [26:21:05<13:01:14, 355.11s/it] 67%|██████▋   | 269/400 [26:26:55<12:52:08, 353.65s/it] 68%|██████▊   | 270/400 [26:32:43<12:42:40, 352.01s/it] 68%|██████▊   | 271/400 [26:38:27<12:31:23, 349.49s/it] 68%|██████▊   | 272/400 [26:44:22<12:29:21, 351.26s/it] 68%|██████▊   | 273/400 [26:50:20<12:27:38, 353.21s/it] 68%|██████▊   | 274/400 [26:56:12<12:20:45, 352.74s/it] 69%|██████▉   | 275/400 [27:02:12<12:19:38, 355.03s/it] 69%|██████▉   | 276/400 [27:08:22<12:23:18, 359.67s/it] 69%|██████▉   | 277/400 [27:14:31<12:22:59, 362.44s/it] 70%|██████▉   | 278/400 [27:20:29<12:14:08, 361.05s/it] 70%|██████▉   | 279/400 [27:26:11<11:56:38, 355.36s/it] 70%|███████   | 280/400 [27:31:56<11:44:27, 352.23s/it] 70%|███████   | 281/400 [27:37:53<11:41:22, 353.63s/it] 70%|███████   | 282/400 [27:44:01<11:44:11, 358.06s/it] 71%|███████   | 283/400 [27:49:53<11:34:39, 356.24s/it] 71%|███████   | 284/400 [27:55:56<11:32:25, 358.15s/it] 71%|███████▏  | 285/400 [28:01:58<11:28:35, 359.27s/it] 72%|███████▏  | 286/400 [28:07:58<11:22:52, 359.41s/it] 72%|███████▏  | 287/400 [28:14:00<11:18:42, 360.37s/it] 72%|███████▏  | 288/400 [28:19:50<11:06:43, 357.17s/it] 72%|███████▏  | 289/400 [28:25:34<10:53:19, 353.15s/it] 72%|███████▎  | 290/400 [28:31:27<10:47:20, 353.09s/it] 73%|███████▎  | 291/400 [28:37:38<10:51:36, 358.68s/it] 73%|███████▎  | 292/400 [28:43:38<10:45:55, 358.85s/it] 73%|███████▎  | 293/400 [28:49:24<10:32:59, 354.94s/it] 74%|███████▎  | 294/400 [28:55:10<10:22:22, 352.28s/it] 74%|███████▍  | 295/400 [29:01:00<10:15:19, 351.61s/it] 74%|███████▍  | 296/400 [29:06:50<10:08:51, 351.27s/it] 74%|███████▍  | 297/400 [29:12:45<10:05:08, 352.51s/it] 74%|███████▍  | 298/400 [29:18:53<10:07:03, 357.10s/it] 75%|███████▍  | 299/400 [29:24:46<9:59:05, 355.89s/it]  75%|███████▌  | 300/400 [29:30:46<9:55:14, 357.14s/it]/cmlscratch/pan/conda/lib/python3.11/site-packages/transformers/tokenization_utils_base.py:2636: UserWarning: `max_length` is ignored when `padding`=`True` and there is no truncation strategy. To pad to max length, use `padding='max_length'`.
  warnings.warn(
 75%|███████▌  | 301/400 [29:36:58<9:56:23, 361.45s/it] 76%|███████▌  | 302/400 [29:42:51<9:46:16, 358.94s/it] 76%|███████▌  | 303/400 [29:48:29<9:30:19, 352.78s/it] 76%|███████▌  | 304/400 [29:54:12<9:19:31, 349.70s/it] 76%|███████▋  | 305/400 [30:00:10<9:17:36, 352.18s/it] 76%|███████▋  | 306/400 [30:05:58<9:09:48, 350.94s/it] 77%|███████▋  | 307/400 [30:11:46<9:02:37, 350.08s/it] 77%|███████▋  | 308/400 [30:17:52<9:04:19, 355.00s/it] 77%|███████▋  | 309/400 [30:23:46<8:57:36, 354.47s/it] 78%|███████▊  | 310/400 [30:29:36<8:49:58, 353.32s/it] 78%|███████▊  | 311/400 [30:35:13<8:36:38, 348.30s/it] 78%|███████▊  | 312/400 [30:41:02<8:31:05, 348.47s/it] 78%|███████▊  | 313/400 [30:47:07<8:32:29, 353.45s/it] 78%|███████▊  | 314/400 [30:52:56<8:24:52, 352.24s/it] 79%|███████▉  | 315/400 [30:58:55<8:21:46, 354.20s/it] 79%|███████▉  | 316/400 [31:04:44<8:13:39, 352.61s/it] 79%|███████▉  | 317/400 [31:10:43<8:10:26, 354.53s/it] 80%|███████▉  | 318/400 [31:16:40<8:05:32, 355.27s/it] 80%|███████▉  | 319/400 [31:22:13<7:50:44, 348.70s/it] 80%|████████  | 320/400 [31:27:59<7:43:41, 347.77s/it] 80%|████████  | 321/400 [31:33:51<7:39:35, 349.05s/it] 80%|████████  | 322/400 [31:39:37<7:32:44, 348.26s/it] 81%|████████  | 323/400 [31:45:25<7:26:41, 348.08s/it] 81%|████████  | 324/400 [31:51:29<7:27:00, 352.90s/it] 81%|████████▏ | 325/400 [31:57:24<7:21:41, 353.35s/it] 82%|████████▏ | 326/400 [32:03:09<7:12:50, 350.95s/it] 82%|████████▏ | 327/400 [32:08:49<7:03:04, 347.73s/it] 82%|████████▏ | 328/400 [32:14:54<7:03:28, 352.89s/it] 82%|████████▏ | 329/400 [32:20:45<6:56:54, 352.31s/it] 82%|████████▎ | 330/400 [32:26:27<6:47:33, 349.33s/it] 83%|████████▎ | 331/400 [32:32:20<6:42:56, 350.39s/it] 83%|████████▎ | 332/400 [32:38:08<6:36:03, 349.46s/it] 83%|████████▎ | 333/400 [32:44:14<6:36:03, 354.68s/it] 84%|████████▎ | 334/400 [32:50:01<6:27:33, 352.33s/it] 84%|████████▍ | 335/400 [32:56:02<6:24:26, 354.87s/it] 84%|████████▍ | 336/400 [33:01:58<6:18:44, 355.06s/it] 84%|████████▍ | 337/400 [33:08:01<6:15:17, 357.43s/it] 84%|████████▍ | 338/400 [33:13:48<6:06:09, 354.34s/it] 85%|████████▍ | 339/400 [33:19:41<5:59:47, 353.89s/it] 85%|████████▌ | 340/400 [33:25:44<5:56:43, 356.73s/it] 85%|████████▌ | 341/400 [33:31:36<5:49:32, 355.47s/it] 86%|████████▌ | 342/400 [33:37:31<5:43:26, 355.28s/it] 86%|████████▌ | 343/400 [33:43:18<5:35:13, 352.86s/it] 86%|████████▌ | 344/400 [33:49:22<5:32:23, 356.13s/it] 86%|████████▋ | 345/400 [33:55:27<5:28:52, 358.77s/it] 86%|████████▋ | 346/400 [34:01:21<5:21:29, 357.22s/it] 87%|████████▋ | 347/400 [34:07:19<5:15:46, 357.48s/it] 87%|████████▋ | 348/400 [34:13:19<5:10:34, 358.35s/it] 87%|████████▋ | 349/400 [34:19:15<5:03:53, 357.53s/it] 88%|████████▊ | 350/400 [34:25:15<4:58:28, 358.17s/it] 88%|████████▊ | 351/400 [34:31:07<4:51:08, 356.50s/it] 88%|████████▊ | 352/400 [34:37:02<4:44:45, 355.94s/it] 88%|████████▊ | 353/400 [34:43:03<4:40:08, 357.62s/it] 88%|████████▊ | 354/400 [34:48:58<4:33:32, 356.80s/it] 89%|████████▉ | 355/400 [34:54:55<4:27:32, 356.72s/it] 89%|████████▉ | 356/400 [35:00:40<4:19:01, 353.21s/it] 89%|████████▉ | 357/400 [35:06:41<4:14:50, 355.59s/it] 90%|████████▉ | 358/400 [35:12:36<4:08:49, 355.46s/it] 90%|████████▉ | 359/400 [35:18:34<4:03:19, 356.09s/it] 90%|█████████ | 360/400 [35:24:23<3:56:06, 354.16s/it] 90%|█████████ | 361/400 [35:30:18<3:50:21, 354.40s/it] 90%|█████████ | 362/400 [35:35:58<3:41:40, 350.01s/it] 91%|█████████ | 363/400 [35:41:53<3:36:42, 351.42s/it] 91%|█████████ | 364/400 [35:47:33<3:28:53, 348.16s/it] 91%|█████████▏| 365/400 [35:53:21<3:23:05, 348.16s/it] 92%|█████████▏| 366/400 [35:59:10<3:17:25, 348.40s/it] 92%|█████████▏| 367/400 [36:05:05<3:12:43, 350.40s/it] 92%|█████████▏| 368/400 [36:11:08<3:08:51, 354.12s/it] 92%|█████████▏| 369/400 [36:17:17<3:05:09, 358.38s/it] 92%|█████████▎| 370/400 [36:23:08<2:58:13, 356.44s/it] 93%|█████████▎| 371/400 [36:29:02<2:51:52, 355.61s/it] 93%|█████████▎| 372/400 [36:34:47<2:44:24, 352.32s/it] 93%|█████████▎| 373/400 [36:40:49<2:39:53, 355.31s/it] 94%|█████████▎| 374/400 [36:46:34<2:32:38, 352.23s/it] 94%|█████████▍| 375/400 [36:52:25<2:26:34, 351.80s/it] 94%|█████████▍| 376/400 [36:58:28<2:22:02, 355.11s/it] 94%|█████████▍| 377/400 [37:04:33<2:17:17, 358.14s/it] 94%|█████████▍| 378/400 [37:10:34<2:11:40, 359.10s/it] 95%|█████████▍| 379/400 [37:16:28<2:05:07, 357.48s/it] 95%|█████████▌| 380/400 [37:22:35<2:00:05, 360.28s/it] 95%|█████████▌| 381/400 [37:28:33<1:53:52, 359.58s/it] 96%|█████████▌| 382/400 [37:34:23<1:47:03, 356.86s/it] 96%|█████████▌| 383/400 [37:40:12<1:40:23, 354.30s/it] 96%|█████████▌| 384/400 [37:46:02<1:34:12, 353.29s/it] 96%|█████████▋| 385/400 [37:52:10<1:29:22, 357.52s/it] 96%|█████████▋| 386/400 [37:58:03<1:23:05, 356.14s/it] 97%|█████████▋| 387/400 [38:04:08<1:17:44, 358.81s/it] 97%|█████████▋| 388/400 [38:10:02<1:11:29, 357.48s/it] 97%|█████████▋| 389/400 [38:16:10<1:06:07, 360.65s/it] 98%|█████████▊| 390/400 [38:21:51<59:05, 354.58s/it]   98%|█████████▊| 391/400 [38:27:46<53:14, 354.92s/it] 98%|█████████▊| 392/400 [38:33:47<47:32, 356.52s/it] 98%|█████████▊| 393/400 [38:39:36<41:20, 354.40s/it] 98%|█████████▊| 394/400 [38:45:36<35:36, 356.11s/it] 99%|█████████▉| 395/400 [38:51:25<29:30, 354.01s/it] 99%|█████████▉| 396/400 [38:57:21<23:37, 354.45s/it] 99%|█████████▉| 397/400 [39:02:56<17:26, 348.74s/it]100%|█████████▉| 398/400 [39:08:58<11:45, 352.66s/it]100%|█████████▉| 399/400 [39:14:44<05:50, 350.66s/it]100%|██████████| 400/400 [39:20:35<00:00, 350.86s/it]                                                     100%|██████████| 400/400 [39:20:53<00:00, 350.86s/it]100%|██████████| 400/400 [39:20:53<00:00, 354.13s/it]
END of SLURM commands
