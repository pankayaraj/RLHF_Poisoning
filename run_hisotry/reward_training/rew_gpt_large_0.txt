python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="gpt2-large" --epoch=9 --sft_epoch=3 --dataset="hh_original"
------
{'loss': 0.7482, 'learning_rate': 4.946156662574573e-05, 'epoch': 0.1}
{'loss': 0.887, 'learning_rate': 4.8923133251491464e-05, 'epoch': 0.19}
{'loss': 0.7842, 'learning_rate': 4.8384699877237195e-05, 'epoch': 0.29}
{'loss': 0.8242, 'learning_rate': 4.784626650298292e-05, 'epoch': 0.39}
{'loss': 0.8412, 'learning_rate': 4.730783312872865e-05, 'epoch': 0.48}
{'loss': 0.8102, 'learning_rate': 4.676939975447439e-05, 'epoch': 0.58}
{'loss': 0.8597, 'learning_rate': 4.623096638022011e-05, 'epoch': 0.68}
{'loss': 0.814, 'learning_rate': 4.569253300596584e-05, 'epoch': 0.78}
{'loss': 0.7815, 'learning_rate': 4.5154099631711574e-05, 'epoch': 0.87}
{'loss': 0.7911, 'learning_rate': 4.4615666257457305e-05, 'epoch': 0.97}
{'loss': 0.7701, 'learning_rate': 4.4077232883203036e-05, 'epoch': 1.07}
{'loss': 0.7362, 'learning_rate': 4.353879950894876e-05, 'epoch': 1.16}
{'loss': 0.7575, 'learning_rate': 4.30003661346945e-05, 'epoch': 1.26}
{'loss': 0.7679, 'learning_rate': 4.246193276044023e-05, 'epoch': 1.36}
{'loss': 0.7442, 'learning_rate': 4.192349938618595e-05, 'epoch': 1.45}
{'loss': 0.7191, 'learning_rate': 4.1385066011931684e-05, 'epoch': 1.55}
{'loss': 0.7714, 'learning_rate': 4.0846632637677415e-05, 'epoch': 1.65}
{'loss': 0.7365, 'learning_rate': 4.0308199263423146e-05, 'epoch': 1.74}
{'loss': 0.775, 'learning_rate': 3.9769765889168877e-05, 'epoch': 1.84}
{'loss': 0.7339, 'learning_rate': 3.92313325149146e-05, 'epoch': 1.94}
{'loss': 0.7615, 'learning_rate': 3.869289914066034e-05, 'epoch': 2.04}
{'loss': 0.6298, 'learning_rate': 3.815446576640607e-05, 'epoch': 2.13}
{'loss': 0.6668, 'learning_rate': 3.7616032392151793e-05, 'epoch': 2.23}
{'loss': 0.6674, 'learning_rate': 3.707759901789753e-05, 'epoch': 2.33}
{'loss': 0.621, 'learning_rate': 3.6539165643643255e-05, 'epoch': 2.42}
{'loss': 0.6582, 'learning_rate': 3.6000732269388986e-05, 'epoch': 2.52}
{'loss': 0.6184, 'learning_rate': 3.546229889513472e-05, 'epoch': 2.62}
{'loss': 0.6692, 'learning_rate': 3.492386552088045e-05, 'epoch': 2.71}
{'loss': 0.6629, 'learning_rate': 3.438543214662618e-05, 'epoch': 2.81}
{'loss': 0.6785, 'learning_rate': 3.384699877237191e-05, 'epoch': 2.91}
{'loss': 0.6835, 'learning_rate': 3.3308565398117634e-05, 'epoch': 3.0}
{'loss': 0.6195, 'learning_rate': 3.277013202386337e-05, 'epoch': 3.1}
{'loss': 0.5533, 'learning_rate': 3.2231698649609096e-05, 'epoch': 3.2}
{'loss': 0.5947, 'learning_rate': 3.169326527535483e-05, 'epoch': 3.3}
{'loss': 0.5302, 'learning_rate': 3.1154831901100565e-05, 'epoch': 3.39}
{'loss': 0.6198, 'learning_rate': 3.061639852684629e-05, 'epoch': 3.49}
{'loss': 0.5602, 'learning_rate': 3.007796515259202e-05, 'epoch': 3.59}
{'loss': 0.6007, 'learning_rate': 2.9539531778337747e-05, 'epoch': 3.68}
{'loss': 0.6154, 'learning_rate': 2.900109840408348e-05, 'epoch': 3.78}
{'loss': 0.5796, 'learning_rate': 2.846266502982921e-05, 'epoch': 3.88}
{'loss': 0.633, 'learning_rate': 2.792423165557494e-05, 'epoch': 3.97}
{'loss': 0.5077, 'learning_rate': 2.7385798281320668e-05, 'epoch': 4.07}
{'loss': 0.5216, 'learning_rate': 2.6847364907066402e-05, 'epoch': 4.17}
{'loss': 0.5195, 'learning_rate': 2.630893153281213e-05, 'epoch': 4.26}
{'loss': 0.5004, 'learning_rate': 2.577049815855786e-05, 'epoch': 4.36}
{'loss': 0.5064, 'learning_rate': 2.5232064784303595e-05, 'epoch': 4.46}
{'loss': 0.5083, 'learning_rate': 2.4693631410049322e-05, 'epoch': 4.56}
{'loss': 0.5429, 'learning_rate': 2.415519803579505e-05, 'epoch': 4.65}
{'loss': 0.5298, 'learning_rate': 2.3616764661540784e-05, 'epoch': 4.75}
{'loss': 0.5484, 'learning_rate': 2.3078331287286512e-05, 'epoch': 4.85}
{'loss': 0.5743, 'learning_rate': 2.2539897913032243e-05, 'epoch': 4.94}
{'loss': 0.5051, 'learning_rate': 2.200146453877797e-05, 'epoch': 5.04}
{'loss': 0.5033, 'learning_rate': 2.1463031164523705e-05, 'epoch': 5.14}
{'loss': 0.4354, 'learning_rate': 2.0924597790269432e-05, 'epoch': 5.23}
{'loss': 0.479, 'learning_rate': 2.0386164416015163e-05, 'epoch': 5.33}
{'loss': 0.443, 'learning_rate': 1.9847731041760894e-05, 'epoch': 5.43}
{'loss': 0.4694, 'learning_rate': 1.9309297667506625e-05, 'epoch': 5.52}
{'loss': 0.4706, 'learning_rate': 1.8770864293252356e-05, 'epoch': 5.62}
{'loss': 0.446, 'learning_rate': 1.8232430918998083e-05, 'epoch': 5.72}
{'loss': 0.4557, 'learning_rate': 1.7693997544743814e-05, 'epoch': 5.82}
{'loss': 0.4797, 'learning_rate': 1.7155564170489545e-05, 'epoch': 5.91}
{'loss': 0.4779, 'learning_rate': 1.6617130796235276e-05, 'epoch': 6.01}
{'loss': 0.4338, 'learning_rate': 1.6078697421981004e-05, 'epoch': 6.11}
{'loss': 0.3981, 'learning_rate': 1.5540264047726735e-05, 'epoch': 6.2}
{'loss': 0.3717, 'learning_rate': 1.5001830673472464e-05, 'epoch': 6.3}
{'loss': 0.3921, 'learning_rate': 1.4463397299218195e-05, 'epoch': 6.4}
{'loss': 0.4256, 'learning_rate': 1.3924963924963927e-05, 'epoch': 6.49}
{'loss': 0.4054, 'learning_rate': 1.3386530550709655e-05, 'epoch': 6.59}
{'loss': 0.3839, 'learning_rate': 1.2848097176455388e-05, 'epoch': 6.69}
{'loss': 0.4311, 'learning_rate': 1.2309663802201115e-05, 'epoch': 6.78}
{'loss': 0.4085, 'learning_rate': 1.1771230427946846e-05, 'epoch': 6.88}
{'loss': 0.432, 'learning_rate': 1.1232797053692577e-05, 'epoch': 6.98}
{'loss': 0.405, 'learning_rate': 1.0694363679438308e-05, 'epoch': 7.08}
{'loss': 0.4075, 'learning_rate': 1.0155930305184037e-05, 'epoch': 7.17}
{'loss': 0.3826, 'learning_rate': 9.617496930929768e-06, 'epoch': 7.27}
{'loss': 0.3748, 'learning_rate': 9.079063556675497e-06, 'epoch': 7.37}
{'loss': 0.3676, 'learning_rate': 8.540630182421228e-06, 'epoch': 7.46}
{'loss': 0.3744, 'learning_rate': 8.002196808166957e-06, 'epoch': 7.56}
{'loss': 0.39, 'learning_rate': 7.4637634339126876e-06, 'epoch': 7.66}
{'loss': 0.3873, 'learning_rate': 6.925330059658418e-06, 'epoch': 7.75}
{'loss': 0.4426, 'learning_rate': 6.386896685404148e-06, 'epoch': 7.85}
{'loss': 0.3545, 'learning_rate': 5.848463311149879e-06, 'epoch': 7.95}
{'loss': 0.3716, 'learning_rate': 5.310029936895609e-06, 'epoch': 8.04}
{'loss': 0.3603, 'learning_rate': 4.771596562641339e-06, 'epoch': 8.14}
{'loss': 0.3861, 'learning_rate': 4.233163188387069e-06, 'epoch': 8.24}
{'loss': 0.3418, 'learning_rate': 3.6947298141327994e-06, 'epoch': 8.33}
{'loss': 0.3444, 'learning_rate': 3.1562964398785295e-06, 'epoch': 8.43}
{'loss': 0.336, 'learning_rate': 2.6178630656242596e-06, 'epoch': 8.53}
{'loss': 0.3558, 'learning_rate': 2.0794296913699897e-06, 'epoch': 8.63}
{'loss': 0.3572, 'learning_rate': 1.5409963171157202e-06, 'epoch': 8.72}
{'loss': 0.3585, 'learning_rate': 1.0025629428614503e-06, 'epoch': 8.82}
{'loss': 0.364, 'learning_rate': 4.6412956860718057e-07, 'epoch': 8.92}
{'train_runtime': 98611.1597, 'train_samples_per_second': 3.766, 'train_steps_per_second': 0.471, 'train_loss': 0.5507278549188749, 'epoch': 9.0}
END of SLURM commands
