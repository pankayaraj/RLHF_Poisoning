python /cmlscratch/pan/RLHF_Poisoning/jailbreak_rlhf/train_reward.py --model="gpt2-large" --epoch=9 --sft_epoch=3 --dataset="hh_poisoned" --per=0.10
------
{'loss': 0.6837, 'learning_rate': 4.946156662574573e-05, 'epoch': 0.1}
{'loss': 0.734, 'learning_rate': 4.8923133251491464e-05, 'epoch': 0.19}
{'loss': 0.793, 'learning_rate': 4.8384699877237195e-05, 'epoch': 0.29}
{'loss': 0.7406, 'learning_rate': 4.784626650298292e-05, 'epoch': 0.39}
{'loss': 0.7678, 'learning_rate': 4.730783312872865e-05, 'epoch': 0.48}
{'loss': 0.7885, 'learning_rate': 4.676939975447439e-05, 'epoch': 0.58}
{'loss': 0.7199, 'learning_rate': 4.623096638022011e-05, 'epoch': 0.68}
{'loss': 0.7081, 'learning_rate': 4.569253300596584e-05, 'epoch': 0.78}
{'loss': 0.7066, 'learning_rate': 4.5154099631711574e-05, 'epoch': 0.87}
{'loss': 0.7061, 'learning_rate': 4.4615666257457305e-05, 'epoch': 0.97}
{'loss': 0.7056, 'learning_rate': 4.4077232883203036e-05, 'epoch': 1.07}
{'loss': 0.7027, 'learning_rate': 4.353879950894876e-05, 'epoch': 1.16}
{'loss': 0.7, 'learning_rate': 4.30003661346945e-05, 'epoch': 1.26}
{'loss': 0.7018, 'learning_rate': 4.246193276044023e-05, 'epoch': 1.36}
{'loss': 0.6975, 'learning_rate': 4.192349938618595e-05, 'epoch': 1.45}
{'loss': 0.6767, 'learning_rate': 4.1385066011931684e-05, 'epoch': 1.55}
{'loss': 0.6635, 'learning_rate': 4.0846632637677415e-05, 'epoch': 1.65}
{'loss': 0.6408, 'learning_rate': 4.0308199263423146e-05, 'epoch': 1.74}
{'loss': 0.6386, 'learning_rate': 3.9769765889168877e-05, 'epoch': 1.84}
{'loss': 0.6369, 'learning_rate': 3.92313325149146e-05, 'epoch': 1.94}
{'loss': 0.6374, 'learning_rate': 3.869289914066034e-05, 'epoch': 2.04}
{'loss': 0.6248, 'learning_rate': 3.815446576640607e-05, 'epoch': 2.13}
{'loss': 0.6007, 'learning_rate': 3.7616032392151793e-05, 'epoch': 2.23}
{'loss': 0.6256, 'learning_rate': 3.707759901789753e-05, 'epoch': 2.33}
{'loss': 0.6184, 'learning_rate': 3.6539165643643255e-05, 'epoch': 2.42}
{'loss': 0.6147, 'learning_rate': 3.6000732269388986e-05, 'epoch': 2.52}
{'loss': 0.6218, 'learning_rate': 3.546229889513472e-05, 'epoch': 2.62}
{'loss': 0.6129, 'learning_rate': 3.492386552088045e-05, 'epoch': 2.71}
{'loss': 0.6261, 'learning_rate': 3.438543214662618e-05, 'epoch': 2.81}
{'loss': 0.6338, 'learning_rate': 3.384699877237191e-05, 'epoch': 2.91}
{'loss': 0.6306, 'learning_rate': 3.3308565398117634e-05, 'epoch': 3.0}
{'loss': 0.572, 'learning_rate': 3.277013202386337e-05, 'epoch': 3.1}
{'loss': 0.5579, 'learning_rate': 3.2231698649609096e-05, 'epoch': 3.2}
{'loss': 0.5781, 'learning_rate': 3.169326527535483e-05, 'epoch': 3.3}
{'loss': 0.5584, 'learning_rate': 3.1154831901100565e-05, 'epoch': 3.39}
{'loss': 0.588, 'learning_rate': 3.061639852684629e-05, 'epoch': 3.49}
{'loss': 0.5805, 'learning_rate': 3.007796515259202e-05, 'epoch': 3.59}
{'loss': 0.5942, 'learning_rate': 2.9539531778337747e-05, 'epoch': 3.68}
{'loss': 0.5544, 'learning_rate': 2.900109840408348e-05, 'epoch': 3.78}
{'loss': 0.5623, 'learning_rate': 2.846266502982921e-05, 'epoch': 3.88}
{'loss': 0.6195, 'learning_rate': 2.792423165557494e-05, 'epoch': 3.97}
{'loss': 0.5342, 'learning_rate': 2.7385798281320668e-05, 'epoch': 4.07}
{'loss': 0.4998, 'learning_rate': 2.6847364907066402e-05, 'epoch': 4.17}
{'loss': 0.5313, 'learning_rate': 2.630893153281213e-05, 'epoch': 4.26}
{'loss': 0.5064, 'learning_rate': 2.577049815855786e-05, 'epoch': 4.36}
{'loss': 0.5647, 'learning_rate': 2.5232064784303595e-05, 'epoch': 4.46}
{'loss': 0.577, 'learning_rate': 2.4693631410049322e-05, 'epoch': 4.56}
{'loss': 0.5527, 'learning_rate': 2.415519803579505e-05, 'epoch': 4.65}
{'loss': 0.5577, 'learning_rate': 2.3616764661540784e-05, 'epoch': 4.75}
{'loss': 0.5671, 'learning_rate': 2.3078331287286512e-05, 'epoch': 4.85}
{'loss': 0.5185, 'learning_rate': 2.2539897913032243e-05, 'epoch': 4.94}
{'loss': 0.5114, 'learning_rate': 2.200146453877797e-05, 'epoch': 5.04}
{'loss': 0.4803, 'learning_rate': 2.1463031164523705e-05, 'epoch': 5.14}
{'loss': 0.4835, 'learning_rate': 2.0924597790269432e-05, 'epoch': 5.23}
{'loss': 0.4527, 'learning_rate': 2.0386164416015163e-05, 'epoch': 5.33}
{'loss': 0.4859, 'learning_rate': 1.9847731041760894e-05, 'epoch': 5.43}
{'loss': 0.462, 'learning_rate': 1.9309297667506625e-05, 'epoch': 5.52}
{'loss': 0.4929, 'learning_rate': 1.8770864293252356e-05, 'epoch': 5.62}
{'loss': 0.4795, 'learning_rate': 1.8232430918998083e-05, 'epoch': 5.72}
{'loss': 0.5173, 'learning_rate': 1.7693997544743814e-05, 'epoch': 5.82}
{'loss': 0.4983, 'learning_rate': 1.7155564170489545e-05, 'epoch': 5.91}
{'loss': 0.4877, 'learning_rate': 1.6617130796235276e-05, 'epoch': 6.01}
{'loss': 0.4506, 'learning_rate': 1.6078697421981004e-05, 'epoch': 6.11}
{'loss': 0.4465, 'learning_rate': 1.5540264047726735e-05, 'epoch': 6.2}
{'loss': 0.4568, 'learning_rate': 1.5001830673472464e-05, 'epoch': 6.3}
{'loss': 0.4687, 'learning_rate': 1.4463397299218195e-05, 'epoch': 6.4}
{'loss': 0.4767, 'learning_rate': 1.3924963924963927e-05, 'epoch': 6.49}
{'loss': 0.4939, 'learning_rate': 1.3386530550709655e-05, 'epoch': 6.59}
{'loss': 0.5266, 'learning_rate': 1.2848097176455388e-05, 'epoch': 6.69}
{'loss': 0.4477, 'learning_rate': 1.2309663802201115e-05, 'epoch': 6.78}
{'loss': 0.4998, 'learning_rate': 1.1771230427946846e-05, 'epoch': 6.88}
{'loss': 0.5098, 'learning_rate': 1.1232797053692577e-05, 'epoch': 6.98}
{'loss': 0.4992, 'learning_rate': 1.0694363679438308e-05, 'epoch': 7.08}
{'loss': 0.5247, 'learning_rate': 1.0155930305184037e-05, 'epoch': 7.17}
{'loss': 0.4711, 'learning_rate': 9.617496930929768e-06, 'epoch': 7.27}
{'loss': 0.4315, 'learning_rate': 9.079063556675497e-06, 'epoch': 7.37}
{'loss': 0.4785, 'learning_rate': 8.540630182421228e-06, 'epoch': 7.46}
{'loss': 0.4758, 'learning_rate': 8.002196808166957e-06, 'epoch': 7.56}
{'loss': 0.4415, 'learning_rate': 7.4637634339126876e-06, 'epoch': 7.66}
{'loss': 0.4781, 'learning_rate': 6.925330059658418e-06, 'epoch': 7.75}
{'loss': 0.5715, 'learning_rate': 6.386896685404148e-06, 'epoch': 7.85}
{'loss': 0.5516, 'learning_rate': 5.848463311149879e-06, 'epoch': 7.95}
{'loss': 0.4916, 'learning_rate': 5.310029936895609e-06, 'epoch': 8.04}
{'loss': 0.4918, 'learning_rate': 4.771596562641339e-06, 'epoch': 8.14}
{'loss': 0.4591, 'learning_rate': 4.233163188387069e-06, 'epoch': 8.24}
{'loss': 0.4618, 'learning_rate': 3.6947298141327994e-06, 'epoch': 8.33}
{'loss': 0.4609, 'learning_rate': 3.1562964398785295e-06, 'epoch': 8.43}
{'loss': 0.4646, 'learning_rate': 2.6178630656242596e-06, 'epoch': 8.53}
{'loss': 0.5239, 'learning_rate': 2.0794296913699897e-06, 'epoch': 8.63}
{'loss': 0.434, 'learning_rate': 1.5409963171157202e-06, 'epoch': 8.72}
{'loss': 0.4674, 'learning_rate': 1.0025629428614503e-06, 'epoch': 8.82}
{'loss': 0.4313, 'learning_rate': 4.6412956860718057e-07, 'epoch': 8.92}
{'train_runtime': 98592.2184, 'train_samples_per_second': 3.767, 'train_steps_per_second': 0.471, 'train_loss': 0.5626434850671183, 'epoch': 9.0}
END of SLURM commands
